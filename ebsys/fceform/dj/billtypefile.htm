<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<STYLE> .userData{behavior:url(#default#userData);}
	        @import url(../../fceform/css/dj.css); 
	    </STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>function uf_open() {
      var oXml = SetDomFile("../.."+fcpubdata.userDir+"/xml/billtype.xml") ;
      dssub1.OpenXmlData(oXml.documentElement.xml);
}

function uf_save() {
	var shead = '<?xml version="1.0" encoding="'+fcpubdata.encoding+'" ?>' ;
	var sxml="<file>"+fcpubdata.userDir+"/xml/billtype.xml</file><text><!["+"CDATA["+ shead + dssub1.xml+"]]"+"></text>";
	var ret=savedesignhtml(sxml)
	if(ret==""){
		alert("保存成功!")
	}else{
		alert(ret)
	}
	
	
}
function uf_openfile() {
	var spath = '../';
	if(fcpubdata.dotnetVersion == "") spath = "";
	var sRet = DjOpen('getUrl',[spath,'url','yes'],'展现','有模式窗口','直接','选择路径');
	if(IsSpace(sRet) == false){
		var s1 = sRet.substring(1,sRet.length); 
		if(s1.substring(s1.length-1,s1.length) == "/") s1=s1.substring(0,s1.length-1);
		if(s1.split("/").length != 2){
			alert("只能选择两级目录!");
			return;	
		}
		var s = s1+"/";	
		dssub1.Field('flbs').Value = s;
		dssub1.bEdit = true;
		dssub1.Update();
		dssub1.fset_cont();
		grid1.hide();
	}	
}</script><script src='../js/fcopendj.js'></script><script defer src='../js/fcsavedj.js'></script><script src='../js/fcstring.js'></script><script src='../js/fcnumdate.js'></script><script src='../js/fcselfuse.js'></script><script src='../js/fcbasecont.js'></script><script defer src='../js/fcother.js'></script><script src='../js/design.js'></script><link href=../css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../css/Button.css'/><script >document.styleSheets[0].addRule("fc\\:webgrid","behavior: url(../htc/webgrid.htc)",0);</script><script src='../js/fcwebgrid.js'></script><script >document.styleSheets[0].addRule("fc\\:fc_code","behavior: url(../htc/fc_code.htc)",0);</script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../htc/dataset.htc)",0);</script><script src='../js/fcdataset.js'></script>
<DIV onkeydown="" id=SKbillsheet class=dj ondblclick="" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;design.js&#13;&#10;" userType dj_sn="billtypefile" caption="生成路径分类列表" type="LR" isfile="是" center="居中" posleft postop poswidth="596" posheight="380" toolbar="不带工具栏" window="有模式窗口" BLONopen="uf_open()" BLONopenBefore BLONclose idtype="1" entertype="展现" keyfield codeheader OtherSave="否" billtaborder="<root><taborder>SKButton3</taborder><taborder>SKButton1</taborder><taborder>SKButton2</taborder><taborder>grid1</taborder></root>" controlno="SKButton:3;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:1;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" contxml="<root><label><id>Label1</id></label><button><id>SKButton2</id><id>SKButton1</id><id>SKButton3</id></button><grid><id>grid1</id></grid><dataset><id>dssub1</id></dataset></root>" mkbh="E5" blmode="表格数据维护" dj_id="345" para="<r></r>" AutoResizeXml><?xml:namespace prefix = fc /><fc:webgrid onkeydown='bill_ongridkeydown("<grid1><col></col><col></col><col></col><col></col><col></col></grid1>")' id=grid1 ondblclick='bill_ongriddblclick("<grid1><col></col><col></col><col></col><col></col><col></col></grid1>")' onclick='bill_ongridclick("<grid1><col></col><col></col><col></col><col></col><col></col></grid1>")' controltype="grid" dataset="dssub1" visible="是" readonly="是" autoappend="否" autowidth="是" autoheight="是" canselect="是" format="<cols><col><fname>flbh</fname><cname>分类ID</cname><width>10</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>60</columnwidth><align>left</align></col><col><fname>flsm</fname><cname>分类说明</cname><width>40</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>120</columnwidth><align>left</align></col><col><fname>fllx</fname><cname>类型</cname><width>20</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>40</columnwidth><align>left</align></col><col><fname>flbs</fname><cname>正式文件路径</cname><width>200</width><dtype>字符</dtype><readonly>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Conclickopen%3Euf_openfile%28%29%3Bevent.showlist%3Dfalse%3B%3C/onclickopen%3E%3C/code%3E</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>250</columnwidth><align>left</align></col><col><fname>extname</fname><cname>扩展名</cname><width>5</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>60</columnwidth><align>left</align></col></cols>" width="590" height="392" top="34" left="1">
<TABLE style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; FONT-SIZE: 12px; TOP: 0px; LEFT: 0px" id=t cellSpacing=0 cellPadding=1 frame=box>
<TBODY>
<TR style="BACKGROUND-COLOR: #c0c0c0; FONT-SIZE: 12px" class=fcGridFirstRow>
<TD></TD></TR></TBODY></TABLE></fc:webgrid><fc:dataset id=dssub1 idtype="1" controltype="dataset" pubpara="否" opensortno="1" isaddemptyrec="否" submittype="1" submitno="1" issubds="否" chnname="分类类型" isSubGrid="否" format="<fields><field><fieldname>flbh</fieldname><datatype>字符</datatype><displaylabel>分类ID</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>是</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>flsm</fieldname><datatype>字符</datatype><displaylabel>分类说明</displaylabel><size>40</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fllx</fieldname><datatype>字符</datatype><displaylabel>类型</displaylabel><size>20</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>flbs</fieldname><datatype>字符</datatype><displaylabel>正式文件路径</displaylabel><size>200</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>是</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>extname</fieldname><datatype>字符</datatype><displaylabel>扩展名</displaylabel><size>5</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><flbh>$valid(&amp;quot;字段值不重复&amp;quot;);</flbh><flsm></flsm><fllx>$valid(&amp;quot;字段值不重复&amp;quot;);</fllx><flbs></flbs><extname></extname></dsid>")' onGetText='bill_ondatasetgettext("<dsid><flbh></flbh><flsm></flsm><fllx></fllx><flbs></flbs><extname></extname></dsid>")' onSetText='bill_ondatasetsettext("<dsid><flbh></flbh><flsm></flsm><fllx></fllx><flbs></flbs><extname></extname></dsid>")'></fc:dataset><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #ecece3; WIDTH: 57px; DISPLAY: block; HEIGHT: 21px; FONT-SIZE: 12px; TOP: 11px; LEFT: 384px" id=SKButton2 value=保存 type=button controltype="button" dropstyle="否" onclick='bill_onclick("uf_save()")'> <INPUT style="POSITION: absolute; BACKGROUND-COLOR: #ecece3; WIDTH: 57px; DISPLAY: block; HEIGHT: 21px; FONT-SIZE: 12px; TOP: 10px; LEFT: 313px" id=SKButton1 value=删除 type=button controltype="button" dropstyle="否" onclick='bill_onclick("dssub1.Delete()")'><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #ecece3; WIDTH: 57px; DISPLAY: block; HEIGHT: 21px; FONT-SIZE: 12px; TOP: 10px; LEFT: 242px" id=SKButton3 value=增加 type=button controltype="button" dropstyle="否" onclick='bill_onclick("dssub1.Append()")'><SPAN style="POSITION: absolute; TEXT-ALIGN: left; WIDTH: 144px; DISPLAY: block; FONT-FAMILY: 楷体_GB2312; HEIGHT: 23px; COLOR: #0000ff; FONT-SIZE: 18px; TOP: 15px; FONT-WEIGHT: bold; TEXT-DECORATION: underline; LEFT: 9px; backgroundColor1: #c0c0c0" id=Label1 controltype="label" value="Label1" inputTag="否">生成路径分类:</SPAN></DIV></body></html>