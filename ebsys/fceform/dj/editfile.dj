<script>var curSelFile="";&#13;&#10;var isEdit=false;&#13;&#10;function uf_openfile(){&#13;&#10;	if(curSelFile != "" && isEdit){&#13;&#10;		var yesno = window.confirm("当前修改的内容没有保存, 按 [确定] 则放弃保存!");&#13;&#10;		if(yesno == false) return ;&#13;&#10;&#13;&#10;	}&#13;&#10;	&#13;&#10;    var spath = '';&#13;&#10;    var sRet = DjOpen('getUrl', [spath, 'file', 'yes', ''], '展现', '有模式窗口', '直接', '选择文件');&#13;&#10;    if (IsSpace(sRet) == false) {&#13;&#10;    	curSelFile = sRet;&#13;&#10;    	lblFile.innerText = "/ebsys"+sRet;&#13;&#10;        textarea1.value = readdesignhtml("<file>" + sRet + "</file>");&#13;&#10;        isEdit=false;&#13;&#10;    }	&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;    var sxml = "<file>" + curSelFile + "</file><text><![" + "CDATA[" + textarea1.value + "]]" + "></text>";&#13;&#10;    var ret=savedesignhtml(sxml);&#13;&#10;	if(ret==""){&#13;&#10;		alert("保存成功!");&#13;&#10;		isEdit=false;		&#13;&#10;	}else{&#13;&#10;		alert(ret);&#13;&#10;	}	&#13;&#10;}&#13;&#10;function uf_change(){&#13;&#10;	isEdit=true;&#13;&#10;}&#13;&#10;function uf_edit(){&#13;&#10;	pstrUserFunction = textarea1.value;&#13;&#10;	Addobj("userfunction1");&#13;&#10;	textarea1.value = pstrUserFunction;&#13;&#10;	uf_change();&#13;&#10;	&#13;&#10;		&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;design.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" unselectable="on" contxml="<root><label><id>lblFile</id></label><textarea><id>textarea1</id></textarea><button><id>button1</id><id>cmdOk</id><id>button3</id></button></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:0;textarea:1;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:3;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" billtaborder="<root><taborder>textarea1</taborder><taborder>button1</taborder><taborder>cmdOk</taborder><taborder>button3</taborder></root>" isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen window="当前窗口" toolbar="不带工具栏" posheight poswidth postop posleft center="  " isfile="是" type="ST" caption="编辑文件工具" dj_sn="editfile"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 77px; HEIGHT: 25px; TOP: 2px; LEFT: 6px" id=button1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("uf_openfile()")' controltype="button">选择文件</BUTTON><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 457px; HEIGHT: 15px; TOP: 36px; LEFT: 13px" id=lblFile onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" AutoSizeXml="<record id ='lblFile'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>伸缩设置</WSetType><Width></Width><WExt>2</WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>百分比设置</HSetType><Height></Height><HExt></HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" inputTag="否"></LABEL><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 2px; LEFT: 92px" id=cmdOk onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("uf_ok()")' controltype="button">保 存</BUTTON><TEXTAREA onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 467px; HEIGHT: 444px; TOP: 58px; LEFT: 7px" id=textarea1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() rows=10 onchange='bill_onclick("uf_change()")' cols=93 controltype="textarea" AutoSizeXml="<record id ='textarea1'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>伸缩设置</WSetType><Width></Width><WExt>2</WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>2</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" induce="否" value="textarea1"></TEXTAREA><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 177px; HEIGHT: 25px; TOP: 3px; LEFT: 178px" id=button3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("uf_edit()")' controltype="button">在codemax编辑器中修改</BUTTON></DIV>