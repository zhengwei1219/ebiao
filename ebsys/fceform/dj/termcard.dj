<script>var arrPub = new Array();&#13;&#10;function uf_open(){&#13;&#10;	new Eform.SysForm().setButtonImage();&#13;&#10;	var arr=fcpubdata.obj;&#13;&#10;	if(IsSpace(arr[1])) return;&#13;&#10;	//arr[1]=UnRepXml(arr[1]);&#13;&#10;	//CopyToPub(arr[1])&#13;&#10;	var oXml = SetDom(arr[1]) ;&#13;&#10;	var sOption="" ;&#13;&#10;	var l=oXml.documentElement.childNodes.length ;&#13;&#10;	//alert(oXml.documentElement.xml)&#13;&#10;	for(var i=0;i<l;i++){&#13;&#10;		var arrTmp = new Array()&#13;&#10;		arrTmp[0]=UnRepXml(oXml.documentElement.childNodes(i).childNodes(0).text) ;&#13;&#10;		arrTmp[1]=UnRepXml(oXml.documentElement.childNodes(i).childNodes(1).text) ;&#13;&#10;		arrTmp[2]=UnRepXml(oXml.documentElement.childNodes(i).childNodes(2).text) ;&#13;&#10;		arrTmp[3]=UnRepXml(oXml.documentElement.childNodes(i).childNodes(3).text) ;&#13;&#10;		arrTmp[4]=UnRepXml(oXml.documentElement.childNodes(i).childNodes(4).text) ;&#13;&#10;		arrTmp[5]=UnRepXml(oXml.documentElement.childNodes(i).childNodes(5).text) ;&#13;&#10;		arrPub[i]=arrTmp ;&#13;&#10;		sOption += "<option>" + arrTmp[0] +"</option>" ;&#13;&#10;	}&#13;&#10;	//alert(sOption)&#13;&#10;	SKDBListBox1.outerHTML = SelectAddOption(SKDBListBox1,sOption);&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_addCond(){&#13;&#10;	var arr1 = new Array()&#13;&#10;	arr1[0]=fcpubdata.obj[0]&#13;&#10;	var arr=DjOpen('termstyle',arr1,'展现','有模式窗口','直接','条件格式')  ;&#13;&#10;	if(typeof(arr)=="undefined"){&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	arrPub[SKDBListBox1.options.length] = arr &#13;&#10;	var oOpt=document.createElement("option");&#13;&#10;	oOpt.text=arr[0];&#13;&#10;	SKDBListBox1.add(oOpt);&#13;&#10;	&#13;&#10;}&#13;&#10;&#13;&#10;function uf_amendCond(){&#13;&#10;	if(SKDBListBox1.selectedIndex<0){&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	var arr1 = new Array()&#13;&#10;	arr1[0]=fcpubdata.obj[0]&#13;&#10;	arr1[1]=arrPub[SKDBListBox1.selectedIndex]&#13;&#10;	var arr=DjOpen('termstyle',arr1,'展现','有模式窗口','直接','条件格式');	&#13;&#10;	if(typeof(arr)=="undefined"){&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	arrPub[SKDBListBox1.selectedIndex] = arr &#13;&#10;	SKDBListBox1.options(SKDBListBox1.selectedIndex).text = arr[0]&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;	var sxml="";&#13;&#10;	var sxml0="";&#13;&#10;	var sxml1="";&#13;&#10;	var sxml2="";&#13;&#10;	var sxml3="";&#13;&#10;	var sxml4="";&#13;&#10;	var sxml5="";&#13;&#10;	for(i=0;i<arrPub.length;i++){&#13;&#10;		sxml0="<Node0>"+RepXml(arrPub[i][0])+"</Node0>"&#13;&#10;		sxml1="<Node1>"+RepXml(arrPub[i][1])+"</Node1>"&#13;&#10;		sxml2="<Node2>"+RepXml(arrPub[i][2])+"</Node2>"&#13;&#10;		sxml3="<Node3>"+RepXml(arrPub[i][3])+"</Node3>"&#13;&#10;		sxml4="<Node4>"+RepXml(arrPub[i][4])+"</Node4>"&#13;&#10;		sxml5="<Node5>"+RepXml(arrPub[i][5])+"</Node5>"&#13;&#10;		sxml=sxml+"<Term>"+sxml0+sxml1+sxml2+sxml3+sxml4+sxml5+"</Term>"&#13;&#10;	}&#13;&#10;	sxml = "<root>"+sxml+"</root>" ;&#13;&#10;	window.returnValue=sxml;&#13;&#10;	window.close();&#13;&#10;}&#13;&#10;&#13;&#10;//删除&#13;&#10;function uf_delCond(){&#13;&#10;	&#13;&#10;	if(SKDBListBox1.selectedIndex<0){&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	var sIndex=SKDBListBox1.selectedIndex;&#13;&#10;	var slen=SKDBListBox1.options.length-1;&#13;&#10;	var arr1 = arrPub.slice(0,SKDBListBox1.selectedIndex);&#13;&#10;	var arr2 = arrPub.slice(SKDBListBox1.selectedIndex+1);&#13;&#10;	if(sIndex=="0" && sIndex!=slen){&#13;&#10;		arrPub=arr2;	&#13;&#10;	}&#13;&#10;	if(sIndex!="0" && sIndex==slen){&#13;&#10;		arrPub=arr1&#13;&#10;	}&#13;&#10;	if(sIndex!="0" && sIndex!=slen){&#13;&#10;		arrPub=arr1.concat(arr2);&#13;&#10;	}&#13;&#10;	if(sIndex=="0" && sIndex==slen){&#13;&#10;		arrPub=new Array();	&#13;&#10;	}&#13;&#10;	SKDBListBox1.remove(SKDBListBox1.selectedIndex) ;&#13;&#10;}&#13;&#10;//上移&#13;&#10;function uf_itemUp(){&#13;&#10;     for (var i=SKDBListBox1.length-1;i>0;i--){&#13;&#10;      if (SKDBListBox1.options(i).selected){&#13;&#10;      	&#13;&#10;        var s&#13;&#10;        var arr=new Array();&#13;&#10;        s=SKDBListBox1.options(i-1).text ;&#13;&#10;        &#13;&#10;        arr[0]=arrPub[i-1];&#13;&#10;        arrPub[i-1]=arrPub[i];&#13;&#10;        arrPub[i]=arr[0];&#13;&#10;        &#13;&#10;        SKDBListBox1.options(i-1).text=SKDBListBox1.options(i).text ;&#13;&#10;        SKDBListBox1.options(i).text=s ;&#13;&#10;        SKDBListBox1.options(i-1).selected=true ;&#13;&#10;        break ;&#13;&#10;      }&#13;&#10;    }&#13;&#10;}&#13;&#10;//下移&#13;&#10;function uf_itemDown(){&#13;&#10;   for (var i=0;i<SKDBListBox1.length-1;i++){&#13;&#10;    if (SKDBListBox1.options(i).selected){&#13;&#10;    	&#13;&#10;      var arr=new Array;&#13;&#10;      var s&#13;&#10;      s=SKDBListBox1.options(i+1).text ;&#13;&#10;      &#13;&#10;      arr[0]=arrPub[i+1];&#13;&#10;      arrPub[i+1]=arrPub[i];&#13;&#10;      arrPub[i]=arr[0];&#13;&#10;      &#13;&#10;      SKDBListBox1.options(i+1).text=SKDBListBox1.options(i).text ;&#13;&#10;      SKDBListBox1.options(i).text=s ;&#13;&#10;      SKDBListBox1.options(i+1).selected=true ;&#13;&#10;      break ;&#13;&#10;    }&#13;&#10;  }&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;" center="居中" unselectable="on" keyfield controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" posheight="240" poswidth="300" entertype="修改" codeheader mkbh caption="添加条件格式" type="LR" dj_sn="termcard" billtaborder="<root><taborder>SKDBListBox1</taborder><taborder>FCButton1</taborder><taborder>FCButton2</taborder><taborder>FCButton3</taborder><taborder>FCButton4</taborder><taborder>FCButton5</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" contxml="<root><label><id>Label1</id></label><listbox><id>SKDBListBox1</id></listbox><button><id>FCButton1</id><id>FCButton2</id><id>FCButton3</id><id>FCButton4</id><id>FCButton5</id><id>cmdOk</id><id>cmdClose</id></button></root>" blmode="其他" BLONopen="uf_open()" toolbar="不带工具栏" window="有模式窗口" posleft postop isfile="是" OtherSave="否" idtype="1" BLONopenBefore BLONclose userType><SPAN oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 94px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 18px; FONT-SIZE: 12px; TOP: 6px; FONT-WEIGHT: bold; LEFT: 14px" id=Label1 onresize=resize() onmove=move() controltype="label" value="Label1">条件格式：</SPAN><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 24px; LEFT: 207px" id=FCButton1 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_addCond()")' dropstyle="否" controltype="button">添 加</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 54px; LEFT: 207px" id=FCButton2 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_amendCond()")' dropstyle="否" controltype="button">修 改</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 84px; LEFT: 207px" id=FCButton3 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_delCond()")' dropstyle="否" controltype="button">删 除</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 114px; LEFT: 207px" id=FCButton4 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_itemUp()")' dropstyle="否" controltype="button">上 移</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 146px; LEFT: 207px" id=FCButton5 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_itemDown()")' dropstyle="否" controltype="button">下 移</BUTTON><SELECT oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; WIDTH: 194px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 147px; FONT-SIZE: 12px; TOP: 25px; LEFT: 8px" id=SKDBListBox1 onresize=resize() onmove=move() size=8 controltype="listbox" china fc_ondblclick='bill_ondblclick("uf_amendCond()")' temptext tempvalue sql check="1" vValue></SELECT><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 178px; LEFT: 115px" id=cmdOk onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_ok()")' dropstyle="否" controltype="button"></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 178px; LEFT: 198px" id=cmdClose onresize=resize() onmove=move() fc_onclick='bill_onclick("CloseBill()")' dropstyle="否" controltype="button"></BUTTON></DIV>