<script>function uf_open(){&#13;&#10;	e_PropWinOnload();&#13;&#10;	var sData = fcpubdata.obj[0];&#13;&#10;	if(IsSpace(sData) == false){&#13;&#10;		sData = uf_addTd(sData);&#13;&#10;		var dsAll = dataset1.xml;&#13;&#10;		var pos = dsAll.indexOf("<set><pages>");&#13;&#10;		sData = "<root>"+sData+dsAll.substring(pos,dsAll.length);&#13;&#10;		dataset1.OpenXmlData(sData);&#13;&#10;	}&#13;&#10;	var sXml="";&#13;&#10;	var sHtml0 = "<code><format>  ID  |    提示信息    </format><sql1></sql1><xml>"&#13;&#10;	var sHtml1 = "<code><format>  ID  |    提示信息!    </format><sql1></sql1><xml>"&#13;&#10;	var sHtml2 = "</xml><blninput>是</blninput><blnempty>否</blnempty><check>2</check></code>"&#13;&#10;	for(var key in fcpubdata.toolbarButtons){&#13;&#10;		sXml += "<tr><td>"+key+"</td><td>"+fcpubdata.toolbarButtons[key][2]+"</td></tr>";&#13;&#10;	&#13;&#10;	}&#13;&#10;	&#13;&#10;	grid1.tab.children[0].children[1].cz  = sHtml0+sXml+sHtml2 ;&#13;&#10;	grid1.tab.children[0].children[2].cz  = sHtml1+sXml+sHtml2 ;&#13;&#10;	grid1.cz.FieldNameList="ID,msg";&#13;&#10;		&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;	if(dataset1.RecordCount>0){&#13;&#10;		window.returnValue = dataset1.RecordData;	&#13;&#10;	}&#13;&#10;	window.close();&#13;&#10;}&#13;&#10;function uf_sel_function(){&#13;&#10;	SelFunction(grid1.cz);&#13;&#10;	dataset1.Field('code').Value=grid1.cz.value;&#13;&#10;	dataset1.fset_cont();	&#13;&#10;}&#13;&#10;function uf_addTd(sData){&#13;&#10;	var oXml = SetDom("<root>"+sData+"</root>");&#13;&#10;	if(oXml.documentElement == null) return sData;&#13;&#10;	if(oXml.documentElement.childNodes(0).childNodes.length == 5){&#13;&#10;		sData = RepStr(sData,"</tr>","<td></td><td></td><td></td><td></td></tr>");			&#13;&#10;	}	&#13;&#10;	&#13;&#10;	return sData;&#13;&#10;}&#13;&#10;function uf_fx(fieldName){&#13;&#10;/*	var sRet = DjOpen("js_fx",["",dataset1.Field(fieldName).Value],"展现","有模式窗口","直接","设置公式");	&#13;&#10;	if(typeof(sRet) != "undefined"){&#13;&#10;		grid1.cz.value = sRet&#13;&#10;        grid1.curTD.innerText = sRet;&#13;&#10;        grid1.Act_onDataChange("强行发生数据改变事件");&#13;&#10;		&#13;&#10;	}*/&#13;&#10;	grid1.hide();&#13;&#10;	var sRet = DjOpen("toolbarPermit",[dataset1,fieldName],"展现","有模式窗口","直接","选择");	&#13;&#10;&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js" mkbh codeheader keyfield entertype="修改" OtherSave="否" idtype="1" userType alertType="1" isCheckPermit="否" BLONopenBefore contxml="<root><a><id>a2</id></a><button><id>button4</id><id>button5</id><id>cmdOk</id><id>cmdClose</id><id>cmdAdd</id><id>cmdDel</id></button><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:7;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" billtaborder="<root><taborder>grid1</taborder><taborder>button4</taborder><taborder>button5</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>cmdAdd</taborder><taborder>cmdDel</taborder></root>" isfile="是" posheight="400" poswidth="800" postop posleft window="有模式窗口" caption="自定义工具栏" type="LR" dj_sn="userToolbar" toolbar="不带工具栏" unselectable="on" center="居中" BLONopen="uf_open()" BLONclose><IMG style="POSITION: absolute; WIDTH: 587px; HEIGHT: 291px; TOP: 34px; LEFT: 6px" id=grid1 src="../../fceform/images/ef_designer_webgrid.gif" csstext1="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #ffffff" csstext2="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #c0c0c0" hideHscroll="auto" blRowNo="否" canselect="是" autoheight="是" autowidth="是" autoappend="否" readonly="否" visible="是" titlerowheight titlerows usertitlehtml usertitle="否" SetRowHeight="是" hideVscroll="auto" bodyrowheight="-1" bodyrows="-1" iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0" dataset="dataset1" controltype="grid"><IMG style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 93px; LEFT: 635px" id=dataset1 src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" temptable="TMP_IMGDATASET2" chnname Like="否" datasourceName async="否" masterdsfield masterds subdsfield issubds="否" idparam savetable submitno="1" submittype="1" isaddemptyrec="否" opensortno="1" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll opensql iscreatetable="否" pubpara="否" formatxml="<root><tr rowstate=&quot;add&quot;><td>ID</td><td>控件ID</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td>$valid('字段值不重复');$valid('字母、数字或_');</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>msg</td><td>提示信息</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>120</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>text</td><td>按钮上文字</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>code</td><td>调用代码</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Conclickopen%3Euf_sel_function%28%29%3C/onclickopen%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>230</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>width</td><td>宽度</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>40</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>expHide</td><td>隐藏表达式</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Conclickopen%3Euf_fx%28%27valueHide%27%29%3C/onclickopen%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>100</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>expDisable</td><td>禁用表达式</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Conclickopen%3Euf_fx%28%27valueDisable%27%29%3C/onclickopen%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>100</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>valueHide</td><td>隐藏ID值</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>valueDisable</td><td>禁用ID值</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" saveastable isSubGrid="否"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 61px; HEIGHT: 25px; TOP: 1px; LEFT: 316px" id=button4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("GridChangeRow(true,grid1)")'>上 移</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 61px; HEIGHT: 25px; TOP: 1px; LEFT: 383px" id=button5 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("GridChangeRow(false,grid1)")'>下 移</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 69px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 2px; LEFT: 158px" id=cmdOk onresize=resize() onmove=move() controltype="button" fc_onclick='bill_onclick("uf_ok()")' dropstyle="否"></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 69px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 2px; LEFT: 230px" id=cmdClose onresize=resize() onmove=move() controltype="button" fc_onclick='bill_onclick("CloseBill()")' dropstyle="否"></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 69px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 2px; LEFT: 14px" id=cmdAdd onresize=resize() onmove=move() controltype="button" fc_onclick='bill_onclick("dataset1.Append()")' dropstyle="否"></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 69px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 2px; LEFT: 86px" id=cmdDel onresize=resize() onmove=move() controltype="button" fc_onclick='bill_onclick("dataset1.Delete()")' dropstyle="否"></BUTTON> <A onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 12px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 18px; COLOR: #0000ff; FONT-SIZE: 16px; TOP: 5px; FONT-WEIGHT: bold; LEFT: 463px; backgroundColor1: #ffffff" id=a2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() href="javascript:ShowHelp('on_usertoolbar')" target=_self controltype="a" href1="javascript:ShowHelp('on_usertoolbar')" NotBg="否">?</A></DIV>