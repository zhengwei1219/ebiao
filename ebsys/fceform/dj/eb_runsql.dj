<script>var connStr="";&#13;&#10;function uf_open() {&#13;&#10;	var objPara = fcpubdata.obj;&#13;&#10;	if(typeof(objPara) == "object" ){&#13;&#10;		txtSql.value = objPara[0];&#13;&#10;		if(IsSpace(objPara[1]) == false){&#13;&#10;			connStr = "&datasourceName="+objPara[1];&#13;&#10;		}&#13;&#10;	}else{&#13;&#10;		txtSql.value = objPara;&#13;&#10;	}&#13;&#10;	uf_runsql();&#13;&#10;}&#13;&#10;function uf_runsql() {&#13;&#10;	grid3.format="";&#13;&#10;	dataset3.format="";&#13;&#10;	var num = ToInt(txtRows.value);&#13;&#10;	if(connStr==""){&#13;&#10;		dataset3.PageSize=num;&#13;&#10;		dataset3.Open(txtSql.value,"",function (result){});	&#13;&#10;	}else{&#13;&#10;		//DbSql(dataset3,connStr,txtSql.value,1,num);&#13;&#10;		var sXml="<sql>"+RepXml(txtSql.value)+"</sql>"+"<pageno>1</pageno>"+"<pagesize>"+num+"</pagesize>";&#13;&#10;		var sDsXml = new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host+ fcpubdata.servletPath + "/WebBill"+fcpubdata.dotnetVersion+"?key=dataset_select"+connStr,sXml);&#13;&#10;		var oF = SetDom(sDsXml);&#13;&#10;		if(oF.documentElement == null ){&#13;&#10;			alert("SQL语句: "+txtSql.value+" 执行错误! 错误信息:"+sDsXml);&#13;&#10;	&#13;&#10;			return;&#13;&#10;		}  &#13;&#10;		fcpubdata.dbStruDict = ""; //以免下面这行命令会运行SQL去找字段中文名&#13;&#10;		dataset3.OpenXmlData(sDsXml);&#13;&#10;	}&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" userType dj_sn="eb_runsql" caption="运行sql语句" type="ST" isfile="是" center="居中" posleft postop poswidth="740" posheight="480" toolbar="不带工具栏" window="有模式窗口" BLONopen="uf_open()" BLONopenBefore BLONclose idtype="1" entertype="修改" keyfield codeheader="BBB" OtherSave="否" billtaborder="<root><taborder>txtSql</taborder><taborder>button5</taborder><taborder>txtRows</taborder><taborder>grid3</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" contxml="<root><label><id>label2</id><id>label4</id></label><textarea><id>txtSql</id></textarea><button><id>button5</id></button><text><id>txtRows</id></text><grid><id>grid3</id></grid><dataset><id>dataset3</id></dataset></root>" unselectable="on" mkbh><TEXTAREA onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 731px; HEIGHT: 142px; TOP: 0px; LEFT: 0px" id=txtSql onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() rows=3 cols=82 controltype="textarea" value="textarea1" induce="否"></TEXTAREA><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 94px; HEIGHT: 25px; TOP: 144px; LEFT: 1px" id=button5 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_runsql()")'>运行SQL语句</BUTTON> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 38px; HEIGHT: 15px; TOP: 149px; LEFT: 148px" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label2" NotBg="否">行数:</DIV><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 44px; HEIGHT: 20px; TOP: 146px; LEFT: 186px" id=txtRows onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value=50 size=7 controltype="text"><SPAN style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 133px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 15px; COLOR: #b2b2b2; FONT-SIZE: 12px; TOP: 151px; LEFT: 236px" id=label4 controltype="label" NotBg="否" align="Left">为-1表示取出所有行。</SPAN><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 725px; HEIGHT: 280px; TOP: 169px; LEFT: 4px" id=grid3 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dataset3" visible="是" crosstabdatatype crosstabsql cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" coltitle rowtitle crosstabformat crosstabsumtype crosstabtitle iscrosstab="否" bodyrows="-1" bodyrowheight="-1" hideVscroll="否" SetRowHeight="是" usertitle="否" usertitlehtml titlerows titlerowheight readonly="否" autoappend="否" autowidth="否" autoheight="否" canselect="是" hideHscroll="否" autosize="否"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 27px; LEFT: 763px" id=dataset3 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" formatxml='<root><tr rowstate="add"><td>a</td><td>新建字段</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' pubpara="否" iscreatetable="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1" Like="否" chnname temptable="TMP_DATASET1"></DIV>