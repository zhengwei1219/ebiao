<script>/*&#13;&#10;<ds dbencoding="GBK" dbtype="sqlserver" drivername="com.newatlanta.jturbo.driver.Driver" &#13;&#10;encodesql="false" name="sqlserver1" password="" &#13;&#10;url="jdbc:JTurbo://localhost/mytest/charset=GBK" userid="sa" /> &#13;&#10;&#13;&#10;*/&#13;&#10;function uf_open() {&#13;&#10;	var obj = fcpubdata.obj ;&#13;&#10;	if(IsSpace(obj) == false ){&#13;&#10;		txtName.value = obj.getAttribute("name");&#13;&#10;		cboDbtype.value = obj.getAttribute("dbtype");&#13;&#10;		cboDbencoding.value = obj.getAttribute("dbencoding");&#13;&#10;		SetCheckBoxValue(chkEncodesql , obj.getAttribute("encodesql"));&#13;&#10;		txtDrivername.value = obj.getAttribute("drivername");&#13;&#10;		txtUrl.value = obj.getAttribute("url");&#13;&#10;		txtUserid.value = obj.getAttribute("userid");&#13;&#10;		txtPassword.value = obj.getAttribute("password");&#13;&#10;		&#13;&#10;		//扩展属性&#13;&#10;		var sExpand="";&#13;&#10;		var oMap = obj.attributes;&#13;&#10;		for(var i=0;i<oMap.length;i++){&#13;&#10;			var sName = oMap.item(i).name;&#13;&#10;			if(sName == "name" || sName == "dbtype" || sName == "dbencoding" || sName == "encodesql" || sName == "drivername" || sName == "url" || sName == "userid" || sName=="password")	continue;&#13;&#10;			sExpand += sName+"="+oMap.item(i).value+"\r\n";&#13;&#10;		}&#13;&#10;		if(sExpand != "") sExpand = sExpand.substring(0,sExpand.length-2);&#13;&#10;		txtExpand.value = sExpand;&#13;&#10;	}&#13;&#10;	if(fcpubdata.dotnetVersion == ""){&#13;&#10;		lblDriver.value = "Sql Server写法:com.newatlanta.jturbo.driver.Driver";&#13;&#10;		lblDriver1.value = "oracle写法:oracle.jdbc.driver.OracleDriver";&#13;&#10;		lblUrl.value = "SqlServer写法:jdbc:JTurbo://localhost/数据库名/charset=GBK";&#13;&#10;		lblUrl1.value = "oracle写法:jdbc:oracle:thin:@localhost:1521:数据库名";&#13;&#10;	}&#13;&#10;	e_PropWinOnload();&#13;&#10;}&#13;&#10;function uf_ok() {&#13;&#10;	if(IsSpace(txtName.value)){&#13;&#10;		alert("数据源名称不能为空!");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	if(IsSpace(txtDrivername.value)){&#13;&#10;		alert("驱动程序不能为空!");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	if(IsSpace(txtUrl.value)){&#13;&#10;		alert("数据源URL不能为空!");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	if(IsSpace(txtUserid.value)){&#13;&#10;		alert("用户名不能为空!");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	//扩展属性&#13;&#10;	var sRetExp="";&#13;&#10;	var sExpand = txtExpand.value;&#13;&#10;	if(IsSpace(sExpand) == false){&#13;&#10;		var arr = sExpand.split("\r\n");&#13;&#10;		for(var i=0;i<arr.length;i++){&#13;&#10;			var pos = arr[i].indexOf("=");&#13;&#10;			if(pos > 0){&#13;&#10;				var propName = arr[i].substring(0,pos);	&#13;&#10;				var propValue = arr[i].substring(pos+1);&#13;&#10;				sRetExp += propName+"=\""+propValue+"\" ";&#13;&#10;			}	&#13;&#10;		}	&#13;&#10;	}&#13;&#10;	var sRet = "<ds ";&#13;&#10;	sRet += "dbencoding=\"" +cboDbencoding.value +"\" ";&#13;&#10;	sRet += "dbtype=\"" +cboDbtype.value +"\" ";&#13;&#10;	sRet += "drivername=\"" +txtDrivername.value +"\" ";&#13;&#10;	sRet += "encodesql=\"" +chkEncodesql.value +"\" ";&#13;&#10;	sRet += "name=\"" +txtName.value +"\" ";&#13;&#10;	sRet += "password=\"" +txtPassword.value +"\" ";&#13;&#10;	sRet += "url=\"" +txtUrl.value +"\" ";&#13;&#10;	sRet += "userid=\"" +txtUserid.value +"\" ";&#13;&#10;	sRet += sRetExp;&#13;&#10;	sRet += "/>";&#13;&#10;	window.returnValue=sRet;&#13;&#10;	//alert(sRet);&#13;&#10;	CloseBill();&#13;&#10;&#13;&#10;&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" center="居中" unselectable="on" keyfield controlno="SKButton:0;SKDBedit:0;checkbox:1;label:9;radio:0;listbox:1;textarea:1;combobox:2;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:1;div:0;DsMain_field:0;a:0;button:4;text:6;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0" posheight="320" poswidth="390" entertype="修改" codeheader="BBB" mkbh caption="数据源修改" type="PR" dj_sn="eb_dsn1" billtaborder="<root><taborder>chkEncodesql</taborder><taborder>cboDbtype</taborder><taborder>cboDbencoding</taborder><taborder>txtName</taborder><taborder>txtDrivername</taborder><taborder>lblDriver</taborder><taborder>lblDriver1</taborder><taborder>txtUrl</taborder><taborder>lblUrl</taborder><taborder>txtUserid</taborder><taborder>txtPassword</taborder><taborder>lblUrl1</taborder><taborder>txtExpand</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" contxml="<root><checkbox><id>chkEncodesql</id></checkbox><label><id>label1</id><id>label2</id><id>label3</id><id>label4</id><id>label5</id><id>label6</id><id>label7</id><id>label9</id></label><textarea><id>txtExpand</id></textarea><combobox><id>cboDbtype</id><id>cboDbencoding</id></combobox><tab><id>tab1</id></tab><a><id>SKDBLike2</id></a><button><id>cmdOk</id><id>cmdClose</id></button><text><id>txtName</id><id>txtDrivername</id><id>lblDriver</id><id>lblDriver1</id><id>txtUrl</id><id>lblUrl</id><id>txtUserid</id><id>txtPassword</id><id>lblUrl1</id></text></root>" BLONopen="uf_open()" toolbar="不带工具栏" window="有模式窗口" posleft postop isfile="是" OtherSave="否" idtype="1" BLONopenBefore BLONclose runsave>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<DIV id=tab1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=page_onresize() style="LEFT: 1px; WIDTH: 378px; POSITION: absolute; TOP: 1px; HEIGHT: 274px" onmovestart=moveStart() controltype="tab" value="扩展" CustomAttr>
<TABLE onmousedown=pageonclick() id=fcpagesubtable onresizestart=CancelEvent() bgColor=white>
<TBODY>
<TR contentEditable=false>
<TD style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; COLOR: red; BACKGROUND-COLOR: white" align=middle width=80 height=20><FONT size=2>基本</FONT></TD>
<TD style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; COLOR: black; BACKGROUND-COLOR: white" align=middle width=80 height=20><FONT size=2>扩展</FONT></TD></TR></TBODY></TABLE>
<DIV oncontrolselect=controlselect() id=fcpagesub onresizestart=CancelEvent() style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; Z-INDEX: 1; BORDER-LEFT: #8ba7b6 1px solid; WIDTH: 376px; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; TOP: 22px; HEIGHT: 254px; BACKGROUND-COLOR: white" onmovestart=CancelEvent()>
<DIV onmove=move() oncontrolselect=controlselect() id=label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 14px; WIDTH: 36px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 10px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label1" NotBg="否">数据源名称:</DIV><INPUT onmove=move() oncontrolselect=controlselect() id=txtName onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 97px; WIDTH: 142px; POSITION: absolute; TOP: 6px; HEIGHT: 20px" onmovestart=moveStart() size=25 controltype="text"> 
<DIV onmove=move() oncontrolselect=controlselect() id=label2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 14px; WIDTH: 18px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 29px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label2" NotBg="否">类型:</DIV><SELECT onmove=move() oncontrolselect=controlselect() id=cboDbtype onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 56px; WIDTH: 105px; POSITION: absolute; TOP: 28px; HEIGHT: 25px" onmovestart=moveStart() controltype="combobox" tempvalue="0&#13;&#10;1&#13;&#10;2&#13;&#10;3&#13;&#10;4&#13;&#10;5&#13;&#10;6&#13;&#10;7&#13;&#10;8&#13;&#10;9&#13;&#10;10" temptext="未知&#13;&#10;oracle&#13;&#10;sqlserver&#13;&#10;sybase&#13;&#10;sqlany&#13;&#10;informix&#13;&#10;foxpro&#13;&#10;access&#13;&#10;foxbase&#13;&#10;db2&#13;&#10;mysql" check="1" sql backwidth="105" backheight="25"><OPTION value=0>未知</OPTION><OPTION value=1>oracle</OPTION><OPTION value=2 selected>sqlserver</OPTION><OPTION value=3>sybase</OPTION><OPTION value=4>sqlany</OPTION><OPTION value=5>informix</OPTION><OPTION value=6>foxpro</OPTION><OPTION value=7>access</OPTION><OPTION value=8>foxbase</OPTION><OPTION value=9>db2</OPTION><OPTION value=10>mysql</OPTION></SELECT> 
<DIV onmove=move() oncontrolselect=controlselect() id=label3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 14px; WIDTH: 18px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 54px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label3" NotBg="否">编码:</DIV><SELECT onmove=move() oncontrolselect=controlselect() id=cboDbencoding onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 56px; WIDTH: 105px; POSITION: absolute; TOP: 52px; HEIGHT: 25px" onmovestart=moveStart() controltype="combobox" tempvalue="GBK&#13;&#10;iso-8859-1" temptext="GBK&#13;&#10;iso-8859-1" check="1" sql backwidth="105" backheight="25"><OPTION value=GBK selected>GBK</OPTION><OPTION value=iso-8859-1>iso-8859-1</OPTION></SELECT> 
<DIV onmove=move() oncontrolselect=controlselect() id=label4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 15px; WIDTH: 30px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 81px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label4" NotBg="否">驱动程序:</DIV><INPUT onmove=move() oncontrolselect=controlselect() id=txtDrivername onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 15px; WIDTH: 350px; POSITION: absolute; TOP: 96px; HEIGHT: 20px" onmovestart=moveStart() size=43 controltype="text"><INPUT onmove=move() oncontrolselect=controlselect() id=lblDriver onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FONT-SIZE: 12px; LEFT: 17px; BORDER-LEFT: 0px; WIDTH: 306px; COLOR: #b2b2b2; BORDER-BOTTOM: 0px; POSITION: absolute; TOP: 118px; HEIGHT: 20px" onmovestart=moveStart() readOnly size=55 value="Sql Server写法: Provider=SQLOLEDB" controltype="text"><INPUT onmove=move() oncontrolselect=controlselect() id=lblDriver1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FONT-SIZE: 12px; LEFT: 17px; BORDER-LEFT: 0px; WIDTH: 306px; COLOR: #b2b2b2; BORDER-BOTTOM: 0px; POSITION: absolute; TOP: 135px; HEIGHT: 16px" onmovestart=moveStart() readOnly size=54 value=oracle写法:Provider=OraOLEDB.Oracle controltype="text"> 
<DIV onmove=move() oncontrolselect=controlselect() id=label5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 14px; WIDTH: 42px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 152px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label5" NotBg="否">数据源URL:</DIV><INPUT onmove=move() oncontrolselect=controlselect() id=txtUrl onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 14px; WIDTH: 352px; POSITION: absolute; TOP: 166px; HEIGHT: 20px" onmovestart=moveStart() size=42 controltype="text"><INPUT onmove=move() oncontrolselect=controlselect() id=lblUrl onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FONT-SIZE: 12px; LEFT: 11px; BORDER-LEFT: 0px; WIDTH: 360px; COLOR: #b2b2b2; BORDER-BOTTOM: 0px; POSITION: absolute; TOP: 188px; HEIGHT: 20px" onmovestart=moveStart() readOnly size=64 value="Sql Server写法:Data Source=机器名;Initial Catalog=数据库名" controltype="text"> 
<DIV onmove=move() oncontrolselect=controlselect() id=label6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 12px; WIDTH: 24px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 225px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label6" NotBg="否">用户名:</DIV><INPUT onmove=move() oncontrolselect=controlselect() id=txtUserid onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 59px; WIDTH: 89px; POSITION: absolute; TOP: 222px; HEIGHT: 20px" onmovestart=moveStart() size=16 controltype="text"> 
<DIV onmove=move() oncontrolselect=controlselect() id=label7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 241px; WIDTH: 18px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 226px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label7" NotBg="否">口令:</DIV><INPUT onmove=move() oncontrolselect=controlselect() id=txtPassword onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 276px; WIDTH: 89px; POSITION: absolute; TOP: 223px; HEIGHT: 20px" onmovestart=moveStart() size=16 controltype="text"><A onmove=move() oncontrolselect=controlselect() id=SKDBLike2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-WEIGHT: bold; FONT-SIZE: 16px; LEFT: 340px; WIDTH: 12px; COLOR: #0000ff; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 123px; HEIGHT: 18px; backgroundColor1: #ffffff" onmovestart=moveStart() href="javascript:ShowHelp('on_eb_dsn')" target=_self controltype="a" NotBg="否" href1="javascript:ShowHelp('on_eb_dsn')">?</A> 
<DIV onmove=move() oncontrolselect=controlselect() id=chkEncodesql onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12px; LEFT: 160px; WIDTH: 80px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 76px; HEIGHT: 20px" onmovestart=moveStart() noWrap controltype="checkbox" value="false" NotBg="否" falsevalue="false" truevalue="true" divtype="checkbox"><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>转换SQL编码</SPAN></DIV><INPUT onmove=move() oncontrolselect=controlselect() id=lblUrl1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FONT-SIZE: 12px; LEFT: 11px; BORDER-LEFT: 0px; WIDTH: 360px; COLOR: #b2b2b2; BORDER-BOTTOM: 0px; POSITION: absolute; TOP: 202px; HEIGHT: 20px" onmovestart=moveStart() readOnly size=64 value="oracle写法:Data Source=数据库名" controltype="text"></DIV>
<DIV oncontrolselect=controlselect() id=fcpagesub onresizestart=CancelEvent() style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; WIDTH: 376px; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; TOP: 22px; HEIGHT: 254px; BACKGROUND-COLOR: white" onmovestart=CancelEvent()><TEXTAREA onmove=move() oncontrolselect=controlselect() id=txtExpand onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 3px; WIDTH: 363px; POSITION: absolute; TOP: 22px; HEIGHT: 201px" onmovestart=moveStart() rows=4 cols=71 controltype="textarea" value="textarea1" induce="否">schemaPattern=</TEXTAREA><LABEL onmove=move() oncontrolselect=controlselect() id=label9 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 9px; WIDTH: 353px; POSITION: absolute; TOP: 5px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">扩展属性: (每行一个属性,格式为: 属性名=属性值)</LABEL></DIV></DIV><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdOk onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 236px; WIDTH: 55px; POSITION: absolute; TOP: 278px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_ok()")' dropstyle="否"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdClose onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 299px; WIDTH: 55px; POSITION: absolute; TOP: 278px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("CloseBill()")' dropstyle="否"></BUTTON></DIV>