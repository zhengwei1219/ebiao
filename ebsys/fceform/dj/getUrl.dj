<script>var initPath ; //初始路径,无论是否为绝对路径&#13;&#10;var offsetPath ="" ; //通过在此界面上操作产生的偏移路径&#13;&#10;var strType = "file"; //=url表示只返回和显示目录&#13;&#10;var isVir = "yes" //是否虚拟目录.yes:虚拟根目录则传“../”或“”或“..”,其它按目录结构列../JHSoft.Web.Module ；no:E:\ &#13;&#10;var displayType = "list";	//显示方式, =list 表示多列且只显示名称&#13;&#10;var fileExts = ""; //显示的文件扩展名 htm|js|txt|jpg|gif&#13;&#10;var curSel = null ; //当前选中即变了颜色的span对象.&#13;&#10;var isWriteName = "no"; //是否写文件名&#13;&#10;function uf_open()&#13;&#10;{&#13;&#10;	initPath = fcpubdata.obj[0];&#13;&#10;	if(typeof initPath =="undefined"){&#13;&#10;		alert("初始路径未定义!");&#13;&#10;		window.close();&#13;&#10;		return;	&#13;&#10;	}&#13;&#10;	var sEnd = initPath.substring(initPath.length-1,initPath.length) ; &#13;&#10;	if(sEnd == "/" || sEnd == "\\") initPath = initPath.substring(0,initPath.length-1);&#13;&#10;	&#13;&#10;	if(IsSpace(fcpubdata.obj[1]) == false)	strType = fcpubdata.obj[1];&#13;&#10;	if(IsSpace(fcpubdata.obj[2]) == false)	isVir = fcpubdata.obj[2];&#13;&#10;	if(IsSpace(fcpubdata.obj[3]) == false)	fileExts = fcpubdata.obj[3];&#13;&#10;	if(IsSpace(fcpubdata.obj[4]) == false)	isWriteName = fcpubdata.obj[4];&#13;&#10;	if(isWriteName == "yes"){&#13;&#10;		lblFileName.style.display = "";&#13;&#10;		txtFileName.style.display = "";&#13;&#10;	}&#13;&#10;&#13;&#10;	SetButtonImage(btnUp,"../../fceform/images/ef_open_up.gif");&#13;&#10;	//SetButtonImage(btnOK,"../../fceform/images/ef_run_button_ok.gif");&#13;&#10;	//SetButtonImage(btnCancel,"../../fceform/images/ef_run_button_close.gif");&#13;&#10;	&#13;&#10;	if (displayType == "")&#13;&#10;		SetButtonImage(btnList,"../../fceform/images/ef_open_list1.gif");&#13;&#10;	else&#13;&#10;		SetButtonImage(btnList,"../../fceform/images/ef_open_list.gif");&#13;&#10;&#13;&#10;&#13;&#10;	txtInitPath.value = initPath;&#13;&#10;	div1.ondblclick = uf_GetSub ;&#13;&#10;	div1.onclick = uf_changBgColor ;&#13;&#10;	&#13;&#10;	var strXml = "<Scope>"+initPath+"</Scope><ReturnType>"+strType+"</ReturnType><IsVir>"+isVir+"</IsVir><DisplayType>"+displayType+"</DisplayType><Files>"+fileExts+"</Files>";&#13;&#10;	&#13;&#10;	new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host + fcpubdata.servletPath + "/WebBill"+fcpubdata.dotnetVersion+"?key=GetUrl",strXml,function (result){&#13;&#10;		&#13;&#10;		var sRet = result.value;&#13;&#10;		if(sRet != null){&#13;&#10;			if(sRet.substring(0,7) != "<table "){&#13;&#10;				alert(sRet);&#13;&#10;				window.close();	&#13;&#10;				return;&#13;&#10;			}&#13;&#10;			$id("div1").innerHTML = sRet;&#13;&#10;		}&#13;&#10;		uf_tableStyle();&#13;&#10;		uf_ctrlDisabled(false);&#13;&#10;		&#13;&#10;	});&#13;&#10;	&#13;&#10;	uf_ctrlDisabled(true);&#13;&#10;	PropWinOnload();&#13;&#10;	window.attachEvent("onresize",uf_ResizeDiv);&#13;&#10;}&#13;&#10;//确定返回&#13;&#10;function uf_ok()&#13;&#10;{&#13;&#10;	var strTemp ;&#13;&#10;	var strReturn = "";&#13;&#10;	if(curSel != null) {&#13;&#10;		strReturn =  curSel.innerText;&#13;&#10;		if(curSel.type == "Dir" && strType == "file" && strReturn.length > 0 ){&#13;&#10;			uf_GetSub(curSel);&#13;&#10;			return;&#13;&#10;		}&#13;&#10;	}&#13;&#10;	if(strType == "url" && tab1.rows.length == 0){&#13;&#10;		strTemp = offsetPath;&#13;&#10;	}else if (strType == "file" && strReturn.length == 0 && isWriteName == "no"){&#13;&#10;		alert("请选择文件。");&#13;&#10;		return; &#13;&#10;	}else if (strType == "file" && strReturn.length == 0 && isWriteName == "yes"){&#13;&#10;		strTemp = offsetPath;&#13;&#10;	}else{&#13;&#10;		strTemp = offsetPath+"/"+strReturn;&#13;&#10;	}&#13;&#10;	//alert(strTemp+"=="+curSel.innerText);&#13;&#10;	if(isWriteName == "yes") {&#13;&#10;		if(IsSpace(txtFileName.value)){&#13;&#10;			alert("请输入文件名");&#13;&#10;			return;&#13;&#10;		}&#13;&#10;		strTemp = strTemp +"/" +  txtFileName.value ;&#13;&#10;	}&#13;&#10;	window.returnValue = strTemp;&#13;&#10;	window.close();&#13;&#10;}&#13;&#10;&#13;&#10;function uf_ctrlDisabled(blDisabled)&#13;&#10;{&#13;&#10;	$id("btnUp").disabled = blDisabled ;&#13;&#10;	$id("btnList").disabled = blDisabled ;&#13;&#10;	$id("div1").disabled = blDisabled ;&#13;&#10;}&#13;&#10;&#13;&#10;//表格样式&#13;&#10;function uf_tableStyle()&#13;&#10;{&#13;&#10;	if ($id("div1").innerHTML.length>0)&#13;&#10;		$id("tab1").style.fontSize = "12px";	&#13;&#10;}&#13;&#10;//替换背景色&#13;&#10;function uf_changBgColor()&#13;&#10;{&#13;&#10;	var spanColor = "#f6f6f6";&#13;&#10;	if (displayType != "") 	spanColor = "#FFFFFF";&#13;&#10;&#13;&#10;	var obj = event.srcElement;&#13;&#10;	if (obj.tagName.toLowerCase() != "span") {&#13;&#10;		if (obj.parentNode.tagName.toLowerCase() != "span") {&#13;&#10;			return;&#13;&#10;		}else{&#13;&#10;			obj = obj.parentNode;			&#13;&#10;		}		&#13;&#10;	}&#13;&#10;&#13;&#10;	if(curSel != null ){&#13;&#10;		curSel.style.backgroundColor = spanColor;&#13;&#10;		curSel.style.color = "#000000";&#13;&#10;	}&#13;&#10;&#13;&#10;	obj.style.backgroundColor = "#3300cc";&#13;&#10;	obj.style.color = spanColor;&#13;&#10;	curSel = obj;&#13;&#10;}&#13;&#10;&#13;&#10;//查询子目录及文件&#13;&#10;function uf_GetSub(objSpan)&#13;&#10;{&#13;&#10;	if(typeof objSpan == "undefined"){&#13;&#10;		var obj = event.srcElement;&#13;&#10;		if (obj.tagName.toLowerCase() != "span") {&#13;&#10;			if (obj.parentNode.tagName.toLowerCase() != "span") {&#13;&#10;				return;&#13;&#10;			}else{&#13;&#10;				obj = obj.parentNode;			&#13;&#10;			}		&#13;&#10;		}&#13;&#10;	}else{&#13;&#10;		var obj = objSpan;&#13;&#10;	}&#13;&#10;	if (obj.type == "Dir")&#13;&#10;	{&#13;&#10;		var tmp1 = offsetPath+"/"+obj.innerText ;&#13;&#10;		var strXml = "<Scope>"+(initPath+tmp1)+"</Scope><ReturnType>"+strType+"</ReturnType><IsVir>"+isVir+"</IsVir><DisplayType>"+displayType+"</DisplayType><Files>"+fileExts+"</Files>";&#13;&#10;		new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host + fcpubdata.servletPath + "/WebBill"+fcpubdata.dotnetVersion+"?key=GetUrl",strXml,function (result){&#13;&#10;			var sRet = result.value;&#13;&#10;			if(sRet.substring(0,7) != "<table "){&#13;&#10;				alert(sRet);&#13;&#10;				return;&#13;&#10;			}&#13;&#10;			$id("div1").innerHTML = sRet;&#13;&#10;			//alert(tmp1);&#13;&#10;			offsetPath =tmp1;&#13;&#10;			txtInitPath.value = initPath +offsetPath;&#13;&#10;			uf_tableStyle();&#13;&#10;			&#13;&#10;		});	&#13;&#10;		&#13;&#10;	}&#13;&#10;	if (obj.type == "File")&#13;&#10;	{&#13;&#10;		uf_ok();	&#13;&#10;	}	&#13;&#10;}&#13;&#10;&#13;&#10;//返回上级目录&#13;&#10;function uf_GoUp()&#13;&#10;{&#13;&#10;	if(offsetPath == "") {&#13;&#10;		alert("已到根目录!");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	var ipos = offsetPath.lastIndexOf("/");&#13;&#10;	if(ipos<0) return;&#13;&#10;	var sTmp = offsetPath.substring(0,ipos);&#13;&#10;	&#13;&#10;	var strXml = "<Scope>"+(initPath+sTmp)+"</Scope><ReturnType>"+strType+"</ReturnType><IsVir>"+isVir+"</IsVir><DisplayType>"+displayType+"</DisplayType><Files>"+fileExts+"</Files>";&#13;&#10;	new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host + fcpubdata.servletPath + "/WebBill"+fcpubdata.dotnetVersion+"?key=GetUrl",strXml,function (result){&#13;&#10;		var sRet = result.value;&#13;&#10;		if(sRet.substring(0,7) != "<table "){&#13;&#10;			alert(sRet);&#13;&#10;			return;&#13;&#10;		}&#13;&#10;		$id("div1").innerHTML = sRet;&#13;&#10;		offsetPath = sTmp;&#13;&#10;		txtInitPath.value = initPath +offsetPath;&#13;&#10;		uf_tableStyle();&#13;&#10;		&#13;&#10;	});	&#13;&#10;	&#13;&#10;		&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;//列表式装载文件&#13;&#10;function uf_LoadList()&#13;&#10;{&#13;&#10;	if (displayType == "")&#13;&#10;	{&#13;&#10;		displayType = "list";&#13;&#10;		SetButtonImage(btnList,"../../fceform/images/ef_open_list.gif");&#13;&#10;	}&#13;&#10;	else&#13;&#10;	{&#13;&#10;		displayType = "";&#13;&#10;		SetButtonImage(btnList,"../../fceform/images/ef_open_list1.gif");&#13;&#10;	}&#13;&#10;	&#13;&#10;	var strPath = initPath + offsetPath;&#13;&#10;	var strXml = "<Scope>"+strPath+"</Scope><ReturnType>"+strType+"</ReturnType><IsVir>"+isVir+"</IsVir><DisplayType>"+displayType+"</DisplayType><Files>"+fileExts+"</Files>";&#13;&#10;	//alert(strXml);&#13;&#10;	new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host + fcpubdata.servletPath + "/WebBill"+fcpubdata.dotnetVersion+"?key=GetUrl",strXml,function (result){&#13;&#10;			var sRet = result.value;&#13;&#10;			uf_ctrlDisabled(false);&#13;&#10;			if(sRet.substring(0,7) != "<table "){&#13;&#10;				alert(sRet);&#13;&#10;				return;&#13;&#10;			}&#13;&#10;			$id("div1").innerHTML = sRet;&#13;&#10;			uf_tableStyle();&#13;&#10;			&#13;&#10;		});&#13;&#10;	uf_ctrlDisabled(true);&#13;&#10;}&#13;&#10;/**&#13;&#10; * 功能：窗口发生变化时调整显示内容的div的大小&#13;&#10; * 日期：2010-4-29 14:50&#13;&#10; * 作者：刘欣茹&#13;&#10;**/&#13;&#10;function uf_ResizeDiv()&#13;&#10;{&#13;&#10;   var winWidth = document.body.clientWidth;      //510&#13;&#10;   var winHeight = document.body.clientHeight;    //411&#13;&#10;   if (winHeight> 411 || winHeight <400 ) window.dialogHeight = "411px";&#13;&#10;   if (winWidth >1000) window.dialogWidth = "1000px";&#13;&#10;   if (winWidth <500) window.dialogWidth = "510px";&#13;&#10;   &#13;&#10;   div1.style.width = winWidth-10;&#13;&#10;   cmdClose.style.left = winWidth-86;&#13;&#10;   cmdOk.style.left = winWidth-178;&#13;&#10;   &#13;&#10;   //alert(winWidth);&#13;&#10;   //alert(winHeight);&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" userType BLONclose BLONopenBefore idtype="1" OtherSave="否" isfile="是" postop posleft window="有模式窗口" toolbar="不带工具栏" BLONopen="uf_open();" contxml="<root><label><id>label2</id><id>lblFileName</id></label><div><id>btnUp</id><id>div1</id><id>btnList</id></div><button><id>cmdClose</id><id>cmdOk</id></button><text><id>txtInitPath</id><id>txtFileName</id></text></root>" billtaborder="<root><taborder>cmdClose</taborder><taborder>txtInitPath</taborder><taborder>txtFileName</taborder><taborder>cmdOk</taborder><taborder>btnUp</taborder></root>" dj_sn="getUrl" type="ST" caption="选择文件" mkbh codeheader="BBB" entertype="修改" poswidth="500" posheight="410" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:5;radio:0;listbox:0;textarea:2;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:1;SKBILLgrid:0;shape:0;tab:0;div:3;DsMain_field:0;a:0;button:4;text:5;hr:0;checkboxlist:0;radiolist:0;dropdownlist:1;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" keyfield unselectable="on" center="居中"><DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; WIDTH: 24px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 22px; FONT-SIZE: 12px; BORDER-TOP: 0px; TOP: 2px; BORDER-RIGHT: 0px; LEFT: 419px" id=btnUp onresize=resize() onmove=move() onmoveend=moveEnd() onresizestart=resizeStart() controltype="div" CustomAttr="title=向上一级" dropstyle="否" fc_onclick='bill_onclick("uf_GoUp();")' NotBg="否"></DIV>
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="BORDER-BOTTOM: #d6d3bd 1px solid; POSITION: absolute; BORDER-LEFT: #d6d3bd 1px solid; OVERFLOW-X: auto; OVERFLOW-Y: auto; BACKGROUND-COLOR: #ffffff; FONT-STYLE: normal; WIDTH: 483px; FONT-FAMILY: 宋体; HEIGHT: 315px; FONT-SIZE: 10pt; OVERFLOW: auto; BORDER-TOP: #d6d3bd 1px solid; TOP: 28px; BORDER-RIGHT: #d6d3bd 1px solid; LEFT: 3px" id=div1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="div" NotBg="否"></DIV><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; WIDTH: 76px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 347px; LEFT: 400px" id=cmdClose onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("window.close();")'></BUTTON> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 35px; HEIGHT: 15px; TOP: 7px; LEFT: 15px" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label2" NotBg="否">路径：</DIV><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 361px; HEIGHT: 20px; TOP: 4px; LEFT: 52px" id=txtInitPath onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() readOnly size=62 controltype="text"> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 45px; DISPLAY: none; HEIGHT: 15px; TOP: 353px; LEFT: 8px" id=lblFileName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label4" NotBg="否">文件名:</DIV><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 225px; DISPLAY: none; HEIGHT: 20px; TOP: 350px; LEFT: 59px" id=txtFileName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=40 controltype="text"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; WIDTH: 76px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 347px; LEFT: 318px" id=cmdOk onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'></BUTTON> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; WIDTH: 21px; HEIGHT: 22px; BORDER-TOP: 0px; TOP: 3px; BORDER-RIGHT: 0px; LEFT: 454px" id=btnList onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="div" CustomAttr="title=切换排列方式" fc_onclick='bill_onclick("uf_LoadList();")' NotBg="否"></DIV></DIV>