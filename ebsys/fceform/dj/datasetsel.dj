<script>function uf_open() {&#13;&#10;	new Eapi.DbStru().listTables(dssub2);&#13;&#10;	new Eapi.DbStru().listTables($id("savetable"));	&#13;&#10;	PropWinOnload();&#13;&#10;}&#13;&#10;function uf_scroll(tbname) {&#13;&#10;	if(fcpubdata.dbStruDict == "FC_ENTITY"){&#13;&#10;		var sXml = metadata_dataset(tbname);&#13;&#10;		&#13;&#10;		dssub3.OpenXmlData(sXml);&#13;&#10;		&#13;&#10;	}else{&#13;&#10;		new Eapi.DbStru().listFields(tbname,dssub3);&#13;&#10;	}&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;	//传表名,供设计时用.&#13;&#10;	fcpubdata.obj.queryTableName = dssub2.Field('tbname').Value;&#13;&#10;  	copydatasetsel(dssub3,fcpubdata.obj)&#13;&#10;  	CloseBill();&#13;&#10;}&#13;&#10;function uf_checked(grid,dsSel){&#13;&#10;    grid=SKBILLgrid3&#13;&#10;    dsSel=dssub3&#13;&#10;&#13;&#10;    var sok="url(../images/ef_run_grid_gou.gif)"&#13;&#10;    for(var i=1;i<grid.tab.rows.length;i++){&#13;&#10;       grid.tab.rows(i).cells(0).style.backgroundImage=sok ;&#13;&#10;       grid.tab.rows(i).cells(0).style.backgroundRepeat="no-repeat"&#13;&#10;       grid.tab.rows(i).className="invert"&#13;&#10;    }&#13;&#10;    for(var j=0;j<dsSel.oDom.documentElement.childNodes.length;j++){&#13;&#10;       dsSel.oDom.documentElement.childNodes(j).setAttribute("multisel","是");&#13;&#10;    }&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() onkeydown="" id=SKbillsheet class=dj ondblclick="" contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;" userType dj_sn="datasetsel" caption="批量增加字段" type="LR" isfile="是" center="居中" posleft postop poswidth="685" posheight="509" toolbar="不带工具栏" window="有模式窗口" BLONopen="uf_open()" BLONopenBefore BLONclose idtype="1" entertype="修改" keyfield codeheader OtherSave="否" billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>SKButton3</taborder><taborder>SKBILLgrid2</taborder><taborder>SKBILLgrid3</taborder><taborder>savetable</taborder></root>" controlno="SKButton:3;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:3;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" contxml="<root><label><id>label1</id></label><button><id>cmdOk</id><id>cmdClose</id><id>SKButton3</id></button><dropdownlist><id>savetable</id></dropdownlist><grid><id>SKBILLgrid2</id><id>SKBILLgrid3</id></grid><dataset><id>dssub2</id><id>dssub3</id></dataset></root>" unselectable="on" mkbh="E5" blmode="其它" dj_id="319" para="<r></r>"><IMG style="POSITION: absolute; WIDTH: 260px; HEIGHT: 440px; TOP: 4px; LEFT: 6px" id=SKBILLgrid2 src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dssub2" visible="是" readonly="否" autoappend="否" autowidth="否" autoheight="否" canselect="是"><IMG style="POSITION: absolute; WIDTH: 70px; HEIGHT: 70px; TOP: 4px; LEFT: 6px" id=dssub2 src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" datasourceName saveastable formatxml="<root><tr rowstate=&quot;edit&quot;><td>tbname</td><td>西文表名</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>_blank</td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td>uf_scroll(dssub2.Field('tbname').Value)</td><td></td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>chnname</td><td>中文名称</td><td>字符</td><td>40</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>_blank</td><td></td><td>left</td><td>150</td><td></td><td></td><td></td><td></td><td>uf_scroll(dssub2.Field('tbname').Value)</td><td></td><td></td><td></td></tr></root>" pubpara="否" iscreatetable="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="2" isaddemptyrec="否" submittype="1" submitno="1" savetable idparam issubds="否" subdsfield masterds masterdsfield Like="否" chnname temptable="TMP_LRGRID2" isSubGrid="否"><IMG style="POSITION: absolute; WIDTH: 396px; HEIGHT: 440px; TOP: 4px; LEFT: 270px" id=SKBILLgrid3 src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dssub3" visible="是" readonly="否" autoappend="否" autowidth="否" autoheight="否" canselect="是"><IMG style="POSITION: absolute; WIDTH: 70px; HEIGHT: 70px; TOP: 4px; LEFT: 270px" id=dssub3 src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" datasourceName saveastable formatxml='<root><tr rowstate="edit"><td>fdname</td><td>西文字段名</td><td>字符</td><td>20</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>_blank</td><td></td><td>left</td><td>100</td><td></td><td></td><td></td><td></td><td></td><td>GridMultiSel(SKBILLgrid3,dssub3)</td><td></td><td></td></tr><tr rowstate="edit"><td>chnname</td><td>中文名称</td><td>字符</td><td>40</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>_blank</td><td></td><td>left</td><td>150</td><td></td><td></td><td></td><td></td><td></td><td>GridMultiSel(SKBILLgrid3,dssub3)</td><td></td><td></td></tr><tr rowstate="edit"><td>fdtype</td><td>类型</td><td>字符</td><td>4</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>_blank</td><td></td><td>left</td><td>36</td><td></td><td></td><td></td><td></td><td></td><td>GridMultiSel(SKBILLgrid3,dssub3)</td><td></td><td></td></tr><tr rowstate="edit"><td>fdsize</td><td>宽度</td><td>整数</td><td>2</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>_blank</td><td></td><td>right</td><td>36</td><td></td><td></td><td></td><td></td><td></td><td>GridMultiSel(SKBILLgrid3,dssub3)</td><td></td><td></td></tr><tr rowstate="edit"><td>fddec</td><td>精度</td><td>整数</td><td>2</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>_blank</td><td></td><td>right</td><td>36</td><td></td><td></td><td></td><td></td><td></td><td>GridMultiSel(SKBILLgrid3,dssub3)</td><td></td><td></td></tr></root>' pubpara="否" iscreatetable="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="3" isaddemptyrec="否" submittype="1" submitno="1" savetable idparam issubds="否" subdsfield masterds masterdsfield Like="否" chnname temptable="TMP_LRGRID3" isSubGrid="否"><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 448px; LEFT: 495px" id=cmdOk type=button controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 448px; LEFT: 573px" id=cmdClose type=button controltype="button" dropstyle="否" fc_onclick='bill_onclick("CloseBill()")'><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 447px; LEFT: 405px" id=SKButton3 value=全选 type=button controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_checked(SKBILLgrid3,dssub3)")'><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 41px; HEIGHT: 15px; TOP: 452px; LEFT: 12px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">表名:</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 206px; HEIGHT: 20px; TOP: 450px; LEFT: 55px; ButtonWidth: 10" id=savetable onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" type="divbox" controltype="dropdownlist" visible="是" datasourceName onselchange='bill_onclick("uf_scroll(savetable.value)")' sql2 sql1 xml multiselect="否" addrow="否" blnempty="否" blninput="是" check="1" sql tempvalue temptext format="英文表名|中文表名"></DIV>