<script>/*&#13;&#10;<ds dbencoding="GBK" dbtype="sqlserver" drivername="com.newatlanta.jturbo.driver.Driver" &#13;&#10;encodesql="false" name="sqlserver1" password="" &#13;&#10;url="jdbc:JTurbo://localhost/mytest/charset=GBK" userid="sa" /> &#13;&#10;&#13;&#10;*/&#13;&#10;function uf_open() {&#13;&#10;	uf_refresh();&#13;&#10;	e_PropWinOnload();&#13;&#10;}&#13;&#10;function uf_refresh() {&#13;&#10;	var oXml = SetDomFile("../.."+fcpubdata.userDir+"/xml/econfig.xml");&#13;&#10;	var sOption="";&#13;&#10;	for(var i=0;i<oXml.documentElement.childNodes(0).childNodes.length;i++){&#13;&#10;		sOption += "<option>" + oXml.documentElement.childNodes(0).childNodes(i).getAttribute("name") + "</option>";&#13;&#10;	}&#13;&#10;	lstDsn.outerHTML = SelectAddOption(lstDsn,sOption);&#13;&#10;	if(sOption != "") lstDsn.selectedIndex=0;&#13;&#10;}&#13;&#10;function uf_savexml(oXml){&#13;&#10;		//alert(oXml.documentElement.xml);&#13;&#10;	var sContent ='<?xml version="1.0" encoding="GB2312" ?>'+ oXml.documentElement.xml ;&#13;&#10;	sContent = "<![CDATA"+"["+sContent +"]"+"]>";&#13;&#10;	var sXml = "<file>"+fcpubdata.userDir+"/xml/econfig.xml</file><text>"+sContent+"</text>";&#13;&#10;	var ret=savedesignhtml(sXml);&#13;&#10;	return ret;	&#13;&#10;}&#13;&#10;function uf_del() {&#13;&#10;	if(lstDsn.selectedIndex<0) return;&#13;&#10;	var ret = window.confirm("按 [确定] 则真的删除？");		&#13;&#10;	if (ret == false) return;&#13;&#10;	&#13;&#10;	var oXml = SetDomFile("../.."+fcpubdata.userDir+"/xml/econfig.xml");&#13;&#10;	oXml.documentElement.childNodes(0).removeChild(oXml.documentElement.childNodes(0).childNodes(lstDsn.selectedIndex));&#13;&#10;	var ret=uf_savexml(oXml);&#13;&#10;	if(ret == "") {&#13;&#10;		lstDsn.remove(lstDsn.selectedIndex);&#13;&#10;	}else{&#13;&#10;		alert(ret);&#13;&#10;	}	&#13;&#10;}&#13;&#10;function uf_add() {&#13;&#10;	var sRet = DjOpen("eb_dsn1",null,"展现","有模式窗口","直接","数据源设置");&#13;&#10;	if(IsSpace(sRet)==false){&#13;&#10;		var oSub = SetDom(sRet);&#13;&#10;		var sName = oSub.documentElement.getAttribute("name");&#13;&#10;		var oXml = SetDomFile("../.."+fcpubdata.userDir+"/xml/econfig.xml");&#13;&#10;		oXml.documentElement.childNodes(0).appendChild(oSub.documentElement);&#13;&#10;		var ret=uf_savexml(oXml);&#13;&#10;		if(ret == "") {&#13;&#10;			var oOpt=document.createElement("option")&#13;&#10;			oOpt.text=sName;&#13;&#10;			lstDsn.add(oOpt);&#13;&#10;		}else{&#13;&#10;			alert(ret);&#13;&#10;		}	&#13;&#10;	}&#13;&#10;}&#13;&#10;function uf_edit() {&#13;&#10;	if(lstDsn.selectedIndex<0) return;&#13;&#10;	var oXml = SetDomFile("../.."+fcpubdata.userDir+"/xml/econfig.xml");&#13;&#10;	var sRet = DjOpen("eb_dsn1",oXml.documentElement.childNodes(0).childNodes(lstDsn.selectedIndex),"展现","有模式窗口","直接","数据源设置");&#13;&#10;	if(IsSpace(sRet)==false){&#13;&#10;		var oSub = SetDom(sRet);&#13;&#10;		var sName = oSub.documentElement.getAttribute("name");&#13;&#10;		oXml.documentElement.childNodes(0).replaceChild(oSub.documentElement,oXml.documentElement.childNodes(0).childNodes(lstDsn.selectedIndex));&#13;&#10;		var ret=uf_savexml(oXml);&#13;&#10;		if(ret == "") {&#13;&#10;			lstDsn.options(lstDsn.selectedIndex).text = sName;&#13;&#10;		}else{&#13;&#10;			alert(ret);&#13;&#10;		}	&#13;&#10;	}&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;design.js&#13;&#10;~userfunc.js" center="居中" unselectable="on" keyfield controlno="SKButton:0;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:1;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:5;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" posheight="210" poswidth="260" entertype="修改" codeheader="BBB" mkbh caption="数据源配置" type="PR" dj_sn="eb_dsn" billtaborder="<root><taborder>lstDsn</taborder><taborder>cmdAdd</taborder><taborder>cmdDel</taborder><taborder>cmdEdit</taborder></root>" contxml="<root><label><id>label1</id></label><listbox><id>lstDsn</id></listbox><button><id>cmdAdd</id><id>cmdDel</id><id>cmdEdit</id></button></root>" BLONopen="uf_open()" toolbar="不带工具栏" window="有模式窗口" posleft postop isfile="是" OtherSave="否" idtype="1"><DIV onmove=move() oncontrolselect=controlselect() id=label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 3px; WIDTH: 36px; POSITION: absolute; TOP: 5px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="label1" NotBg="否">数据源列表:</DIV><SELECT onmove=move() oncontrolselect=controlselect() id=lstDsn onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 1px; WIDTH: 164px; POSITION: absolute; TOP: 21px; HEIGHT: 153px" onmovestart=moveStart() size=8 controltype="listbox" tempvalue temptext check="1" sql></SELECT><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdAdd onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 175px; WIDTH: 55px; POSITION: absolute; TOP: 9px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_add()")' dropstyle="否"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdDel onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 175px; WIDTH: 55px; POSITION: absolute; TOP: 41px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_del()")' dropstyle="否"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdEdit onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 175px; WIDTH: 55px; POSITION: absolute; TOP: 72px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_edit()")' dropstyle="否"></BUTTON></DIV>