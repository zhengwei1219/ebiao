<script>var objNav=new Object();&#13;&#10;objNav.prevPage = "wizard_first" ;&#13;&#10;objNav.nextPage = "wizard_inputstyle" ;&#13;&#10;objNav.saveConfig = saveConfig;&#13;&#10;objNav.isOk = true;&#13;&#10;&#13;&#10;function uf_open() {&#13;&#10;	objNav.config = parent.parent.toolbar.WizardConfig ;&#13;&#10;&#13;&#10;    SetButtonImage(cmdUp,"../images/ef_run_button_up.gif") ;&#13;&#10;    SetButtonImage(cmdDown,"../images/ef_run_button_down.gif") ;&#13;&#10;	new Eapi.DbStru().listTables($id("cboSelPkTab"));&#13;&#10;	&#13;&#10;    SetTextValue(objNav.config.mainTableName,$id("cboSelPkTab"));&#13;&#10;    SetTextValue(objNav.config.mainKeyField,$id("cboSelPkField"));&#13;&#10;    if(IsSpace(objNav.config.mainFieldsHtml1) == false) $id("lstSelField1").outerHTML = objNav.config.mainFieldsHtml1;&#13;&#10;    if(IsSpace(objNav.config.mainFieldsHtml2) == false) $id("lstSelField2").outerHTML = objNav.config.mainFieldsHtml2;&#13;&#10;    &#13;&#10;    uf_DisabledButton();&#13;&#10;    &#13;&#10;}&#13;&#10;//保存配置信息,由工具栏来调用&#13;&#10;function saveConfig(){&#13;&#10;	var sValue = new Eapi.Str().trim($id("cboSelPkTab").value);&#13;&#10;	if(IsSpace(sValue)){&#13;&#10;		alert("主表名不能为空!");&#13;&#10;		objNav.isOk = false;&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	objNav.config.mainTableName = sValue;&#13;&#10;	var sValue = new Eapi.Str().trim($id("cboSelPkField").value);&#13;&#10;	if(IsSpace(sValue)){&#13;&#10;		alert("主键不能为空!");&#13;&#10;		objNav.isOk = false;&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	objNav.config.mainKeyField = sValue;&#13;&#10;	if($id("lstSelField2").options.length == 0 ){&#13;&#10;		alert("已选字段不能为空!");&#13;&#10;		objNav.isOk = false;&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	objNav.config.mainFields = new Eapi.Str().comboToStr($id("lstSelField2"));&#13;&#10;	objNav.config.mainFieldsHtml1=$id("lstSelField1").outerHTML;&#13;&#10;	objNav.config.mainFieldsHtml2=$id("lstSelField2").outerHTML;&#13;&#10;	objNav.isOk = true;&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_DisabledButton(){&#13;&#10;	var cmdPrev	 = parent.parent.toolbar.cmdPrev;&#13;&#10;	var cmdNext	 = parent.parent.toolbar.cmdNext;&#13;&#10;	var cmdOk	 = parent.parent.toolbar.cmdOk;&#13;&#10;	if(objNav.prevPage == "") {&#13;&#10;		cmdPrev.disabled = true;&#13;&#10;	}else{&#13;&#10;		cmdPrev.removeAttribute("disabled");&#13;&#10;	}&#13;&#10;	&#13;&#10;	if(objNav.nextPage == "") {&#13;&#10;		cmdNext.disabled = true;&#13;&#10;		cmdOk.removeAttribute("disabled");&#13;&#10;	}else{&#13;&#10;		cmdNext.removeAttribute("disabled");&#13;&#10;		cmdOk.disabled = true;&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//选择主表名称,在lstSelField2控件中列出选择主表中的字段&#13;&#10;function uf_SelTabValue() {&#13;&#10;	lstSelField1.options.length = 0;&#13;&#10;	lstSelField2.options.length = 0;&#13;&#10;	new Eapi.DbStru().listFields(cboSelPkTab.value,lstSelField2);&#13;&#10;	new Eapi.DbStru().listFields(cboSelPkTab.value,cboSelPkField);&#13;&#10;	//var curTab = cboSelPkTab.value;&#13;&#10;	//cboSelPkField.sql1 = "select FC_FLDLIST.fdname,FC_FLDLIST.chnname,FC_TBSTRU.fdname,FC_TBSTRU.tbname from FC_FLDLIST,FC_TBSTRU where rtrim(FC_TBSTRU.tbname)='"+curTab+"' and FC_TBSTRU.fdname=FC_FLDLIST.fdname" ;&#13;&#10;	//var sql = "select FC_FLDLIST.fdname,FC_FLDLIST.chnname from FC_FLDLIST,FC_TBSTRU where rtrim(FC_TBSTRU.tbname)='"+curTab+"' and FC_TBSTRU.fdname=FC_FLDLIST.fdname" ;&#13;&#10;	&#13;&#10;	//SqlCombo(lstSelField2,sql)&#13;&#10;	&#13;&#10;}&#13;&#10;//objLeft向右objRight增加值,&#13;&#10;function add(objLeft,objRight,sValue){	&#13;&#10;	for (var i=objLeft.length-1;i>=0;i--){&#13;&#10;		if (objLeft.options(i).selected){&#13;&#10;			var oOpt=document.createElement("option")&#13;&#10;			oOpt.text=objLeft.options(i).text&#13;&#10;			oOpt.value=objLeft.options(i).value&#13;&#10;			if (objLeft.id==sValue){&#13;&#10;				objRight.add(oOpt)&#13;&#10;			}&#13;&#10;			&#13;&#10;			objLeft.remove(i)&#13;&#10;		&#13;&#10;		}&#13;&#10;	}&#13;&#10;}&#13;&#10;//把objLeft中所有的值给objRight控件&#13;&#10;function uf_addlist(objLeft,objRight,sValue) {	&#13;&#10;	for (var i=objLeft.length-1;i>=0;i--){&#13;&#10;		var oOpt=document.createElement("option")&#13;&#10;		oOpt.text=objLeft.options(i).text&#13;&#10;		oOpt.value=objLeft.options(i).value&#13;&#10;		if (objLeft.id==sValue){&#13;&#10;			objRight.add(oOpt)&#13;&#10;		}&#13;&#10;		objLeft.remove(i)&#13;&#10;	}&#13;&#10;}&#13;&#10;//objRight向右objLeft增加值,&#13;&#10;function Sellist(objLeft,objRight,sValue) {&#13;&#10;	for (var i=objRight.length-1;i>=0;i--){&#13;&#10;		if (objRight.options(i).selected){&#13;&#10;			var oOpt=document.createElement("option")&#13;&#10;			oOpt.text=objRight.options(i).text&#13;&#10;			oOpt.value=objRight.options(i).value&#13;&#10;			if (objRight.id == sValue){&#13;&#10;				objLeft.add(oOpt)&#13;&#10;			}&#13;&#10;			objRight.remove(i)&#13;&#10;		}&#13;&#10;	}	&#13;&#10;}&#13;&#10;//把objRight中所有的值给objLeft控件&#13;&#10;function uf_del(objLeft,objRight,sValue) {&#13;&#10;	for (var i=objRight.length-1;i>=0;i--){&#13;&#10;		var oOpt=document.createElement("option")&#13;&#10;		oOpt.text=objRight.options(i).text&#13;&#10;		oOpt.value=objRight.options(i).value&#13;&#10;		if (objRight.id==sValue){&#13;&#10;			objLeft.add(oOpt)&#13;&#10;		}&#13;&#10;&#13;&#10;		objRight.remove(i)&#13;&#10;	}&#13;&#10;		&#13;&#10;}&#13;&#10;//listbox控件的值上移&#13;&#10;function uf_up(obj){&#13;&#10;     for (var i=obj.length-1;i>0;i--){&#13;&#10;      if (obj.options(i).selected == true){&#13;&#10;        var s&#13;&#10;        var d&#13;&#10;        s=obj.options(i-1).text ;&#13;&#10;        d=obj.options(i-1).value ;&#13;&#10;        obj.options(i-1).text=obj.options(i).text ;&#13;&#10;        obj.options(i-1).value=obj.options(i).value ;&#13;&#10;        obj.options(i).text=s ;&#13;&#10;        obj.options(i).value=d ;&#13;&#10;        obj.options(i).selected=false ;&#13;&#10;        obj.options(i-1).selected=true ;&#13;&#10;        break ;&#13;&#10;      }&#13;&#10;    }&#13;&#10;}&#13;&#10;//listbox控件的值下移&#13;&#10;function uf_down(obj){&#13;&#10;   for (var i=0;i<obj.length-1;i++){&#13;&#10;    if (obj.options(i).selected == true){&#13;&#10;      var s="";&#13;&#10;      var d="";&#13;&#10;      s=obj.options(i+1).text ;&#13;&#10;      d=obj.options(i+1).value ;&#13;&#10;      obj.options(i+1).text=obj.options(i).text ;&#13;&#10;      obj.options(i+1).value=obj.options(i).value ;&#13;&#10;      obj.options(i).text=s ;&#13;&#10;      obj.options(i).value=d ;&#13;&#10;	  obj.options(i).selected=false&#13;&#10;     obj.options(i+1).selected=true ;&#13;&#10;      break ;&#13;&#10;    }&#13;&#10;  }&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" BLONopen="uf_open()" unselectable="on" contxml="<root><label><id>Label1</id><id>Label2</id><id>Label8</id><id>Label7</id></label><listbox><id>lstSelField1</id><id>lstSelField2</id></listbox><button><id>cmd_CheckAllRight</id><id>cmdCheckRight</id><id>cmd_CheckLeft</id><id>cmd_CheckAllLeft</id><id>cmdUp</id><id>cmdDown</id></button><dropdownlist><id>cboSelPkTab</id><id>cboSelPkField</id></dropdownlist></root>" controlno="SKButton:0;SKDBedit:0;checkbox:1;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0" billtaborder="<root><taborder>lstSelField1</taborder><taborder>lstSelField2</taborder><taborder>cmd_CheckAllRight</taborder><taborder>cmdCheckRight</taborder><taborder>cmd_CheckLeft</taborder><taborder>cmd_CheckAllLeft</taborder><taborder>cmdUp</taborder><taborder>cmdDown</taborder><taborder>cboSelPkTab</taborder><taborder>cboSelPkField</taborder></root>" idtype="1" OtherSave="否" isfile="是" posheight poswidth postop posleft entertype="修改" window="当前窗口" keyfield codeheader="BBB" mkbh caption="wizard_maininput" type="ST" dj_sn="wizard_maininput" toolbar="不带工具栏"><DIV onmove=move() oncontrolselect=controlselect() id=Label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 9px; WIDTH: 24px; FONT-FAMILY: ; POSITION: absolute; TOP: 31px; HEIGHT: 15px;  " onmovestart=moveStart() noWrap value="Label1" controltype="label">主表名：</DIV><IMG id=cboSelPkTab onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="FONT-SIZE: 12px; LEFT: 52px; WIDTH: 143px; FONT-FAMILY: ; POSITION: absolute; TOP: 27px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; backgroundColor1: #ffffff; textalign: left; ButtonWidth: 10" onmovestart=moveStart() src="../../fceform/images/ef_designer_fccode.gif" type="divbox" controltype="dropdownlist" onselchange='bill_onclick("uf_SelTabValue()")' blninput="是" blnempty="否" addrow="否" multiselect="否" sql1 xml sql2 format="英文表名|中文表名" visible="是" CustomAttr check="1" temptext tempvalue> 
<DIV onmove=move() oncontrolselect=controlselect() id=Label2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 241px; WIDTH: 18px; FONT-FAMILY: ; POSITION: absolute; TOP: 31px; HEIGHT: 15px;  " onmovestart=moveStart() noWrap value="Label2" controltype="label">主键：</DIV><IMG id=cboSelPkField onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="FONT-SIZE: 12px; LEFT: 274px; WIDTH: 159px; FONT-FAMILY: ; POSITION: absolute; TOP: 27px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; backgroundColor1: #ffffff; textalign: left; ButtonWidth: 10" onmovestart=moveStart() src="../../fceform/images/ef_designer_fccode.gif" type="divbox" controltype="dropdownlist" blninput="是" blnempty="否" addrow="否" multiselect="否" sql1 xml sql2 format="字段名称 !|  中文名称|" visible="是" check="1" temptext tempvalue> 
<DIV onmove=move() oncontrolselect=controlselect() id=Label8 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 245px; WIDTH: 24px; FONT-FAMILY: ; POSITION: absolute; TOP: 60px; HEIGHT: 15px;  " onmovestart=moveStart() noWrap value="Label8" controltype="label">已选字段</DIV>
<DIV onmove=move() oncontrolselect=controlselect() id=Label7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 8px; WIDTH: 24px; FONT-FAMILY: ; POSITION: absolute; TOP: 60px; HEIGHT: 15px;  " onmovestart=moveStart() noWrap value="Label7" controltype="label">待选字段</DIV><SELECT onmove=move() oncontrolselect=controlselect() id=lstSelField1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 7px; WIDTH: 188px; FONT-FAMILY: ; POSITION: absolute; TOP: 77px; HEIGHT: 230px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() multiple size=8 controltype="listbox" CustomAttr check="1" temptext tempvalue backwidth="188" backheight="230" sql fc_ondblclick="bill_ondblclick(&quot;add(lstSelField1,lstSelField2,'lstSelField1')&quot;)"></SELECT><BUTTON onmove=move() oncontrolselect=controlselect() id=cmd_CheckAllRight onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 101px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;uf_addlist(lstSelField1,lstSelField2,'lstSelField1')&quot;)">&gt;&gt;</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdCheckRight onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 131px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;add(lstSelField1,lstSelField2,'lstSelField1')&quot;)">&gt;</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmd_CheckLeft onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 177px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;Sellist(lstSelField1,lstSelField2,'lstSelField2')&quot;)">&lt;</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmd_CheckAllLeft onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 207px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;uf_del(lstSelField1,lstSelField2,'lstSelField2')&quot;)">&lt;&lt;</BUTTON><SELECT onmove=move() oncontrolselect=controlselect() id=lstSelField2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 241px; WIDTH: 192px; FONT-FAMILY: ; POSITION: absolute; TOP: 77px; HEIGHT: 230px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() multiple size=8 controltype="listbox" CustomAttr check="1" temptext tempvalue backwidth="192" backheight="230" sql fc_ondblclick="bill_ondblclick(&quot;Sellist(lstSelField1,lstSelField2,'lstSelField2')&quot;)"></SELECT><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdUp onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 437px; WIDTH: 22px; BACKGROUND-REPEAT: no-repeat; FONT-FAMILY: ; POSITION: absolute; TOP: 150px; HEIGHT: 22px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_up(lstSelField2)")'></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdDown onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 437px; WIDTH: 22px; FONT-FAMILY: ; POSITION: absolute; TOP: 175px; HEIGHT: 22px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_down(lstSelField2)")'></BUTTON> </DIV>