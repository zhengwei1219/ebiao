<script>var arrPub = new Array();&#13;&#10;function uf_open(){&#13;&#10;	var arr=fcpubdata.obj;&#13;&#10;	new Eform.SysForm().setButtonImage();&#13;&#10;	//xml串付值到数组&#13;&#10;	if(IsSpace(arr[1])){&#13;&#10;		uf_checked();&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	var oXml = SetDom(arr[1]) ;&#13;&#10;//	var l=oXml.documentElement.childNodes.length ;&#13;&#10;	arrPub[0]=UnRepXml(oXml.documentElement.childNodes(0).text);&#13;&#10;	arrPub[1]=UnRepXml(oXml.documentElement.childNodes(1).text);&#13;&#10;	arrPub[2]=UnRepXml(oXml.documentElement.childNodes(2).text);&#13;&#10;	arrPub[3]=UnRepXml(oXml.documentElement.childNodes(3).text);&#13;&#10;	arrPub[4]=UnRepXml(oXml.documentElement.childNodes(4).text);&#13;&#10;	arrPub[5]=UnRepXml(oXml.documentElement.childNodes(5).text);&#13;&#10;	SKDBMemo1.value=arrPub[0];&#13;&#10;	FCDBedit1.value=arrPub[4];&#13;&#10;	uf_checked();&#13;&#10;}&#13;&#10;//添加数据验证&#13;&#10;function uf_addVal(){&#13;&#10;	var arr1 = new Array()&#13;&#10;	arr1[0]=fcpubdata.obj[0]&#13;&#10;	var arr=DjOpen('validate',arr1,'展现','有模式窗口','直接','数据验证')  ;&#13;&#10;	if(typeof(arr)=="undefined"){&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	arrPub=arr;&#13;&#10;	SKDBMemo1.value=arr[0];&#13;&#10;	FCDBedit1.value=arr[4];&#13;&#10;	uf_checked();&#13;&#10;}&#13;&#10;//修改数据验证&#13;&#10;function uf_amendVal(){&#13;&#10;	var arr1 = new Array();&#13;&#10;	arr1[0]=fcpubdata.obj[0];&#13;&#10;	arr1[1]=arrPub;&#13;&#10;	var arr=DjOpen('validate',arr1,'展现','有模式窗口','直接','数据验证');	&#13;&#10;	if(typeof(arr)=="undefined"){&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	arrPub = arr; &#13;&#10;	SKDBMemo1.value=arr[0];&#13;&#10;	FCDBedit1.value=arr[4];&#13;&#10;	uf_checked();&#13;&#10;}&#13;&#10;//删除数据验证&#13;&#10;function uf_delVal(){&#13;&#10;	SKDBMemo1.value="";&#13;&#10;	FCDBedit1.value="";	&#13;&#10;	arrPub.length=0;&#13;&#10;	uf_checked();&#13;&#10;}&#13;&#10;//设置Button.disabled属性&#13;&#10;function uf_checked(){&#13;&#10;	&#13;&#10;	if(IsSpace(SKDBMemo1.value)){&#13;&#10;		FCButton1.disabled=false;&#13;&#10;		FCButton2.disabled=true;&#13;&#10;		FCButton3.disabled=true;	&#13;&#10;	}else{&#13;&#10;		FCButton1.disabled=true;&#13;&#10;		FCButton2.disabled=false;&#13;&#10;		FCButton3.disabled=false;	&#13;&#10;	}	&#13;&#10;}&#13;&#10;&#13;&#10;function uf_ok(){&#13;&#10;	//将树组转为xml&#13;&#10;	var sxml="";&#13;&#10;	var sxml0="";&#13;&#10;	var sxml1="";&#13;&#10;	var sxml2="";&#13;&#10;	var sxml3="";&#13;&#10;	var sxml4="";&#13;&#10;	var sxml5="";&#13;&#10;	//for(i=0;i<arrPub.length;i++){&#13;&#10;	if(arrPub.length>1){&#13;&#10;		sxml0="<Node0>"+RepXml(arrPub[0])+"</Node0>"&#13;&#10;		sxml1="<Node1>"+RepXml(arrPub[1])+"</Node1>"&#13;&#10;		sxml2="<Node2>"+RepXml(arrPub[2])+"</Node2>"&#13;&#10;		sxml3="<Node3>"+RepXml(arrPub[3])+"</Node3>"&#13;&#10;		sxml4="<Node4>"+RepXml(arrPub[4])+"</Node4>"&#13;&#10;		sxml5="<Node5>"+RepXml(arrPub[5])+"</Node5>"&#13;&#10;		sxml="<field>"+sxml0+sxml1+sxml2+sxml3+sxml4+sxml5+"<name>"+fcpubdata.obj[2]+"</name></field>"&#13;&#10;		 ;&#13;&#10;	}else{&#13;&#10;		sxml = "del" ;&#13;&#10;	}&#13;&#10;	window.returnValue=sxml;&#13;&#10;	window.close();&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js" center="居中" unselectable="on" keyfield controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" posheight="210" poswidth="295" entertype="修改" codeheader="BBB" mkbh caption="添加数据验证" type="LR" dj_sn="validatecard" billtaborder="<root><taborder>SKDBMemo1</taborder><taborder>FCButton1</taborder><taborder>FCButton2</taborder><taborder>FCButton3</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>FCDBedit1</taborder></root>" contxml="<root><label><id>Label1</id><id>Label2</id><id>Label3</id></label><textarea><id>SKDBMemo1</id></textarea><shape><id>Shape1</id><id>Shape2</id></shape><button><id>FCButton1</id><id>FCButton2</id><id>FCButton3</id><id>cmdOk</id><id>cmdClose</id></button><text><id>FCDBedit1</id></text></root>" BLONopen="uf_open()" toolbar="不带工具栏" window="有模式窗口" posleft postop isfile="是" OtherSave="否" idtype="1" BLONopenBefore BLONclose userType><SPAN oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 28px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 15px; FONT-SIZE: 12px; TOP: 16px; LEFT: 20px" id=Label1 onresize=resize() onmove=move() class=label_title controltype="label" value="Label1" inputTag="否" NotBg="否">验证</SPAN><SPAN oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 15px; FONT-SIZE: 12px; TOP: 50px; LEFT: 36px" id=Label2 onresize=resize() onmove=move() controltype="label" value="Label2">条件：</SPAN><?xml:namespace prefix = v /><v:line style="POSITION: absolute; WIDTH: 227px; DISPLAY: block; HEIGHT: 18px; TOP: 23px; LEFT: 45px" id=Shape1 onresize="" controltype="shape" id1="3" from = "0,0" to = "167.25pt,0" fillcolor = "white" strokecolor = "gray"><v:stroke></v:stroke></v:line><TEXTAREA oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; WIDTH: 178px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 40px; FONT-SIZE: 12px; TOP: 35px; LEFT: 93px" id=SKDBMemo1 onresize=resize() onmove=move() onchange='bill_onclick("uf_checked()")' cols=29 readOnly controltype="textarea" value="SKDBMemo1" china induce="否"></TEXTAREA><SPAN oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 66px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 28px; FONT-SIZE: 12px; TOP: 81px; LEFT: 36px" id=Label3 onresize=resize() onmove=move() controltype="label" value="Label3">内嵌警告：</SPAN><INPUT oncontrolselect=controlselect() style="POSITION: absolute; TEXT-ALIGN: left; BACKGROUND-COLOR: #ffffff; WIDTH: 177px; DISPLAY: block; HEIGHT: 20px; FONT-SIZE: 12px; TOP: 76px; LEFT: 93px" id=FCDBedit1 onresize=resize() onmove=move() readOnly controltype="text" china CanSelect="false"></INPUT><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 105px; LEFT: 29px" id=FCButton1 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_addVal()")' dropstyle="否" controltype="button">添 加</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 105px; LEFT: 110px" id=FCButton2 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_amendVal()")' dropstyle="否" controltype="button">修 改</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 105px; LEFT: 191px" id=FCButton3 onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_delVal()")' dropstyle="否" controltype="button">删 除</BUTTON><v:line style="POSITION: absolute; WIDTH: 253px; DISPLAY: block; HEIGHT: 18px; TOP: 141px; LEFT: 19px" id=Shape2 onresize="" controltype="shape" id1="3" from = "0,0" to = "188.25pt,0" fillcolor = "white" strokecolor = "gray"><v:stroke></v:stroke></v:line><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 147px; LEFT: 110px" id=cmdOk onresize=resize() onmove=move() fc_onclick='bill_onclick("uf_ok()")' dropstyle="否" controltype="button"></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 147px; LEFT: 192px" id=cmdClose onresize=resize() onmove=move() fc_onclick='bill_onclick("CloseBill()")' dropstyle="否" controltype="button"></BUTTON></DIV>