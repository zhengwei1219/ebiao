<script>//赋值到SKDBcombobox1控件&#13;&#10;//分两个数据库版本的值:oracle, sqlserver&#13;&#10;var db2UserName=fcpubdata.db2UserName;&#13;&#10;var bAddField=false;//增加/编辑字段&#13;&#10;var oldNull="";&#13;&#10;function uf_evaluate(){&#13;&#10;	var sHtml="";&#13;&#10;	if(fcpubdata.databaseTypeName=="sqlserver"){&#13;&#10;		sHtml="<option value='bigint'>bigint</option>"&#13;&#10;			+"<option value='binary'>binary</option>"&#13;&#10;			+"<option value='bit'>bit</option>"&#13;&#10;			+"<option value='char'>char</option>"      &#13;&#10;			+"<option value='datetime'>datetime</option>"&#13;&#10;			+"<option value='decimal'>decimal</option>"&#13;&#10;			+"<option value='float'>float</option>"&#13;&#10;			+"<option value='image'>image</option>"&#13;&#10;			+"<option value='int'>int</option>"&#13;&#10;			+"<option value='money'>money</option>"&#13;&#10;			+"<option value='nchar'>nchar</option>"&#13;&#10;			+"<option value='ntext'>ntext</option>"&#13;&#10;			+"<option value='numeric'>numeric</option>"&#13;&#10;			+"<option value='nvarchar'>nvarchar</option>"&#13;&#10;			+"<option value='real'>real</option>"&#13;&#10;			+"<option value='smalldatetime'>smalldatetime</option>"&#13;&#10;			+"<option value='smallint'>smallint</option>"&#13;&#10;			+"<option value='smallmoney'>smallmoney</option>"&#13;&#10;			+"<option value='sql_variant'>sql_variant</option>"&#13;&#10;			+"<option value='text'>text</option>"&#13;&#10;			+"<option value='timestamp'>timestamp</option>"&#13;&#10;			+"<option value='tinyint'>tinyint</option>"&#13;&#10;			+"<option value='uniqueidentifier'>uniqueidentifier</option>"&#13;&#10;			+"<option value='varbinary'>varbinary</option>"&#13;&#10;			+"<option value='varchar'>varchar</option>"	;&#13;&#10;	}&#13;&#10;	if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;		sHtml="<option value='CHAR'>CHAR</option>"&#13;&#10;			 +"<option value='VARCHAR2'>VARCHAR2</option>"&#13;&#10;		     +"<option value='NCHAR'>NCHAR</option>"&#13;&#10;		     +"<option value='NVARCHAR2'>NVARCHAR2</option>"&#13;&#10;		     +"<option value='NUMBER'>NUMBER</option>"&#13;&#10;		     +"<option value='DATE'>DATE</option>"&#13;&#10;		     +"<option value='LONG'>LONG</option>"&#13;&#10;		     +"<option value='RAW'>RAW</option>"&#13;&#10;		     +"<option value='LONG RAW'>LONG RAW</option>"&#13;&#10;		     +"<option value='ROWID'>ROWID</option>"&#13;&#10;		     +"<option value='BLOB'>BLOB</option>"&#13;&#10;		     +"<option value='CLOB'>CLOB</option>"&#13;&#10;		     +"<option value='NCLOB'>NCLOB</option>"&#13;&#10;		     +"<option value='BFILE'>BFILE</option>"&#13;&#10;		     +"<option value='UROWID'>UROWID</option>"&#13;&#10;		     +"<option value='FLOAT'>FLOAT</option>"&#13;&#10;		     +"<option value='XMLTYPE'>XMLTYPE</option>";&#13;&#10;	}&#13;&#10;	if(fcpubdata.databaseTypeName=="db2"){&#13;&#10;		sHtml="<option value='BIGINT'>BIGINT</option>"&#13;&#10;			 +"<option value='BLOB'>BLOB</option>"&#13;&#10;		     +"<option value='CHARACTER'>CHARACTER</option>"&#13;&#10;		     +"<option value='CLOB'>CLOB</option>"&#13;&#10;		     +"<option value='DATE'>DATE</option>"&#13;&#10;		     +"<option value='DBCLOB'>DBCLOB</option>"&#13;&#10;		     +"<option value='DECIMAL'>DECIMAL</option>"&#13;&#10;		     +"<option value='GRAPHIC'>GRAPHIC</option>"&#13;&#10;		     +"<option value='INTEGER'>INTEGER</option>"&#13;&#10;		     +"<option value='LONG VARCHAR'>LONG VARCHAR</option>"&#13;&#10;		     +"<option value='LONG VARGRAPHIC'>LONG VARGRAPHIC</option>"&#13;&#10;		     +"<option value='REAL'>REAL</option>"&#13;&#10;		     +"<option value='SMALLINT'>SMALLINT</option>"&#13;&#10;		     +"<option value='TIME'>TIME</option>"&#13;&#10;		     +"<option value='TIMESTAMP'>TIMESTAMP</option>"&#13;&#10;		     +"<option value='VARCHAR'>VARCHAR</option>"&#13;&#10;		     +"<option value='VARGRAPHIC'>VARGRAPHIC</option>";&#13;&#10;	}	&#13;&#10;	if(fcpubdata.databaseTypeName=="mysql"){&#13;&#10;		sHtml="<option value='bigint'>bigint</option>"&#13;&#10;			+"<option value='int'>int</option>"&#13;&#10;			+"<option value='smallint'>smallint</option>"&#13;&#10;			+"<option value='tinyint'>tinyint</option>"&#13;&#10;			+"<option value='float'>float</option>"&#13;&#10;			+"<option value='real'>real</option>"&#13;&#10;			+"<option value='decimal'>decimal</option>"&#13;&#10;			+"<option value='numeric'>numeric</option>"&#13;&#10;			+"<option value='datetime'>datetime</option>"&#13;&#10;			+"<option value='date'>date</option>"&#13;&#10;			+"<option value='time'>time</option>"&#13;&#10;			+"<option value='timestamp'>timestamp</option>"&#13;&#10;			+"<option value='char'>char</option>"&#13;&#10;			+"<option value='varchar'>varchar</option>"&#13;&#10;			+"<option value='text'>text</option>"&#13;&#10;			+"<option value='longblob'>longblob</option>"	;&#13;&#10;	}&#13;&#10;	var ss=SelectAddOption(cboType,sHtml);&#13;&#10;	cboType.outerHTML=ss;&#13;&#10;}&#13;&#10;function uf_open(){&#13;&#10;	uf_evaluate()&#13;&#10;	var arr=fcpubdata.obj;&#13;&#10;	var sval=arr[0]		//表名 &#13;&#10;	var sFd=arr[1]		//字段名&#13;&#10;	if (IsSpace(sFd)) bAddField=true;&#13;&#10;	if(bAddField){&#13;&#10;		if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;			cboType.value="VARCHAR2";&#13;&#10;			txtFsize.value="10"&#13;&#10;		}&#13;&#10;		if(fcpubdata.databaseTypeName=="sqlserver" || fcpubdata.databaseTypeName=="mysql"){&#13;&#10;			cboType.value="varchar";&#13;&#10;			txtFsize.value="50"	&#13;&#10;		}&#13;&#10;		if(fcpubdata.databaseTypeName=="db2"){&#13;&#10;			cboType.value="VARCHAR";&#13;&#10;			txtFsize.value="10"&#13;&#10;		}&#13;&#10;		&#13;&#10;	}else{&#13;&#10;		//alert(sFd)&#13;&#10;		txtFname.readOnly=true;	&#13;&#10;		txtFname.value=sFd ;&#13;&#10;		if(fcpubdata.databaseTypeName=="mysql"){&#13;&#10;			var retX = SelectSql("describe "+sval,1,-1);&#13;&#10;	        var oX = SetDom(retX);&#13;&#10;	        if(oX.documentElement == null){&#13;&#10;	        	alert(retX);&#13;&#10;	        	return;&#13;&#10;	        }&#13;&#10;	        for(var i=0;i<oX.documentElement.childNodes.length-1;i++){&#13;&#10;	        	if(sFd == oX.documentElement.childNodes(i).childNodes(0).text )	{&#13;&#10;		        	var sTypes = oX.documentElement.childNodes(i).childNodes(1).text;&#13;&#10;		        	var posStart = sTypes.indexOf("(");&#13;&#10;		        	var posEnd = sTypes.indexOf(")");&#13;&#10;		        	var pos = sTypes.indexOf(",");&#13;&#10;		        	if(posStart<0)&#13;&#10;		        		cboType.value = sTypes;&#13;&#10;		        	else&#13;&#10;		        		cboType.value = sTypes.substring(0,posStart);&#13;&#10;		        	if(pos>=0){&#13;&#10;			        	txtFsize.value = sTypes.substring(posStart+1,pos);&#13;&#10;			        	txtFdec.value=sTypes.substring(pos+1,posEnd);&#13;&#10;		        	}else{&#13;&#10;			        	txtFsize.value = sTypes.substring(posStart+1,posEnd);&#13;&#10;			        	txtFdec.value=0;&#13;&#10;		        	}&#13;&#10;		  			var sNull = "NULL";&#13;&#10;		  			if(oX.documentElement.childNodes(i).childNodes(2).text == "NO") sNull = "NOT " +sNull;     	&#13;&#10;					&#13;&#10;					cboNull.value =sNull;&#13;&#10;					txtFdefault.value=oX.documentElement.childNodes(i).childNodes(4).text;&#13;&#10;					break;					        	&#13;&#10;	        	}&#13;&#10;	        }&#13;&#10;			&#13;&#10;		}else{	&#13;&#10;			var sSql="";&#13;&#10;			if(fcpubdata.databaseTypeName=="sqlserver"){&#13;&#10;				sSql="select distinct syscolumns.name as fdname,systypes.name as fdtype,syscolumns.length as fdsize,"&#13;&#10;					+"syscolumns.scale as fddec,case when syscolumns.isnullable=1 then 'NULL' when syscolumns.isnullable=0 then 'NOT NULL' end as isnullable"&#13;&#10;					+",case when syscolumns.cdefault=0 then '' else syscomments.text end as text from "&#13;&#10;					+" ((syscolumns inner join sysobjects on syscolumns.id=sysobjects.id) inner join systypes on syscolumns.xtype=systypes.xtype) left join syscomments on syscomments.id=syscolumns.cdefault or syscolumns.cdefault=0 or syscomments.id is null "&#13;&#10;					+" where sysobjects.xtype='U' and "&#13;&#10;					+"sysobjects.name='"+sval+"' and syscolumns.name='"+sFd+"'"&#13;&#10;			}&#13;&#10;			if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;				sSql="select COLUMN_NAME as fdname,DATA_TYPE AS fdtype,decode(DATA_TYPE,'CHAR',DATA_LENGTH,'NCHAR',DATA_LENGTH,'VARCHAR2',DATA_LENGTH,'NVARCHAR2',DATA_LENGTH,'RAW',DATA_LENGTH,DATA_PRECISION) as fdsize,decode(DATA_TYPE,'NUMBER',DATA_SCALE,DATA_PRECISION) as fddec,decode(NULLABLE,'N','NOT NULL','Y','NULL') as isnullable,DATA_DEFAULT as text  from user_tab_columns where table_name='"+sval+"' and column_name='"+sFd+"'";&#13;&#10;			}&#13;&#10;			if(fcpubdata.databaseTypeName=="db2"){&#13;&#10;				sSql="SELECT TABNAME FROM SYSCAT.TABLES WHERE TABSCHEMA='"+db2UserName+"'";&#13;&#10;			}&#13;&#10;			&#13;&#10;			//CopyToPub(sSql)&#13;&#10;			imgdataset1.Open(sSql);&#13;&#10;			var ss=imgdataset1.xml&#13;&#10;			var ilen=ss.indexOf("<set>")&#13;&#10;			var s1=ss.substring(6,ilen)&#13;&#10;			var oXml=SetDom(s1);&#13;&#10;			cboType.value=oXml.childNodes(0).childNodes(1).text;&#13;&#10;			txtFsize.value=oXml.childNodes(0).childNodes(2).text;&#13;&#10;			txtFdec.value=oXml.childNodes(0).childNodes(3).text;&#13;&#10;			cboNull.value=oXml.childNodes(0).childNodes(4).text;&#13;&#10;			oldNull=oXml.childNodes(0).childNodes(4).text;&#13;&#10;			txtFdefault.value=oXml.childNodes(0).childNodes(5).text;&#13;&#10;		}&#13;&#10;	}&#13;&#10;	uf_disabled();&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;	var arr=fcpubdata.obj;&#13;&#10;	var TAB= arr[0]                  //表名&#13;&#10;	var ZD=txtFname.value;			  //字段名&#13;&#10;	var LX=cboType.value;		  //字段类型&#13;&#10;	var WD=txtFsize.value;			  //字段宽度&#13;&#10;	var JD=txtFdec.value;			  //字段精度&#13;&#10;	var sNull=cboNull.value    //允许空&#13;&#10;	if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;		if(sNull==oldNull){&#13;&#10;			sNull="";	&#13;&#10;		}&#13;&#10;	}&#13;&#10;	var sChnTabName=TAB; //求表的中文名&#13;&#10;	/*var sTemp = SqlToField("select tbchnname from FC_DBSTRU where tbname='"+TAB+"'");&#13;&#10;	if(IsSpace(sTemp) == false){&#13;&#10;		sChnTabName = sTemp;&#13;&#10;	}*/&#13;&#10;	var stype = getDsType(LX);&#13;&#10;	//var strusql = "";&#13;&#10;	//strusql += "<no>delete FC_ENTITYSUB where tbname='"+TAB+"' and fdname='"+ZD+"'</no>";&#13;&#10;	//strusql += "<no>insert into FC_ENTITYSUB (tbname,fdname,fdtype,fdsize,fddec) values ('"+TAB+"','"+ZD+"','"+stype+"','"+WD+"','"+JD+"')</no>";&#13;&#10;	var DF=txtFdefault.value;			  //默认值&#13;&#10;	if(IsSpace(DF)==true) DF=0;&#13;&#10;	var xmlSql="";&#13;&#10;	var sAddEdit = "ADD";&#13;&#10;	var sQuot = ""; //字符型的引号&#13;&#10;	if(LX=="image") sQuot=" '";&#13;&#10;	var DF1=" DEFAULT "+sQuot+DF+sQuot//约束默认值，修改时不需要为空&#13;&#10;	if(fcpubdata.databaseTypeName=="sqlserver"){			  &#13;&#10;		if(uf_sDefault()=="0"){&#13;&#10;			alert("验证列的默认值时出错")&#13;&#10;			return;&#13;&#10;		}&#13;&#10;		if(bAddField == false){&#13;&#10;			sAddEdit = "ALTER COLUMN ";&#13;&#10;			DF1="";&#13;&#10;			var DF_name=SqlToField("select top 1 name from sysobjects where id=(select syscolumns.cdefault from syscolumns,sysobjects where syscolumns.id=sysobjects.id and sysobjects.name='"+TAB+"' and syscolumns.name='"+ZD+"')")&#13;&#10;			if(IsSpace(DF_name)==false){&#13;&#10;				xmlSql+="<alter tableName='"+TAB+"'>"+"<detail> drop constraint "+DF_name+"</detail>"+"</alter>;\n"&#13;&#10;			}		&#13;&#10;		}&#13;&#10;		&#13;&#10;		var s2="<alter tableName='"+TAB+"'>"+" <detail>" + sAddEdit + " "+ZD+" "+LX&#13;&#10;		if(LX=="char" || LX=="nchar" || LX=="nvarchar" || LX=="varchar"){ &#13;&#10;			if(IsSpace(DF)==false){&#13;&#10;				if(DF.indexOf("('")!=-1){&#13;&#10;					DF=DF.substring(2,DF.length-2);	&#13;&#10;				}&#13;&#10;				sQuot = "'";&#13;&#10;			}&#13;&#10;			xmlSql+=s2+"("+WD+") "+sNull+ " "+DF1&#13;&#10;			&#13;&#10;		}&#13;&#10;		if(LX=="decimal" || LX=="numeric"){&#13;&#10;			xmlSql+=s2+"("+WD+","+JD+") "+sNull+" "+ DF1;&#13;&#10;		}&#13;&#10;		if(LX=="bigint" || LX=="binary" || LX=="bit" ||LX=="image" || LX=="float" || LX=="int" || LX=="money" || LX=="real" || LX=="smallint" || LX=="smallmoney" || LX=="sql_variant" || LX=="tinyint" || LX=="varbinary" ||  LX=="text" || LX=="ntext" || LX=="datetime" || LX=="smalldatetime"){&#13;&#10;			xmlSql+=s2+" "+sNull+" "+ DF1;&#13;&#10;		}&#13;&#10;		&#13;&#10;		xmlSql+="</detail>"+"</alter>"+";\n";&#13;&#10;		if(bAddField == false){&#13;&#10;			if(IsSpace(DF)==false){&#13;&#10;				xmlSql+="<alter tableName='"+TAB+"'>"+"<detail> add constraint PK_"+ZD+"_default DEFAULT "+sQuot+DF+sQuot+" for "+ZD+"</detail>"+"</alter>";&#13;&#10;			}&#13;&#10;		}&#13;&#10;	} &#13;&#10;	if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;		if(bAddField == false) sAddEdit = "modify";&#13;&#10;			xmlSql="<alter tableName='"+TAB+"'>"+" <detail>" + sAddEdit + "( "+ZD+" "+LX&#13;&#10;		if(LX=="NUMBER"){&#13;&#10;			xmlSql+=" ("+WD+","+JD+") ";&#13;&#10;			if(IsSpace(DF)==false) xmlSql += "DEFAULT "+DF+" ";&#13;&#10;		}&#13;&#10;		if(LX=="FLOAT"){&#13;&#10;			xmlSql+=" ("+WD+") ";&#13;&#10;			if(IsSpace(DF)==false) xmlSql += "DEFAULT "+DF+" ";&#13;&#10;		}&#13;&#10;		if(LX=="CHAR" || LX=="VARCHAR2" || LX=="NCHAR" || LX=="NVARCHAR2" || LX=="RAW"){&#13;&#10;			xmlSql+=" ("+WD+") ";&#13;&#10;			if(IsSpace(DF)==false){&#13;&#10;				if(DF.indexOf("'")!=-1){&#13;&#10;					DF=DF.substring(1,DF.length-1)	&#13;&#10;				}&#13;&#10;&#13;&#10;				xmlSql += "DEFAULT '"+DF+"' ";&#13;&#10;			}&#13;&#10;		}&#13;&#10;		if(LX=="LONG RAW" || LX=="BLOB" || LX=="CLOB" || LX=="LONG"){&#13;&#10;			xmlSql += " ";&#13;&#10;			if(IsSpace(DF)==false) xmlSql += "DEFAULT "+DF+" ";&#13;&#10;		}&#13;&#10;		if(LX=="DATE"){&#13;&#10;			xmlSql += " ";&#13;&#10;			if(IsSpace(DF)==false) xmlSql += "DEFAULT to_date('"+DF+"','yyyy-mm-dd') ";&#13;&#10;		}&#13;&#10;		xmlSql+=sNull+")"+"</detail>"+"</alter>";	&#13;&#10;	}&#13;&#10;	if(fcpubdata.databaseTypeName=="db2"){&#13;&#10;		//sSql="alter table "+TAB+" " + sAddEdit + " "+ZD+" "+LX&#13;&#10;		xmlSql="<alter tableName='"+TAB+"'>"+" <detail>" + sAddEdit + " "+ZD+" "+LX&#13;&#10;		if(LX=="DECIMAL"){&#13;&#10;			xmlSql+=" ("+WD+","+JD+") ";&#13;&#10;		}&#13;&#10;		if(LX=="CHARACTER" || LX=="VARCHAR" || LX=="GRAPHIC" || LX=="VARGRAPHIC" ){&#13;&#10;			xmlSql+=" ("+WD+") ";&#13;&#10;		}&#13;&#10;		xmlSql+=" "+sNull+" ";&#13;&#10;		if(IsSpace(DF)==false) xmlSql += " DEFAULT "+DF+" "+"</detail>"+"</alter>";&#13;&#10;	}	&#13;&#10;	if(fcpubdata.databaseTypeName=="mysql"){&#13;&#10;		if(bAddField == false) sAddEdit = "modify ";&#13;&#10;		//sSql="alter table "+TAB+" " + sAddEdit + " "+ZD+" "+LX///&#13;&#10;		xmlSql="<alter tableName='"+TAB+"'>"+" <detail>" + sAddEdit + " "+ZD+" "+LX&#13;&#10;		if(LX=="decimal" || LX=="numeric"){&#13;&#10;			xmlSql+=" ("+WD+","+JD+") ";&#13;&#10;		}&#13;&#10;		if(LX=="char" || LX=="varchar" ){&#13;&#10;			xmlSql+=" ("+WD+") ";&#13;&#10;			if(IsSpace(DF)==false){&#13;&#10;				if(DF.substring(0,1)!="'") DF = "'"+DF+"'";&#13;&#10;			}&#13;&#10;		}&#13;&#10;		xmlSql +=" "+sNull+" ";&#13;&#10;		if(IsSpace(DF)==false) &#13;&#10;			xmlSql += " DEFAULT "+DF;&#13;&#10;		xmlSql +=" "+ "</detail>"+"</alter>";&#13;&#10;	}	&#13;&#10;	xmlSql =RepStr(xmlSql,";"," ");&#13;&#10;	//CopyToPub(xmlSql)&#13;&#10;	//alert(xmlSql)&#13;&#10;	doSaveData(xmlSql,function (){alert("成功")});&#13;&#10; /*	var s=InsertSql(sSql);&#13;&#10; 	alert(sSql)&#13;&#10; 	if(IsSpace(s)){&#13;&#10; 		var s1= InsertSqls(strusql);&#13;&#10; 		&#13;&#10;		window.returnValue="ok";&#13;&#10;		alert("修改成功")&#13;&#10;		CloseBill();&#13;&#10;	}else{&#13;&#10;		alert(s);&#13;&#10;	}*/&#13;&#10; 	&#13;&#10;}&#13;&#10;&#13;&#10;//判断字段类型&#13;&#10;//触发时间：当改变字段类型时出发&#13;&#10;//参数1：sType 字段类型&#13;&#10;//参数2：sWidth 字段宽度&#13;&#10;//参数3：sPrecision 字段精度&#13;&#10;function changeType(sType,sWidth,sPrecision){&#13;&#10;	if(fcpubdata.databaseTypeName=="sqlserver" || fcpubdata.databaseTypeName=="mysql"){&#13;&#10;		sPrecision="";&#13;&#10;		switch(sType){&#13;&#10;			case 'int':{&#13;&#10;				sWidth = "4";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'bigint':{&#13;&#10;				sWidth="8";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'bit':{&#13;&#10;				sWidth="1";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'datetime':{&#13;&#10;				sWidth="8";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'decimal':{&#13;&#10;				sWidth="9";&#13;&#10;				sPrecision="3";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'float':{&#13;&#10;				sWidth="8";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'image':{&#13;&#10;				sWidth="16";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'money':{&#13;&#10;				sWidth="8";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'ntext':{&#13;&#10;				sWidth="16";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'numeric':{&#13;&#10;				sWidth="9";&#13;&#10;				sPrecision="3"&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'real':{&#13;&#10;				sWidth="4";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'smalldatetime':{&#13;&#10;				sWidth="4";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'smallint':{&#13;&#10;				sWidth="2";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'smallmoney':{&#13;&#10;				sWidth="4";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'sql_variant':{&#13;&#10;				sWidth="";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'text':{&#13;&#10;				sWidth="16";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'timestamp':{&#13;&#10;				sWidth="8";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'tinyint':{&#13;&#10;				sWidth="1";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'unqueidentifier':{&#13;&#10;				sWidth="16";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'binary':{&#13;&#10;				sWidth="50";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'varbinary':{&#13;&#10;				sWidth="50";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'char':{&#13;&#10;				sWidth="10";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'nchar':{&#13;&#10;				sWidth="10";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'varchar':{&#13;&#10;				sWidth="50";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;			case 'nvarchar':{&#13;&#10;				sWidth="50";&#13;&#10;				break;&#13;&#10;			} &#13;&#10;		}&#13;&#10;		if(sType == "nvarchar" || sType == "varchar" || sType == "nchar" || sType == "char" ){&#13;&#10;			txtFsize.readOnly = false;&#13;&#10;		}else{&#13;&#10;			txtFsize.readOnly = true;&#13;&#10;		}&#13;&#10;	}&#13;&#10;	if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;		sPrecision="";&#13;&#10;		sWidth="";&#13;&#10;		switch(sType){&#13;&#10;			case 'CHAR':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'VARCHAR2':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'NCHAR':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'NVARCHAR2':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'NUMBER':{&#13;&#10;				sWidth = "10";&#13;&#10;				sPrecision="0"&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'RAW':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'FLOAT':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;		}	&#13;&#10;	}	&#13;&#10;	if(fcpubdata.databaseTypeName=="db2"){&#13;&#10;		sPrecision="";&#13;&#10;		sWidth="";&#13;&#10;		switch(sType){&#13;&#10;			case 'CHARACTER':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'VARCHAR':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'GRAPHIC':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'VARGRAPHIC':{&#13;&#10;				sWidth = "10";&#13;&#10;				break;&#13;&#10;			}&#13;&#10;			case 'DECIMAL':{&#13;&#10;				sWidth = "5";&#13;&#10;				sPrecision="0"&#13;&#10;				break;&#13;&#10;			}&#13;&#10;		}		&#13;&#10;	}	&#13;&#10;	txtFsize.value=sWidth;&#13;&#10;	txtFdec.value=sPrecision;&#13;&#10;	uf_disabled();&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_change(){&#13;&#10;	changeType(cboType.value,txtFsize.value,txtFdec.value);&#13;&#10;	txtFdefault.value="";	&#13;&#10;}&#13;&#10;&#13;&#10;function uf_disabled(){&#13;&#10;	var sType=cboType.value;&#13;&#10;	if(fcpubdata.databaseTypeName=="sqlserver" || fcpubdata.databaseTypeName=="mysql"){&#13;&#10;		if(sType!='numeric' && sType!='decimal'){&#13;&#10;			txtFdec.disabled=true;&#13;&#10;			txtFdec.style.backgroundColor="Menu"	&#13;&#10;		}else{&#13;&#10;			txtFdec.removeAttribute("disabled");&#13;&#10;			txtFdec.style.backgroundColor="white"&#13;&#10;		}&#13;&#10;	}&#13;&#10;	if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;		if(sType != 'NUMBER'){&#13;&#10;			txtFdec.disabled=true;&#13;&#10;			txtFdec.style.backgroundColor="Menu"	&#13;&#10;		}else{&#13;&#10;			txtFdec.removeAttribute("disabled");&#13;&#10;			txtFdec.style.backgroundColor="white"&#13;&#10;		}&#13;&#10;	}	&#13;&#10;	if(fcpubdata.databaseTypeName=="db2"){&#13;&#10;		if(sType != 'DECIMAL'){&#13;&#10;			txtFdec.disabled=true;&#13;&#10;			txtFdec.style.backgroundColor="Menu"	&#13;&#10;		}else{&#13;&#10;			txtFdec.removeAttribute("disabled");&#13;&#10;			txtFdec.style.backgroundColor="white"&#13;&#10;		}&#13;&#10;	}		&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_Precision(){&#13;&#10;	if(fcpubdata.databaseTypeName=="sqlserver"){&#13;&#10;		if(txtFdec.value>38){&#13;&#10;			alert("精度设置值必须位于1至38之间")	;&#13;&#10;			txtFdec.value="3";&#13;&#10;			return;&#13;&#10;		}&#13;&#10;	}&#13;&#10;	if(fcpubdata.databaseTypeName=="oracle"){&#13;&#10;		if(txtFdec.value>32767 && txtFdec.value<-32768){&#13;&#10;			alert("值必须介于 -32768 和 32767 之间")	;&#13;&#10;			txtFdec.value="3";&#13;&#10;			return;&#13;&#10;		}	&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function uf_Width(){&#13;&#10;	if(fcpubdata.databaseTypeName=="sqlserver"){&#13;&#10;		if(txtFsize.value>8000){&#13;&#10;			alert("长度的设置值必须位于1至8000之间");&#13;&#10;			txtFsize.value="50";&#13;&#10;			return;&#13;&#10;		}&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function uf_sDefault(){&#13;&#10;	if(fcpubdata.databaseTypeName=="sqlserver"){&#13;&#10;		if(cboType.value=="bigint" || cboType.value=="binary" || cboType.value=="bit" || cboType.value=="decimal" || cboType.value=="float" || cboType.value=="int" || cboType.value=="money" || cboType.value=="numeric" || cboType.value=="real" || cboType.value=="smallint" || cboType.value=="smallmoney" || cboType.value=="sql_variant" || cboType.value=="tinyint" || cboType.value=="varbinary"){&#13;&#10;			if(IsNum(txtFdefault.value)==false && IsSpace(txtFdefault.value)==false){&#13;&#10;				return 0;	&#13;&#10;			}&#13;&#10;		}&#13;&#10;	}&#13;&#10;	&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js" userType BLONclose BLONopenBefore center="居中" unselectable="on" keyfield controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" posheight="130" poswidth="500" entertype="修改" codeheader="BBB" mkbh caption="字段" type="ST" dj_sn="fcs_edit_column" billtaborder="<root><taborder>txtFname</taborder><taborder>cboType</taborder><taborder>txtFsize</taborder><taborder>txtFdec</taborder><taborder>cboNull</taborder><taborder>txtFdefault</taborder><taborder>FCButton1</taborder><taborder>FCButton2</taborder></root>" contxml="<root><label><id>Label1</id><id>Label2</id><id>Label3</id><id>Label4</id><id>Label5</id><id>Label6</id></label><combobox><id>cboType</id><id>cboNull</id></combobox><button><id>FCButton1</id><id>FCButton2</id></button><text><id>txtFname</id><id>txtFsize</id><id>txtFdec</id><id>txtFdefault</id></text><dataset><id>imgdataset1</id></dataset></root>" BLONopen="uf_open()" toolbar="不带工具栏" window="有模式窗口" posleft postop isfile="是" OtherSave="否" idtype="1"><SPAN onmove=move() oncontrolselect=controlselect() id=Label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 8px; WIDTH: 111px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 17px; BACKGROUND-COLOR: #d4d0c8; TEXT-ALIGN: center; backgroundColor1: #d4d0c8" onmovestart=moveStart() value="Label1" controltype="label">西文字段名</SPAN><SPAN onmove=move() oncontrolselect=controlselect() id=Label2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 120px; WIDTH: 106px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 17px; BACKGROUND-COLOR: #d4d0c8; TEXT-ALIGN: center; backgroundColor1: #d4d0c8" onmovestart=moveStart() value="Label2" controltype="label">字段类型</SPAN><SPAN onmove=move() oncontrolselect=controlselect() id=Label3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 227px; WIDTH: 65px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 17px; BACKGROUND-COLOR: #d4d0c8; TEXT-ALIGN: center; backgroundColor1: #c0c0c0" onmovestart=moveStart() value="Label3" controltype="label">字段宽度</SPAN><SPAN onmove=move() oncontrolselect=controlselect() id=Label4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 293px; WIDTH: 44px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 17px; BACKGROUND-COLOR: #d4d0c8; TEXT-ALIGN: center; backgroundColor1: #d4d0c8" onmovestart=moveStart() value="Label4" controltype="label">精度</SPAN><SPAN onmove=move() oncontrolselect=controlselect() id=Label5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 338px; WIDTH: 72px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 17px; BACKGROUND-COLOR: #d4d0c8; TEXT-ALIGN: center; backgroundColor1: #d4d0c8" onmovestart=moveStart() value="Label5" controltype="label">允许空</SPAN><SPAN onmove=move() oncontrolselect=controlselect() id=Label6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 411px; WIDTH: 78px; FONT-FAMILY: ; POSITION: absolute; TOP: 8px; HEIGHT: 17px; BACKGROUND-COLOR: #d4d0c8; TEXT-ALIGN: center; backgroundColor1: #d4d0c8" onmovestart=moveStart() value="Label6" controltype="label">缺省值</SPAN><INPUT onmove=move() oncontrolselect=controlselect() id=txtFname onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 8px; WIDTH: 110px; POSITION: absolute; TOP: 26px; HEIGHT: 19px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" onmovestart=moveStart() value=西文字段名 controltype="text" dataset="imgdataset1" CanSelect="false" china="西文字段名" field="fdname"></INPUT><SELECT onmove=move() oncontrolselect=controlselect() id=cboType onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 119px; WIDTH: 108px; FONT-FAMILY: ; POSITION: absolute; TOP: 26px; HEIGHT: 39px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() onchange='bill_onclick("uf_change()")' controltype="combobox" dataset="imgdataset1" china="字段类型" field="fdtype" sql check="1" temptext tempvalue></SELECT><INPUT onmove=move() oncontrolselect=controlselect() id=txtFsize onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 226px; WIDTH: 65px; POSITION: absolute; TOP: 26px; HEIGHT: 19px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" onmovestart=moveStart() onchange='bill_onclick("uf_Width()")' value=字段宽度 controltype="text" dataset="imgdataset1" CanSelect="false" china="字段宽度" field="fdsize"></INPUT><INPUT onmove=move() oncontrolselect=controlselect() id=txtFdec onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 292px; WIDTH: 45px; POSITION: absolute; TOP: 26px; HEIGHT: 19px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" onmovestart=moveStart() onchange='bill_onclick("uf_Precision()")' value=字段精度 controltype="text" dataset="imgdataset1" CanSelect="false" china="字段精度" field="fddec"></INPUT><SELECT onmove=move() oncontrolselect=controlselect() id=cboNull onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 338px; WIDTH: 73px; FONT-FAMILY: ; POSITION: absolute; TOP: 26px; HEIGHT: 29px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() controltype="combobox" dataset="imgdataset1" china="允许空" field="isnullable" sql check="1" temptext="NULL&#13;&#10;NOT NULL" tempvalue="NULL&#13;&#10;NOT NULL"><OPTION value=NULL selected>NULL</OPTION><OPTION value="NOT NULL">NOT NULL</OPTION></SELECT><INPUT onmove=move() oncontrolselect=controlselect() id=txtFdefault onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 410px; WIDTH: 79px; POSITION: absolute; TOP: 26px; HEIGHT: 19px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" onmovestart=moveStart() value=缺省值 controltype="text" dataset="imgdataset1" CanSelect="false" china="缺省值" field="text"></INPUT><BUTTON onmove=move() oncontrolselect=controlselect() id=FCButton1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 333px; WIDTH: 67px; FONT-FAMILY: ; POSITION: absolute; TOP: 52px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'>确 定</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=FCButton2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 404px; WIDTH: 67px; FONT-FAMILY: ; POSITION: absolute; TOP: 52px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("CloseBill()")'>取 消</BUTTON><IMG id=imgdataset1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 69px; WIDTH: 39px; POSITION: absolute; TOP: 56px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" formatxml='<root><tr rowstate="add"><td>fdname</td><td>西文字段名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fdtype</td><td>字段类型</td><td>字符</td><td>20</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fdsize</td><td>字段宽度</td><td>整数</td><td>2</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fddec</td><td>字段精度</td><td>整数</td><td>2</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>isnullable</td><td>允许空</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>text</td><td>缺省值</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' Like="否" iscreatetable="否" opensql chnname AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1" temptable="TMP_IMGDATASET1"></DIV>