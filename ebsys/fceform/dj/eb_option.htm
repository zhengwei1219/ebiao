<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<STYLE> .userData{behavior:url(#default#userData);}
	        @import url(../../fceform/css/dj.css); 
	    </STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>var obj
function uf_open() {
	new Eform.SysForm().setButtonImage();
	obj = fcpubdata.obj[1];
	txtRows.value = obj.rows;
	txtCols.value = obj.cols;
	txtRowHeight.value = obj.rowHeight;
	txtColWidth.value = obj.colWidth;
	txtFirstColWidth.value = obj.firstColWidth;
	SetCheckBoxValue(chkFromDb,obj.fromdb);
	SetCheckBoxValue(chkShiftF,obj.shiftf);
}
function uf_ok() {
	obj.rows=txtRows.value;
	obj.cols=txtCols.value;
	obj.rowHeight=txtRowHeight.value;
	obj.colWidth = txtColWidth.value;
	obj.firstColWidth = txtFirstColWidth.value;
	obj.fromdb = chkFromDb.value;
	obj.shiftf = chkShiftF.value;
	
	var oXmlConfig = SetDomFile("../.."+fcpubdata.userDir+"/xml/econfig.xml");
	oXmlConfig.documentElement.childNodes(1).childNodes(0).text = obj.fromdb;
	oXmlConfig.documentElement.childNodes(1).childNodes(1).text = obj.rows;
	oXmlConfig.documentElement.childNodes(1).childNodes(2).text = obj.cols;
	oXmlConfig.documentElement.childNodes(1).childNodes(3).text = obj.rowHeight;
	oXmlConfig.documentElement.childNodes(1).childNodes(4).text = obj.colWidth;
	oXmlConfig.documentElement.childNodes(1).childNodes(5).text = obj.firstColWidth;
	if(oXmlConfig.documentElement.childNodes(1).childNodes.length > 6 ){
		oXmlConfig.documentElement.childNodes(1).childNodes(6).text = obj.shiftf;
	}else{
		var oX = SetDom("<shiftf>"+obj.shiftf+"</shiftf>");
		oXmlConfig.documentElement.childNodes(1).appendChild(oX.documentElement);
	}
	uf_savexml(oXmlConfig);
	//清空顶层窗口的缓存.
	try{
		var oTopWin = fcpubdata.obj[4];
		oTopWin.fctopdata.econfig = null;
	}catch(e){}
	
	window.close();
	
}
function uf_savexml(oXml){
		//alert(oXml.documentElement.xml);
	var sContent ='<?xml version="1.0" encoding="'+fcpubdata.encoding+'" ?>'+ oXml.documentElement.xml ;
	sContent = "<![CDATA"+"["+sContent +"]"+"]>";
	var sXml = "<file>"+fcpubdata.userDir+"/xml/econfig.xml</file><text>"+sContent+"</text>";
	var ret=savedesignhtml(sXml);
	return ret;	
}</script><script src='../js/fcopendj.js'></script><script defer src='../js/fcsavedj.js'></script><script src='../js/fcselfuse.js'></script><script src='../js/fcbasecont.js'></script><script defer src='../js/fcother.js'></script><script defer src='../js/selectdate.js'></script><script src='../js/design.js'></script><script src='../../fceformext/js/userfunc.js'></script><link href=../css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../css/shape.css'  /><link type='text/css' rel='stylesheet' href='../css/Button.css'/><script >document.styleSheets[0].addRule(".xpSpin","behavior: url(../htc/NumEdit.htc)",0);</script>
<DIV id=SKbillsheet jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;design.js&#13;&#10;~userfunc.js" userType BLONclose BLONopenBefore idtype="1" OtherSave="否" isfile="是" postop posleft window="有模式窗口" toolbar="不带工具栏" BLONopen="uf_open()" contxml="<root><checkbox><id>chkFromDb</id><id>chkShiftF</id></checkbox><label><id>label7</id><id>label27</id><id>label28</id><id>label29</id><id>label30</id><id>label31</id><id>label32</id><id>label33</id><id>label34</id><id>Label4</id><id>label35</id></label><shape><id>shape3</id></shape><tab><id>tab1</id></tab><button><id>cmdOk</id><id>cmdClose</id></button><spin><id>txtRows</id><id>txtCols</id><id>txtRowHeight</id><id>txtColWidth</id><id>txtFirstColWidth</id></spin></root>" billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>txtRows</taborder><taborder>txtCols</taborder><taborder>txtRowHeight</taborder><taborder>txtColWidth</taborder><taborder>chkFromDb</taborder><taborder>txtFirstColWidth</taborder><taborder>chkShiftF</taborder></root>" dj_sn="eb_option" type="ST" caption="报表选项" mkbh codeheader="BBB" entertype="修改" poswidth="300" posheight="330" controlno="SKButton:0;SKDBedit:0;checkbox:2;label:35;radio:1;listbox:0;textarea:0;combobox:7;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:3;tab:1;div:0;DsMain_field:0;a:0;button:2;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:14;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" keyfield center="居中" AutoResizeXml><DIV style="POSITION: absolute; WIDTH: 282px; HEIGHT: 263px; TOP: 1px; LEFT: 3px" id=tab1 class=tab-pane controltype="tab" IsHideTitle="undefined" showtype="luna">
<DIV style="WIDTH: 282px; HEIGHT: 245px" class=tab-page>
<H2 class=tab>常规</H2><?xml:namespace prefix = v /><v:RoundRect style="POSITION: absolute; WIDTH: 242px; DISPLAY: block; HEIGHT: 89px; TOP: 13px; LEFT: 4px" id=shape3 controltype="shape" cover="9" arcsize = "4321f" coordsize = "21600,21600" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:RoundRect>&nbsp; 
<DIV style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 12px; FONT-FAMILY: 宋体; HEIGHT: 15px; FONT-SIZE: 10pt; TOP: 32px; LEFT: 11px" id=label7 onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">行数</DIV>
<DIV style="POSITION: absolute; WIDTH: 46px; HEIGHT: 22px; TOP: 26px; LEFT: 39px; align: undefined" id=txtRows class=xpSpin align="undefined ParentPos='相对' " value="" controltype="spin" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="26px" left="39px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>&nbsp; 
<DIV style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 12px; FONT-FAMILY: 宋体; HEIGHT: 15px; FONT-SIZE: 10pt; TOP: 32px; LEFT: 135px" id=label27 onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">列数</DIV>
<DIV style="POSITION: absolute; WIDTH: 46px; HEIGHT: 22px; TOP: 27px; LEFT: 160px; align: undefined" id=txtCols class=xpSpin align="undefined ParentPos='相对' " value="" controltype="spin" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="27px" left="160px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 12px; FONT-FAMILY: 宋体; HEIGHT: 15px; FONT-SIZE: 10pt; TOP: 55px; LEFT: 11px" id=label28 onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">行高</DIV>
<DIV style="POSITION: absolute; WIDTH: 46px; HEIGHT: 22px; TOP: 49px; LEFT: 39px; align: undefined" id=txtRowHeight class=xpSpin align="undefined ParentPos='相对' " value="" controltype="spin" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="49px" left="39px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 12px; FONT-FAMILY: 宋体; HEIGHT: 15px; FONT-SIZE: 10pt; TOP: 54px; LEFT: 135px" id=label29 onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">列宽</DIV>
<DIV style="POSITION: absolute; WIDTH: 46px; HEIGHT: 22px; TOP: 48px; LEFT: 160px; align: undefined" id=txtColWidth class=xpSpin align="undefined ParentPos='相对' " value="" controltype="spin" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="48px" left="160px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 12px; FONT-FAMILY: 宋体; HEIGHT: 15px; FONT-SIZE: 10pt; TOP: 79px; LEFT: 14px" id=label30 onmovestart=moveStart() noWrap value="label7" controltype="label" NotBg="否">第1列列宽</DIV>
<DIV style="POSITION: absolute; WIDTH: 46px; HEIGHT: 22px; TOP: 74px; LEFT: 74px; align: undefined" id=txtFirstColWidth class=xpSpin align="undefined ParentPos='相对' " value="" controltype="spin" Min="1" Max="32000" NextNum="1" enabled="否" height="22px" width="46px" top="74px" left="74px" display="" fontweight="" color="" backgroundcolor="" fontfamily="" fontstyle="" fontsize="" dataset="undefined" field="undefined"></DIV>
<DIV style="POSITION: absolute; WIDTH: 80px; HEIGHT: 20px; TOP: 173px; LEFT: 9px" id=chkFromDb onmovestart=moveStart() noWrap value="no" controltype="checkbox" NotBg="否" falsevalue="no" truevalue="yes" divtype="checkbox"><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>从数据库中读写报表格式文件</SPAN></DIV>
<DIV style="POSITION: absolute; WIDTH: 19px; HEIGHT: 15px; TOP: 53px; LEFT: 88px" id=label31 onmovestart=moveStart() noWrap value="label31" controltype="label" NotBg="否">px</DIV>
<DIV style="POSITION: absolute; WIDTH: 19px; HEIGHT: 15px; TOP: 50px; LEFT: 208px" id=label32 onmovestart=moveStart() noWrap value="label31" controltype="label" NotBg="否">px</DIV>
<DIV style="POSITION: absolute; WIDTH: 19px; HEIGHT: 15px; TOP: 78px; LEFT: 125px" id=label33 onmovestart=moveStart() noWrap value="label31" controltype="label" NotBg="否">px</DIV>
<DIV style="POSITION: absolute; BACKGROUND-COLOR: #ffffff; WIDTH: 65px; HEIGHT: 15px; TOP: 4px; LEFT: 19px" id=label34 onmovestart=moveStart() noWrap value="label34" controltype="label" NotBg="否">新建报表时的默认值：</DIV><SPAN style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 261px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 43px; COLOR: #b2b2b2; FONT-SIZE: 12px; TOP: 194px; LEFT: 8px" id=Label4 controltype="label" NotBg="否" align="Left">勾上它报表格式文件将不以单独的文件形式存在,而是保存到数据库的表中,这需要用户自已先定好保存到哪个表中.</SPAN> 
<DIV style="POSITION: absolute; WIDTH: 80px; HEIGHT: 20px; TOP: 107px; LEFT: 8px" id=chkShiftF onmovestart=moveStart() noWrap value="no" controltype="checkbox" NotBg="否" falsevalue="no" truevalue="yes" divtype="checkbox"><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>增删行列时自动调整公式中单元格引用</SPAN></DIV><SPAN style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 253px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 42px; COLOR: #b2b2b2; FONT-SIZE: 12px; TOP: 129px; LEFT: 8px" id=label35 controltype="label" NotBg="否" align="Left">例如: B2单元格的公式为 C2+1,如在第二行前插入一行后,B2单元格就变成了B3,此时它的公式就自动调整为 C3+1 </SPAN></DIV></DIV>
<SCRIPT>var tab1 = new WebFXTabPane( document.getElementById( "tab1" ) );</SCRIPT>
<BUTTON style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 268px; LEFT: 121px" id=cmdOk onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_ok()")'></BUTTON><BUTTON style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 268px; LEFT: 203px" id=cmdClose onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("CloseBill()")'></BUTTON></DIV></body></html>