<script>var obj&#13;&#10;function uf_open(){&#13;&#10;	obj = fcpubdata.obj[1]; //当前单元格&#13;&#10;	var s1 = obj.innerText;&#13;&#10;	if(IsSpace(s1) == false){&#13;&#10;		var ipos1 = s1.indexOf(",list(");&#13;&#10;		var ipos2 = s1.indexOf("),list(");&#13;&#10;		var ipos3 = s1.lastIndexOf("),");&#13;&#10;		if(ipos1>0 && ipos2>ipos1 && ipos3>ipos2){&#13;&#10;			cboName.value = s1.substring(11,ipos1);&#13;&#10;			var s2 = s1.substring(ipos1+6,ipos2);&#13;&#10;			var s3 = s1.substring(ipos2+7,ipos3);&#13;&#10;			if(s2.length >0 ){&#13;&#10;				txt1.value = RepStr(s2.substring(1,s2.length-1),"\",\"","\r\n");&#13;&#10;			}&#13;&#10;			txt2.value = RepStr(s3,",","\r\n");&#13;&#10;			cboType.value = s1.substring(ipos3+2,s1.length-1);&#13;&#10;		}&#13;&#10;	}&#13;&#10;	uf_initcbo();&#13;&#10;	e_PropWinOnload();&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;function uf_ok() {&#13;&#10;	//=subreport(report1,list("arg1"),list(A1),0)&#13;&#10;	if(IsSpace(cboName.value)){&#13;&#10;		alert("子报表名称不能为空");&#13;&#10;		return;	&#13;&#10;	}&#13;&#10;	var arr1 = txt1.value.split("\r\n");&#13;&#10;	var arr2 = txt2.value.split("\r\n");&#13;&#10;	if(arr1.length != arr2.length ){&#13;&#10;		alert("参数与对应表达式的行数应一致!");&#13;&#10;		return;	&#13;&#10;	}&#13;&#10;	var s1="",s2="";&#13;&#10;	if(arr1.length == 1 && IsSpace(new Eapi.Str().trim(arr1[0])) && IsSpace(new Eapi.Str().trim(arr2[0])) ){&#13;&#10;	}else{&#13;&#10;&#13;&#10;		for(var i=0;i<arr1.length;i++){&#13;&#10;			if(IsSpace(new Eapi.Str().trim(arr1[i]))){&#13;&#10;				alert("有的参数为空!")&#13;&#10;				return;&#13;&#10;			}&#13;&#10;			if(IsSpace(new Eapi.Str().trim(arr2[i]))){&#13;&#10;				alert("有的对应表达式为空!")&#13;&#10;				return;&#13;&#10;			}&#13;&#10;			s1 += '"'+arr1[i]+'"';&#13;&#10;			s2 += arr2[i] ; &#13;&#10;			if(i< arr1.length-1){&#13;&#10;				s1 += ",";&#13;&#10;				s2 += ",";&#13;&#10;			} 	&#13;&#10;		}&#13;&#10;	}&#13;&#10;	var sRet = '=subreport('+cboName.value+",list("+s1+"),list("+s2+"),"+cboType.value+")";&#13;&#10;	&#13;&#10;	obj.innerText = sRet ;&#13;&#10;	//alert(obj.innerText);&#13;&#10;	obj.e_data_type="5"; //设置当前单元格为子报表&#13;&#10;	obj.style.backgroundImage = "url(../images/eb_design_cell_subrpt.gif)" ;&#13;&#10;	window.returnValue = sRet ;&#13;&#10;	CloseBill();&#13;&#10;}&#13;&#10;function uf_openwin() {&#13;&#10;	var sRet = DjOpen("eb_subrpt",fcpubdata.obj,"展现");&#13;&#10;	if(IsSpace(sRet) == false){&#13;&#10;		uf_initcbo();&#13;&#10;	}&#13;&#10;}&#13;&#10;function uf_initcbo() {&#13;&#10;	var oT = fcpubdata.obj[0];&#13;&#10;	var sxml = oT.e_sub_reportbak;&#13;&#10;	if(IsSpace(sxml))return;&#13;&#10;	var oXml = SetDom(unescape(sxml));&#13;&#10;	var l = oXml.documentElement.childNodes.length -1;&#13;&#10;	var sOption = "";&#13;&#10;	for(var i=0;i<l;i++){&#13;&#10;		var tmp = oXml.documentElement.childNodes(i).childNodes(0).text ;&#13;&#10;		sOption +="<option value=\""+tmp+"\">"+tmp+"</option>";		&#13;&#10;	}&#13;&#10;	cboName.options.length = 0;&#13;&#10;	cboName.outerHTML = SelectAddOption(cboName,sOption);&#13;&#10;	&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" center="居中" unselectable="on" keyfield controlno="SKButton:0;SKDBedit:0;checkbox:0;label:4;radio:0;listbox:0;textarea:2;combobox:2;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:1;tab:0;div:0;DsMain_field:0;a:0;button:1;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" posheight="240" poswidth="330" entertype="修改" codeheader="BBB" mkbh caption="设置子报表" type="PR" dj_sn="eb_subrptset" billtaborder="<root><taborder>txt1</taborder><taborder>txt2</taborder><taborder>cboName</taborder><taborder>cboType</taborder><taborder>button1</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" contxml="<root><label><id>label1</id><id>label2</id><id>label3</id><id>label4</id></label><textarea><id>txt1</id><id>txt2</id></textarea><combobox><id>cboName</id><id>cboType</id></combobox><shape><id>shape1</id></shape><button><id>button1</id><id>cmdOk</id><id>cmdClose</id></button></root>" BLONopen="uf_open()" toolbar="不带工具栏" window="有模式窗口" posleft postop isfile="是" OtherSave="否" idtype="1" BLONopenBefore BLONclose userType><DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 6px; LEFT: 7px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label1" NotBg="否">子报表名称:</DIV><SELECT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 125px; HEIGHT: 25px; TOP: 1px; LEFT: 84px" id=cboName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="combobox" temptext tempvalue sql check="1"></SELECT><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 84px; HEIGHT: 25px; TOP: 1px; LEFT: 212px" id=button1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("uf_openwin()")' dropstyle="否" controltype="button">定义子报表</BUTTON> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 27px; LEFT: 9px" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label2" NotBg="否">引入方式:</DIV><SELECT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 126px; HEIGHT: 25px; TOP: 25px; LEFT: 83px" id=cboType onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="combobox" temptext="主子表格线对齐&#13;&#10;主子表格线不对齐" tempvalue="1&#13;&#10;0" sql check="1"><OPTION selected value=1>主子表格线对齐</OPTION><OPTION value=0>主子表格线不对齐</OPTION></SELECT> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 53px; LEFT: 12px" id=label3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label3" NotBg="否">参数:</DIV><TEXTAREA onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 117px; HEIGHT: 93px; TOP: 71px; LEFT: 5px" id=txt1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="textarea" value="textarea1" induce="否"></TEXTAREA> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 53px; LEFT: 185px" id=label4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label4" NotBg="否">对应表达式:</DIV><TEXTAREA onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 117px; HEIGHT: 93px; TOP: 70px; LEFT: 185px" id=txt2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() rows=1 cols=23 controltype="textarea" value="textarea2" induce="否"></TEXTAREA><?xml:namespace prefix = v /><v:line style="POSITION: absolute; WIDTH: 36px; DISPLAY: block; HEIGHT: 16px; TOP: 115px; LEFT: 136px" id=shape1 onresize="" controltype="shape" cover="9" id1="7" from = "0,0" to = "27pt,0" fillcolor = "white" strokecolor = "black" strokeweight = "3pt"><v:stroke endarrow = "classic"></v:stroke></v:line><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 55px; HEIGHT: 26px; TOP: 173px; LEFT: 157px" id=cmdOk onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("uf_ok()")' dropstyle="否" controltype="button"></BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 55px; HEIGHT: 26px; TOP: 173px; LEFT: 228px" id=cmdClose onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("CloseBill()")' dropstyle="否" controltype="button"></BUTTON></DIV>