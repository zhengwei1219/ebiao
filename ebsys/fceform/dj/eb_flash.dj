<script>function uf_open() {&#13;&#10;	e_PropWinOnload();&#13;&#10;&#13;&#10;	if(IsSpace(fcpubdata.obj.chartseries) == false){&#13;&#10;		dataset1.OpenXmlData(unescape(fcpubdata.obj.chartseries));&#13;&#10;	}&#13;&#10;	var s = fcpubdata.obj.innerText&#13;&#10;	if(s.substring(0,7) != "=flash(") return ;&#13;&#10;	s = s.substring(8,s.length-2) ; //去掉外面的flash(&#13;&#10;	var arr = s.split("&");&#13;&#10;	for(var i=0;i<arr.length;i++){&#13;&#10;		var arr1 = arr[i].split("=");&#13;&#10;		var sName = arr1[0];&#13;&#10;		var sValue = arr1[1];&#13;&#10;		if(sName == "maxcols")  txtMaxCols.value = sValue;&#13;&#10;		if(sName == "type")  cboType.value = sValue;&#13;&#10;		if(sName == "xlabel")  txtxLabel.value = sValue;&#13;&#10;		if(sName == "dataXml")  txtOther.value = unescape(sValue);&#13;&#10;	}&#13;&#10;&#13;&#10;	&#13;&#10;	&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_ok() {&#13;&#10;	if(DsBeforeSave(dataset1,grid1)) return;&#13;&#10;	var s = "";&#13;&#10;	var sTmp = "";&#13;&#10;	sTmp = new Eapi.Str().trim(cboType.value);&#13;&#10;	if(IsSpace(sTmp)==false) s += "type="+sTmp+"&";&#13;&#10;	sTmp = new Eapi.Str().trim(txtxLabel.value);&#13;&#10;	if(IsSpace(sTmp)==false) s += "xlabel="+sTmp+"&";&#13;&#10;	sTmp = txtMaxCols.value;&#13;&#10;	if(sTmp!="0") s += "maxcols="+sTmp+"&";&#13;&#10;	&#13;&#10;	var bool = false;&#13;&#10;	var tgrid = grid1.tab;&#13;&#10;	var l = tgrid.rows.length;&#13;&#10;	for(var i=1;i<l;i++){&#13;&#10;		var sName = tgrid.rows(i).cells(1).innerText;&#13;&#10;		if(IsSpace(sName)) continue;&#13;&#10;		var sValue = tgrid.rows(i).cells(2).innerText;&#13;&#10;		if(IsSpace(sValue)) continue;&#13;&#10;		s += "s"+(9+i)+"_name="+sName+"&";&#13;&#10;		s += "s"+(9+i)+"_value="+sValue+"&";&#13;&#10;		var sLink = tgrid.rows(i).cells(3).innerText;&#13;&#10;		if(IsSpace(sLink) == false){&#13;&#10;			s += "s"+(9+i)+"_link="+sLink+"&";&#13;&#10;		}&#13;&#10;		bool=true;&#13;&#10;	}&#13;&#10;	if(bool==false){&#13;&#10;		alert("至少要设置好一行系列!");&#13;&#10;		return;	&#13;&#10;	}&#13;&#10;	s += "seriesCount="+(l-1)+"&";&#13;&#10;	sTmp = new Eapi.Str().trim(txtOther.value);&#13;&#10;	if(IsSpace(sTmp)){&#13;&#10;		alert("XML数据不能为空!");&#13;&#10;		return;	&#13;&#10;	} &#13;&#10;	s += "dataXml="+escape(sTmp)+"&";&#13;&#10;	&#13;&#10;	if(s!= "") s= s.substring(0,s.length-1);&#13;&#10;	s = "=flash(\"" + s + "\")";&#13;&#10;	window.returnValue = s;&#13;&#10;	&#13;&#10;	fcpubdata.obj.chartseries = escape(dataset1.xml);&#13;&#10;	fcpubdata.obj.e_data_type="8"; //强制单元格数据类型为统计图&#13;&#10;	fcpubdata.obj.style.backgroundImage="url(../images/eb_design_cell_chart.gif)";&#13;&#10;	window.close();&#13;&#10;	&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;fcdate.js&#13;&#10;~userfunc.js" userType dj_sn="eb_flash" caption="chart属性" type="PR" isfile="是" center="居中" posleft postop poswidth="430" posheight="380" toolbar="不带工具栏" window="有模式窗口" BLONopen="uf_open()" BLONopenBefore BLONclose idtype="1" entertype="修改" keyfield codeheader="BBB" OtherSave="否" billtaborder="<root><taborder>txtxLabel</taborder><taborder>grid1</taborder><taborder>cmdAdd</taborder><taborder>cmdDel</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>txtMaxCols</taborder><taborder>txtOther</taborder><taborder>button13</taborder><taborder>txtEscape</taborder><taborder>cboType</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:2;label:50;radio:1;listbox:0;textarea:1;combobox:7;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:2;tab:1;div:0;DsMain_field:0;a:0;button:13;text:20;hr:0;checkboxlist:0;radiolist:0;dropdownlist:2;grid:1;dataset:1;spin:12;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" contxml="<root><label><id>label7</id><id>label40</id><id>label47</id><id>label48</id><id>label50</id></label><textarea><id>txtOther</id></textarea><tab><id>tab1</id></tab><button><id>cmdAdd</id><id>cmdDel</id><id>button13</id><id>cmdOk</id><id>cmdClose</id></button><text><id>txtxLabel</id><id>txtEscape</id></text><dropdownlist><id>cboType</id></dropdownlist><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset><spin><id>txtMaxCols</id></spin></root>" unselectable="on" mkbh><DIV onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 403px; HEIGHT: 311px; TOP: 1px; LEFT: 3px" id=tab1 onresize=page_onresize() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="tab" value="XML数据" CustomAttr>
<TABLE id=fcpagesubtable onmousedown=pageonclick() onresizestart=CancelEvent() bgColor=white>
<TBODY>
<TR contentEditable=false>
<TD style="BORDER-LEFT: #8ba7b6 1px solid; BACKGROUND-COLOR: white; COLOR: red; BORDER-TOP: #8ba7b6 1px solid; BORDER-RIGHT: #8ba7b6 1px solid" height=20 width=80 align=middle><FONT size=2>常规</FONT></TD>
<TD style="BORDER-LEFT: #8ba7b6 1px solid; BACKGROUND-COLOR: white; COLOR: black; BORDER-TOP: #8ba7b6 1px solid; BORDER-RIGHT: #8ba7b6 1px solid" height=20 width=80 align=middle><FONT size=2>XML数据</FONT></TD></TR></TBODY></TABLE>
<DIV oncontrolselect=controlselect() style="Z-INDEX: 1; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; BORDER-LEFT: #8ba7b6 1px solid; BACKGROUND-COLOR: white; WIDTH: 401px; HEIGHT: 291px; BORDER-TOP: #8ba7b6 1px solid; TOP: 22px; BORDER-RIGHT: #8ba7b6 1px solid" id=fcpagesub onmovestart=CancelEvent() onresizestart=CancelEvent()>
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 54px; FONT-FAMILY: 宋体; HEIGHT: 15px; FONT-SIZE: 10pt; TOP: 36px; LEFT: 210px" id=label7 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label7" NotBg="否">x轴标签值:</DIV><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 95px; HEIGHT: 20px; TOP: 33px; LEFT: 278px" id=txtxLabel onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=15 controltype="text"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 385px; HEIGHT: 123px; TOP: 142px; LEFT: 5px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dataset1" visible="是" crosstabdatatype crosstabsql cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" coltitle rowtitle crosstabformat crosstabsumtype crosstabtitle iscrosstab="否" bodyrows="-1" bodyrowheight="-1" hideVscroll="否" SetRowHeight="是" usertitle="否" usertitlehtml titlerows titlerowheight readonly="否" autoappend="否" autowidth="否" autoheight="否" canselect="是" hideHscroll="否" autosize="否"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 66px; HEIGHT: 21px; TOP: 119px; LEFT: 55px" id=cmdAdd onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("dataset1.Append()")'></BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 66px; HEIGHT: 21px; TOP: 119px; LEFT: 125px" id=cmdDel onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("dataset1.Delete()")'></BUTTON>&nbsp; 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 127px; LEFT: 11px" id=label40 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label40" NotBg="否">系列：</DIV>
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 40px; HEIGHT: 15px; TOP: 12px; LEFT: 212px" id=label47 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label47" NotBg="否">仅用前</DIV><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 35px; HEIGHT: 22px; TOP: 7px; LEFT: 251px" id=txtMaxCols onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_numedit.gif" controltype="spin" value="0" enabled="否" Min="0" Max="32000" NextNum="1"> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 12px; LEFT: 290px" id=label48 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" value="label48" NotBg="否">条数据来画图</DIV><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 155px; HEIGHT: 18px; TOP: 11px; LEFT: 12px" id=label50 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">图形类型文件名:</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 186px; HEIGHT: 20px; TOP: 30px; LEFT: 11px; ButtonWidth: 10" id=cboType onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" controltype="dropdownlist" visible="是" datasourceName xml="<tr height='16px' ><td>Area2D</td><td>Area2D</td></tr><tr height='16px' ><td>Bar2D</td><td>Bar2D</td></tr><tr height='16px' ><td>Bubble</td><td>Bubble</td></tr><tr height='16px' ><td>Column2D</td><td>Column2D</td></tr><tr height='16px' ><td>Column3D</td><td>Column3D</td></tr><tr height='16px' ><td>Doughnut2D</td><td>Doughnut2D</td></tr><tr height='16px' ><td>Doughnut3D</td><td>Doughnut3D</td></tr><tr height='16px' ><td>Line</td><td>Line</td></tr><tr height='16px' ><td>MSArea</td><td>MSArea</td></tr><tr height='16px' ><td>MSBar2D</td><td>MSBar2D</td></tr><tr height='16px' ><td>MSBar3D</td><td>MSBar3D</td></tr><tr height='16px' ><td>MSColumn2D</td><td>MSColumn2D</td></tr><tr height='16px' ><td>MSColumn3D</td><td>MSColumn3D</td></tr><tr height='16px' ><td>MSColumn3DLineDY</td><td>MSColumn3DLineDY</td></tr><tr height='16px' ><td>MSColumnLine3D</td><td>MSColumnLine3D</td></tr><tr height='16px' ><td>MSCombi2D</td><td>MSCombi2D</td></tr><tr height='16px' ><td>MSCombi3D</td><td>MSCombi3D</td></tr><tr height='16px' ><td>MSCombiDY2D</td><td>MSCombiDY2D</td></tr><tr height='16px' ><td>MSLine</td><td>MSLine</td></tr><tr height='16px' ><td>MSStackedColumn2D</td><td>MSStackedColumn2D</td></tr><tr height='16px' ><td>MSStackedColumn2DLineDY</td><td>MSStackedColumn2DLineDY</td></tr><tr height='16px' ><td>Pie2D</td><td>Pie2D</td></tr><tr height='16px' ><td>Pie3D</td><td>Pie3D</td></tr><tr height='16px' ><td>Scatter</td><td>Scatter</td></tr><tr height='16px' ><td>ScrollArea2D</td><td>ScrollArea2D</td></tr><tr height='16px' ><td>ScrollColumn2D</td><td>ScrollColumn2D</td></tr><tr height='16px' ><td>ScrollCombi2D</td><td>ScrollCombi2D</td></tr><tr height='16px' ><td>ScrollCombiDY2D</td><td>ScrollCombiDY2D</td></tr><tr height='16px' ><td>ScrollLine2D</td><td>ScrollLine2D</td></tr><tr height='16px' ><td>ScrollStackedColumn2D</td><td>ScrollStackedColumn2D</td></tr><tr height='16px' ><td>StackedArea2D</td><td>StackedArea2D</td></tr><tr height='16px' ><td>StackedBar2D</td><td>StackedBar2D</td></tr><tr height='16px' ><td>StackedBar3D</td><td>StackedBar3D</td></tr><tr height='16px' ><td>StackedColumn2D</td><td>StackedColumn2D</td></tr><tr height='16px' ><td>StackedColumn3D</td><td>StackedColumn3D</td></tr><tr height='16px' ><td>StackedColumn3DLineDY</td><td>StackedColumn3DLineDY</td></tr>" multiselect="否" addrow="否" blnempty="否" blninput="是" check="1" sql tempvalue temptext="Area2D&#13;&#10;Bar2D&#13;&#10;Bubble&#13;&#10;Column2D&#13;&#10;Column3D&#13;&#10;Doughnut2D&#13;&#10;Doughnut3D&#13;&#10;Line&#13;&#10;MSArea&#13;&#10;MSBar2D&#13;&#10;MSBar3D&#13;&#10;MSColumn2D&#13;&#10;MSColumn3D&#13;&#10;MSColumn3DLineDY&#13;&#10;MSColumnLine3D&#13;&#10;MSCombi2D&#13;&#10;MSCombi3D&#13;&#10;MSCombiDY2D&#13;&#10;MSLine&#13;&#10;MSStackedColumn2D&#13;&#10;MSStackedColumn2DLineDY&#13;&#10;Pie2D&#13;&#10;Pie3D&#13;&#10;Scatter&#13;&#10;ScrollArea2D&#13;&#10;ScrollColumn2D&#13;&#10;ScrollCombi2D&#13;&#10;ScrollCombiDY2D&#13;&#10;ScrollLine2D&#13;&#10;ScrollStackedColumn2D&#13;&#10;StackedArea2D&#13;&#10;StackedBar2D&#13;&#10;StackedBar3D&#13;&#10;StackedColumn2D&#13;&#10;StackedColumn3D&#13;&#10;StackedColumn3DLineDY" format></DIV>
<DIV oncontrolselect=controlselect() style="Z-INDEX: 0; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; BORDER-LEFT: #8ba7b6 1px solid; BACKGROUND-COLOR: white; WIDTH: 401px; HEIGHT: 291px; BORDER-TOP: #8ba7b6 1px solid; TOP: 22px; BORDER-RIGHT: #8ba7b6 1px solid" id=fcpagesub onmovestart=CancelEvent() onresizestart=CancelEvent()><TEXTAREA onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 384px; HEIGHT: 250px; TOP: 8px; LEFT: 4px" id=txtOther onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() cols=76 controltype="textarea" value="textarea1" induce="否"></TEXTAREA><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 338px; HEIGHT: 20px; TOP: 266px; LEFT: 5px" id=txtEscape onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=60 controltype="text"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 47px; HEIGHT: 25px; TOP: 262px; LEFT: 343px" id=button13 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("txtEscape.value = escape(txtEscape.value);")'>转码</BUTTON></DIV></DIV><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 25px; LEFT: 420px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" datasourceName saveastable formatxml='<root><tr rowstate="add"><td>name</td><td>系列名</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>value</td><td>系列值</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>link</td><td>超链接</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' pubpara="否" iscreatetable="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1" isaddemptyrec="否" submittype="1" submitno="1" savetable idparam issubds="否" subdsfield masterds masterdsfield Like="否" chnname temptable="TMP_DATASET1" isSubGrid="否" async="否"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 55px; HEIGHT: 26px; TOP: 321px; LEFT: 248px" id=cmdOk onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'></BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 55px; HEIGHT: 26px; TOP: 321px; LEFT: 322px" id=cmdClose onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("CloseBill()")'></BUTTON></DIV><p id=splitaddhtml /><OBJECT id="dlgHelper" CLASSID="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px" VIEWASTEXT></OBJECT>