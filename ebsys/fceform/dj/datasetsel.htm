<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<STYLE> .userData{behavior:url(#default#userData);}
	        @import url(../../fceform/css/dj.css); 
	    </STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>function uf_open() {
	new Eapi.DbStru().listTables(dssub2);
	new Eapi.DbStru().listTables($id("savetable"));	
	PropWinOnload();
}
function uf_scroll(tbname) {
	if(fcpubdata.dbStruDict == "FC_ENTITY"){
		var sXml = metadata_dataset(tbname);
		
		dssub3.OpenXmlData(sXml);
		
	}else{
		new Eapi.DbStru().listFields(tbname,dssub3);
	}
}
function uf_ok(){
	//传表名,供设计时用.
	fcpubdata.obj.queryTableName = dssub2.Field('tbname').Value;
  	copydatasetsel(dssub3,fcpubdata.obj)
  	CloseBill();
}
function uf_checked(grid,dsSel){
    grid=SKBILLgrid3
    dsSel=dssub3

    var sok="url(../images/ef_run_grid_gou.gif)"
    for(var i=1;i<grid.tab.rows.length;i++){
       grid.tab.rows(i).cells(0).style.backgroundImage=sok ;
       grid.tab.rows(i).cells(0).style.backgroundRepeat="no-repeat"
       grid.tab.rows(i).className="invert"
    }
    for(var j=0;j<dsSel.oDom.documentElement.childNodes.length;j++){
       dsSel.oDom.documentElement.childNodes(j).setAttribute("multisel","是");
    }
}
</script><script src='../js/fcopendj.js'></script><script defer src='../js/fcsavedj.js'></script><script src='../js/fcstring.js'></script><script src='../js/fcnumdate.js'></script><script src='../js/fcselfuse.js'></script><script src='../js/fcbasecont.js'></script><script defer src='../js/fcother.js'></script><script defer src='../js/selectdate.js'></script><link href=../css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../css/Button.css'/><script >document.styleSheets[0].addRule("fc\\:fc_code","behavior: url(../htc/fc_code.htc)",0);</script><script >document.styleSheets[0].addRule("fc\\:webgrid","behavior: url(../htc/webgrid.htc)",0);</script><script src='../js/fcwebgrid.js'></script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../htc/dataset.htc)",0);</script><script src='../js/fcdataset.js'></script>
<DIV onkeydown="" id=SKbillsheet class=dj ondblclick="" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;" userType dj_sn="datasetsel" caption="批量增加字段" type="LR" isfile="是" center="居中" posleft postop poswidth="685" posheight="509" toolbar="不带工具栏" window="有模式窗口" BLONopen="uf_open()" BLONopenBefore BLONclose idtype="1" entertype="修改" keyfield codeheader OtherSave="否" billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>SKButton3</taborder><taborder>SKBILLgrid2</taborder><taborder>SKBILLgrid3</taborder><taborder>savetable</taborder></root>" controlno="SKButton:3;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:3;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" contxml="<root><label><id>label1</id></label><button><id>cmdOk</id><id>cmdClose</id><id>SKButton3</id></button><dropdownlist><id>savetable</id></dropdownlist><grid><id>SKBILLgrid2</id><id>SKBILLgrid3</id></grid><dataset><id>dssub2</id><id>dssub3</id></dataset></root>" mkbh="E5" blmode="其它" dj_id="319" para="<r></r>" AutoResizeXml><?xml:namespace prefix = fc /><fc:webgrid onkeydown='bill_ongridkeydown("<SKBILLgrid2><col></col><col></col></SKBILLgrid2>")' id=SKBILLgrid2 ondblclick='bill_ongriddblclick("<SKBILLgrid2><col></col><col></col></SKBILLgrid2>")' onclick='bill_ongridclick("<SKBILLgrid2><col>uf_scroll(dssub2.Field(&amp;quot;tbname&amp;quot;).Value)</col><col>uf_scroll(dssub2.Field(&amp;quot;tbname&amp;quot;).Value)</col></SKBILLgrid2>")' controltype="grid" dataset="dssub2" visible="是" readonly="否" autoappend="否" autowidth="否" autoheight="否" canselect="是" format="<cols><col><fname>tbname</fname><cname>西文表名</cname><width>10</width><dtype>字符</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>80</columnwidth><align>left</align></col><col><fname>chnname</fname><cname>中文名称</cname><width>40</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>150</columnwidth><align>left</align></col></cols>" width="260" height="440" top="4" left="6">
<TABLE style="POSITION: absolute; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; TOP: 0px; LEFT: 0px" id=t cellSpacing=0 cellPadding=1 frame=box>
<TBODY>
<TR class=fcGridFirstRow>
<TD></TD></TR></TBODY></TABLE></fc:webgrid><fc:dataset id=dssub2 idtype="1" controltype="dataset" pubpara="否" opensortno="2" isaddemptyrec="否" submittype="1" submitno="1" issubds="否" isSubGrid="否" format="<fields><field><fieldname>tbname</fieldname><datatype>字符</datatype><displaylabel>西文表名</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>chnname</fieldname><datatype>字符</datatype><displaylabel>中文名称</displaylabel><size>40</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><tbname></tbname><chnname></chnname></dsid>")' onGetText='bill_ondatasetgettext("<dsid><tbname></tbname><chnname></chnname></dsid>")' onSetText='bill_ondatasetsettext("<dsid><tbname></tbname><chnname></chnname></dsid>")'></fc:dataset><fc:webgrid onkeydown='bill_ongridkeydown("<SKBILLgrid3><col></col><col></col><col></col><col></col><col></col></SKBILLgrid3>")' id=SKBILLgrid3 ondblclick='bill_ongriddblclick("<SKBILLgrid3><col>GridMultiSel(SKBILLgrid3,dssub3)</col><col>GridMultiSel(SKBILLgrid3,dssub3)</col><col>GridMultiSel(SKBILLgrid3,dssub3)</col><col>GridMultiSel(SKBILLgrid3,dssub3)</col><col>GridMultiSel(SKBILLgrid3,dssub3)</col></SKBILLgrid3>")' onclick='bill_ongridclick("<SKBILLgrid3><col></col><col></col><col></col><col></col><col></col></SKBILLgrid3>")' controltype="grid" dataset="dssub3" visible="是" readonly="否" autoappend="否" autowidth="否" autoheight="否" canselect="是" format="<cols><col><fname>fdname</fname><cname>西文字段名</cname><width>20</width><dtype>字符</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>100</columnwidth><align>left</align></col><col><fname>chnname</fname><cname>中文名称</cname><width>40</width><dtype>字符</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>150</columnwidth><align>left</align></col><col><fname>fdtype</fname><cname>类型</cname><width>4</width><dtype>字符</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>36</columnwidth><align>left</align></col><col><fname>fdsize</fname><cname>宽度</cname><width>2</width><dtype>整数</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>36</columnwidth><align>right</align></col><col><fname>fddec</fname><cname>精度</cname><width>2</width><dtype>整数</dtype><readonly>是</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>36</columnwidth><align>right</align></col></cols>" width="396" height="440" top="4" left="270">
<TABLE style="POSITION: absolute; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; TOP: 0px; LEFT: 0px" id=t cellSpacing=0 cellPadding=1 frame=box>
<TBODY>
<TR class=fcGridFirstRow>
<TD></TD></TR></TBODY></TABLE></fc:webgrid><fc:dataset id=dssub3 idtype="1" controltype="dataset" pubpara="否" opensortno="3" isaddemptyrec="否" submittype="1" submitno="1" issubds="否" isSubGrid="否" format="<fields><field><fieldname>fdname</fieldname><datatype>字符</datatype><displaylabel>西文字段名</displaylabel><size>20</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>chnname</fieldname><datatype>字符</datatype><displaylabel>中文名称</displaylabel><size>40</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fdtype</fieldname><datatype>字符</datatype><displaylabel>类型</displaylabel><size>4</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fdsize</fieldname><datatype>整数</datatype><displaylabel>宽度</displaylabel><size>2</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fddec</fieldname><datatype>整数</datatype><displaylabel>精度</displaylabel><size>2</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target>_blank</target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><fdname></fdname><chnname></chnname><fdtype></fdtype><fdsize></fdsize><fddec></fddec></dsid>")' onGetText='bill_ondatasetgettext("<dsid><fdname></fdname><chnname></chnname><fdtype></fdtype><fdsize></fdsize><fddec></fddec></dsid>")' onSetText='bill_ondatasetsettext("<dsid><fdname></fdname><chnname></chnname><fdtype></fdtype><fdsize></fdsize><fddec></fddec></dsid>")'></fc:dataset><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 448px; LEFT: 495px" id=cmdOk type=button controltype="button" dropstyle="否" onclick='bill_onclick("uf_ok()")'><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 448px; LEFT: 573px" id=cmdClose type=button controltype="button" dropstyle="否" onclick='bill_onclick("CloseBill()")'><INPUT style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 447px; LEFT: 405px" id=SKButton3 value=全选 type=button controltype="button" dropstyle="否" onclick='bill_onclick("uf_checked(SKBILLgrid3,dssub3)")'><LABEL style="POSITION: absolute; WIDTH: 41px; HEIGHT: 15px; TOP: 452px; LEFT: 12px" id=label1 onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">表名:</LABEL><fc:fc_code id=savetable controltype="dropdownlist" dataset="undefined" field="undefined" visible="是" datasourceName="" onselchange='bill_onclick("uf_scroll(savetable.value)")' sql2="" xml="" multiselect="否" addrow="否" blnempty="否" blninput="是" format="英文表名|中文表名" width="206" height="20" top="450" left="55" position="absolute" align="undefined" sqltrans="" enabled="false"></fc:fc_code></DIV></body></html>