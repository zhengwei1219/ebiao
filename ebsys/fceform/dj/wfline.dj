<script>var curObj;&#13;&#10;var isChangeStep=false;&#13;&#10;function uf_open() {&#13;&#10;	PropWinOnload();&#13;&#10;	uf_initList(cboBeginStep,true);&#13;&#10;	uf_initList(cboEndStep,false);&#13;&#10;	&#13;&#10;	curObj=fcpubdata.obj[0] ;&#13;&#10;	new Eform.SysForm().setValue(cboBeginStep,curObj.beginStep);&#13;&#10;	&#13;&#10;	new Eform.SysForm().setValue(cboEndStep,curObj.endStep);&#13;&#10;}&#13;&#10;function uf_ok() {&#13;&#10;	if(PropWinClickOk()) return ;&#13;&#10;	curObj.beginStep=cboBeginStep.value;&#13;&#10;	curObj.endStep=cboEndStep.value;&#13;&#10;	&#13;&#10;	if(isChangeStep) { //刷新线的位置&#13;&#10;		var oDesignWin = fcpubdata.obj[6] ;&#13;&#10;		oDesignWin.adjustLinePos(curObj);&#13;&#10;	}&#13;&#10;	window.close();&#13;&#10;}&#13;&#10;function uf_initList(cboList,isBegin){&#13;&#10;	cboList.options.length=0;&#13;&#10;	if(isBegin) {&#13;&#10;	    var oOpt=document.createElement("option")&#13;&#10;	    oOpt.text = "开始";&#13;&#10;	    oOpt.value = "BeginStep";&#13;&#10;	    cboList.add(oOpt);&#13;&#10;		&#13;&#10;	}&#13;&#10;	var oXmlMain = fcpubdata.obj[3];	 //设计器窗口的oContXml&#13;&#10;    for(var i=0;i<oXmlMain.documentElement.childNodes.length;i++){&#13;&#10;		if(oXmlMain.documentElement.childNodes(i).nodeName == "wfstep"){&#13;&#10;			var oNode = oXmlMain.documentElement.childNodes(i);&#13;&#10;		    for(var i=0;i<oNode.childNodes.length;i++){&#13;&#10;			    var oOpt=document.createElement("option")&#13;&#10;			    oOpt.text = fcpubdata.obj[6].$id(oNode.childNodes(i).text).value;&#13;&#10;			    oOpt.value = oNode.childNodes(i).text;&#13;&#10;			    cboList.add(oOpt);&#13;&#10;		    }&#13;&#10;			&#13;&#10;			break;&#13;&#10;		}&#13;&#10;	}	&#13;&#10;	&#13;&#10;	&#13;&#10;}&#13;&#10;&#13;&#10;function uf_isChangeStep(){isChangeStep=true;}&#13;&#10;&#13;&#10;</script> 
<DIV class=dj oncontrolselect=controlselect() id=SKbillsheet onkeydown="" ondblclick="" contentEditable=true jslib="fcopendj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;~userfunc.js" blmode="其它" mkbh="E5" dj_id="255" para="<r></r>" unselectable="on" billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>txtId</taborder><taborder>cboBeginStep</taborder><taborder>cboEndStep</taborder></root>" controlno="SKButton:5;SKDBedit:4;checkbox:0;label:4;radio:0;listbox:0;textarea:1;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:1;tab:0;div:0;DsMain_field:0;a:0;button:2;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0" contxml="<root><label><id>Label1</id><id>label3</id><id>label4</id></label><combobox><id>cboBeginStep</id><id>cboEndStep</id></combobox><tab><id>PageControl4</id></tab><button><id>cmdOk</id><id>cmdClose</id></button><text><id>txtId</id></text></root>" roleXml="<root></root>" runsave OtherSave="否" codeheader keyfield entertype="修改" idtype="1" BLONclose BLONopenBefore BLONopen="uf_open()" window="有模式窗口" toolbar="不带工具栏" posheight="373" poswidth="340" postop posleft center="居中" isfile="是" type="LR" caption="流程中动作属性" dj_sn="wfline"><DIV id=PageControl4 onresize=page_onresize() style="LEFT: 2px; WIDTH: 329px; POSITION: absolute; TOP: 1px; HEIGHT: 308px" value="样式" controltype="tab" CustomAttr>
<TABLE onmousedown=pageonclick() id=fcpagesubtable onresizestart=CancelEvent() bgColor=white cursor:hand>
<TBODY>
<TR contentEditable=false>
<TD style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; COLOR: red; BACKGROUND-COLOR: white" align=middle width=80 height=20><FONT size=2>属性</FONT></TD>
<TD style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; COLOR: black; BACKGROUND-COLOR: white" align=middle width=80 height=20><FONT size=2>事件</FONT></TD></TR></TBODY></TABLE>
<DIV oncontrolselect=controlselect() id=fcpagesub onresizestart=CancelEvent() style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; Z-INDEX: 1; BORDER-LEFT: #8ba7b6 1px solid; WIDTH: 327px; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; TOP: 22px; HEIGHT: 288px; BACKGROUND-COLOR: white" onmovestart=CancelEvent() controltype="a"><SPAN id=Label1 style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 19px; WIDTH: 90px; POSITION: absolute; TOP: 30px; HEIGHT: 15px" controltype="label" align="Left">控件ID(N)：</SPAN><INPUT id=txtId style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 83px; WIDTH: 150px; POSITION: absolute; TOP: 24px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" size=21 controltype="text" china> <LABEL onmove=move() oncontrolselect=controlselect() id=label3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 22px; WIDTH: 59px; POSITION: absolute; TOP: 65px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" NotBg="否">起始步骤</LABEL><SELECT onmove=move() oncontrolselect=controlselect() id=cboBeginStep onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 83px; WIDTH: 225px; POSITION: absolute; TOP: 60px; HEIGHT: 25px" onmovestart=moveStart() onchange='bill_onclick("uf_isChangeStep()")' controltype="combobox" backwidth="225" backheight="25" check="1" sql tempvalue temptext></SELECT><SELECT onmove=move() oncontrolselect=controlselect() id=cboEndStep onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 83px; WIDTH: 225px; POSITION: absolute; TOP: 88px; HEIGHT: 25px" onmovestart=moveStart() onchange='bill_onclick("uf_isChangeStep()")' controltype="combobox" backwidth="225" backheight="25" check="1" sql tempvalue temptext></SELECT><LABEL onmove=move() oncontrolselect=controlselect() id=label4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 22px; WIDTH: 59px; POSITION: absolute; TOP: 93px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" NotBg="否">目的步骤</LABEL></DIV>
<DIV oncontrolselect=controlselect() id=fcpagesub onresizestart=CancelEvent() style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; WIDTH: 327px; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; TOP: 22px; HEIGHT: 288px; BACKGROUND-COLOR: white" onmovestart=CancelEvent() controltype="a">&nbsp;</DIV></DIV><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdOk onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 168px; WIDTH: 79px; FONT-FAMILY: ; POSITION: absolute; TOP: 314px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdClose onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 250px; WIDTH: 79px; FONT-FAMILY: ; POSITION: absolute; TOP: 314px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="否" fc_onclick='bill_onclick("CloseBill()")'></BUTTON></DIV><p id=splitaddhtml /><OBJECT id="dlgHelper" CLASSID="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px" VIEWASTEXT></OBJECT>&#13;&#10;