<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<STYLE> .userData{behavior:url(#default#userData);}
	        @import url(../../fceform/css/dj.css); 
	    </STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>
var userid=parent.parent.parent.zkpub.userid;
var userName=parent.parent.parent.zkpub.username;
function uf_open(){
	txtLogName.innerText=userName ;
 	var sRet1=RepStr(txtNewPass1.outerHTML,'<INPUT ','<INPUT type=password ');
 	txtNewPass1.outerHTML=sRet1;
 	var sRet2=RepStr(txtNewPass2.outerHTML,'<INPUT ','<INPUT type=password ');
 	txtNewPass2.outerHTML=sRet2;
}
function uf_editPass()
{
	if(txtPassword.value == "") {return  alert("旧密码不能为空");} ;
	if(txtNewPass1.value == "") {return alert("新密码不能为空");};	
	if(txtNewPass2.value == "") {return alert("确认密码不能为空");};
	if(txtNewPass1.value != txtNewPass2.value){return alert("新密码与确认密码不一样");};
	var retValue = SqlToField("select password from fcq_user where password=" +txtPassword.value + " and username ='"+userName+"'")
	if(retValue == txtPassword.value) {
		var xmlSql="<update tableName='FCQ_USER'>"+"<set>password='"+txtNewPass2.value+"' </set>"+" <where>   userid='"+userid+"' </where>"+"</update>";
		doSaveData(xmlSql,function (){alert("密码修改成功")});
	}else{
		alert("请重新输入旧密码");
	}
		
}
function uf_validate(){
	if(txtNewPass1.value != txtNewPass2.value){return alert("新密码与确认密码不一样");}
}</script><script src='../../fceform/js/fcopendj.js'></script><script defer src='../../fceform/js/fcsavedj.js'></script><script src='../../fceform/js/fcselfuse.js'></script><script src='../../fceform/js/fcbasecont.js'></script><script defer src='../../fceform/js/fcother.js'></script><script defer src='../../fceform/js/selectdate.js'></script><script src='../../fceform/../fceformext/js/userfunc.js'></script><link href=../../fceform/css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../../fceform/css/shape.css'  /><link type='text/css' rel='stylesheet' href='../../fceform/css/Button.css'/><link type='text/css' rel='stylesheet' href='../../fceform/css/TextStyle.css'/>
<DIV id=SKbillsheet toolbar="不带工具栏" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" billtaborder="<root><taborder>txtPassword</taborder><taborder>txtNewPass1</taborder><taborder>txtNewPass2</taborder><taborder>button1</taborder><taborder>txtLogName</taborder></root>" dj_sn="zk_edit_password" caption="修改密码" type="ZK" isfile="是" center="  " posleft postop poswidth posheight window="当前窗口" BLONopen="uf_open()" BLONopenBefore BLONclose userType alertType="1" isCheckPermit="否" controlno="SKButton:0;SKDBedit:0;checkbox:2;label:11;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:1;tab:0;div:1;DsMain_field:0;a:1;button:10;text:11;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:6;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" contxml="<root><label><id>label3</id><id>label5</id><id>label6</id><id>label9</id><id>label10</id></label><shape><id>shape1</id></shape><div><id>div28</id></div><button><id>button1</id></button><text><id>txtPassword</id><id>txtNewPass2</id><id>txtNewPass1</id><id>txtLogName</id></text></root>" AutoResizeXml><TABLE style="WIDTH: 1042px; HEIGHT: 643px" width=1042>
<TBODY>
<TR vAlign=center>
<TD align=middle>
<DIV id=div28 style="BORDER-RIGHT: black 1px solid; BORDER-TOP: black 1px solid; OVERFLOW-Y: hidden; LEFT: 0px; OVERFLOW-X: hidden; OVERFLOW: auto; BORDER-LEFT: black 1px solid; WIDTH: 350px; BORDER-BOTTOM: black 1px solid; POSITION: static; TOP: 0px; HEIGHT: 230px; BACKGROUND-COLOR: #e8f3ff" onmovestart=moveStart() NotBg="否" controltype="div"><INPUT id=txtPassword style="LEFT: 142px; WIDTH: 176px; POSITION: absolute; TOP: 94px; HEIGHT: 20px" onmovestart=moveStart() size=29 controltype="text"><LABEL id=label3 style="FONT-SIZE: 12px; LEFT: 46px; WIDTH: 65px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 99px; HEIGHT: 15px" onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">旧密码</LABEL> <LABEL id=label5 style="LEFT: 6px; WIDTH: 86px; POSITION: absolute; TOP: 27px; HEIGHT: 15px" onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">修改密码</LABEL><?xml:namespace prefix = v /><v:line id=shape1 onresize="" style="LEFT: 6px; WIDTH: 333px; POSITION: absolute; TOP: 59px; HEIGHT: 15px" onmovestart=moveStart() controltype="shape" linetype="横线" cover="9" from = "0,0" to = "249.75pt,0" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:line><BUTTON id=button1 style="LEFT: 133px; WIDTH: 75px; POSITION: absolute; TOP: 179px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" onclick='bill_onclick("uf_editPass()")'>修改密码</BUTTON><LABEL id=label6 style="FONT-SIZE: 12px; LEFT: 18px; WIDTH: 120px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 75px; HEIGHT: 28px" onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">用户名</LABEL><LABEL id=label9 style="FONT-SIZE: 12px; LEFT: 47px; WIDTH: 80px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 148px; HEIGHT: 18px" onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">确认密码</LABEL><LABEL id=label10 style="FONT-SIZE: 12px; LEFT: 47px; WIDTH: 65px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 123px; HEIGHT: 15px" onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">新密码</LABEL><INPUT id=txtNewPass2 style="LEFT: 142px; WIDTH: 176px; POSITION: absolute; TOP: 144px; HEIGHT: 20px" onmovestart=moveStart() size=32 controltype="text" onblur='bill_onexit("uf_validate()")'><INPUT id=txtNewPass1 style="LEFT: 142px; WIDTH: 177px; POSITION: absolute; TOP: 118px; HEIGHT: 20px" onmovestart=moveStart() size=32 controltype="text"><INPUT id=txtLogName style="LEFT: 142px; WIDTH: 176px; POSITION: absolute; TOP: 69px; HEIGHT: 20px; BACKGROUND-COLOR: #e8f3ff" onmovestart=moveStart() readOnly size=32 controltype="text"></DIV>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </TD></TR></TBODY></TABLE></DIV></body></html>