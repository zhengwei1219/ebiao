<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	    
	    <link rel="stylesheet" type="text/css" href="../../fceform/css/dj.css">
		<STYLE> .userData{behavior:url(#default#userData);}</STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>function uf_open(){
	dataset1.Field('genTime').Value = GetTime();
	if(dataset1.Field('fromType').Value == 6){ 
		$id('cheIsModule').style.display = "block";
		$id('div1').style.display = "block";
		if(IsSpace(dataset1.Field('winSize').Value) == false){
			SetCheckBoxValue($id('cheIsModule'), 1);
			var winSize = RepStr(dataset1.Field('winSize').Value,"px;dialogWidth:",",");
			winSize = RepStr(winSize,"dialogHeight:","");
			var arr = winSize.split(',');
			$id('txtModalHeight').value = ToInt(arr[0]);
			$id('txtModalWidth').value = ToInt(arr[1]);
		}else{
			$id('txtModalHeight').value = 300;
			$id('txtModalWidth').value = 260;
		}
	} else{
		$id('cheIsModule').style.display = "none";
	}
	uf_hideDiv();
	//uf_initImg();
	//uf_initCheckedImg();
}


function uf_check(){
	var param = $id('paramUrl').value;
	if(IsSpace(param) == false) {
		var denghao = param.indexOf('=');
		if(param.indexOf('&') != 0 ||  denghao < 2 || denghao == param.length-1){
			alert("应输入&paramName=value形式的运行参数");
			return false;
		}
	}
	
	if(IsSpace(Trim($id('txtModalWidth').value)) !=  IsSpace(Trim($id('txtModalHeight').value))){
		alert("模态窗口的高度和宽度，必须是：都为空，或者都为整数");
		return false;
	}
	
	return true;
	
}

function uf_save(){
	var reg = /[^_|a-z|A-Z|0-9|\u4e00-\u9fa5]/;
    if(reg.test($id('name').value)) {alert("只能是数字字母下划线和汉字");return;}
	if(uf_check() == true){
		if(Trim($id('txtModalWidth').value)  == "" || $id('cheIsModule').value == "0"){
			dataset1.Field('winSize').Value = '';
		}else{
			dataset1.Field('winSize').Value = "dialogHeight:"+Trim($id('txtModalHeight').value)+"px;dialogWidth:"+Trim($id('txtModalWidth').value)+"px";
		}
		dataset1.Update() ;
		$eform('提交数据成功后刷新上一窗口');	
	}
}


function uf_checkInt(contId){
	if(Trim($id(contId).value) != ""){//空值不检查
		var ret = IsInt($id(contId).value);
		if(ret == false){
			alert('不是有效的整数');
			if(contId == "txtModalWidth"){
				$id(contId).value = 260;	
			}else{
				$id(contId).value = 300;
			}
		}
	}
}

function uf_hideDiv(){
	if($id('cheIsModule').value == 0){
		div1.style.display = "none";
	}else{
		div1.style.display ="block";
	}
}

function uf_djOpen(){
	var ret = DjOpen('zk_select_img',dataset1) ;
    if(IsSpace(ret) == false) dataset1.Field('imgPos').Value = ret ;
}


 </script><script src='../../fceform/js/fcopendj.js'></script><script defer src='../../fceform/js/fcsavedj.js'></script><script src='../../fceform/js/fcselfuse.js'></script><script src='../../fceform/js/fcbasecont.js'></script><script defer src='../../fceform/js/fcother.js'></script><script defer src='../../fceform/js/selectdate.js'></script><script src='../../fceform/../fceformext/js/userfunc.js'></script><script >document.styleSheets[0].addRule("fc\\:fc_code","behavior: url(../../fceform/htc/fc_code.htc)",0);</script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../../fceform/htc/dataset.htc)",0);</script><script src='../../fceform/js/fcdataset.js'></script>
<DIV id=SKbillsheet toolbar="不带工具栏" AutoResizeXml BLONresizeBefore BLONresizeAfter allBrowser="否" useHelp isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen="e_PropWinOnload();uf_open()" center="居中" runsave contxml="<root><checkbox><id>cheIsModule</id></checkbox><label><id>label3</id><id>label5</id><id>label7</id><id>label8</id><id>label9</id><id>label10</id><id>label11</id><id>label13</id><id>Label2</id></label><textarea><id>textarea1</id></textarea><combobox><id>combobox2</id></combobox><div><id>div1</id></div><button><id>cmdOk</id><id>cmdClose</id></button><text><id>name</id><id>paramUrl</id><id>txtModalWidth</id><id>txtModalHeight</id></text><dropdownlist><id>userType</id></dropdownlist><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:6;label:13;radio:0;listbox:0;textarea:1;combobox:2;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:4;DsMain_field:0;a:1;button:5;text:9;hr:0;checkboxlist:0;radiolist:0;dropdownlist:1;grid:0;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>name</taborder><taborder>paramUrl</taborder><taborder>cheIsModule</taborder><taborder>txtModalWidth</taborder><taborder>txtModalHeight</taborder><taborder>textarea1</taborder><taborder>combobox2</taborder><taborder>userType</taborder></root>" idtype="1" OtherSave="否" isfile="是" posheight="250px" poswidth="500px" postop posleft entertype="修改" window="有模式窗口" keyfield="id" codeheader="UNI" caption="编辑功能点" type="ZK" dj_sn="unitCard" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" envType="电脑" runParams><INPUT style="POSITION: absolute; WIDTH: 386px; HEIGHT: 20px; TOP: 38px; LEFT: 75px" id=name onmovestart=moveStart() size=63 controltype="text" dataset="dataset1" china="NAME" field="NAME"><INPUT style="POSITION: absolute; WIDTH: 386px; HEIGHT: 20px; TOP: 62px; LEFT: 75px" id=paramUrl onmovestart=moveStart() size=44 controltype="text" dataset="dataset1" china="运行参数" field="paramUrl"><LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 68px; LEFT: 9px" id=label3 onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">运行参数</LABEL><LABEL style="POSITION: absolute; WIDTH: 41px; HEIGHT: 15px; TOP: 43px; LEFT: 9px" id=label5 onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">名称</LABEL><?xml:namespace prefix = fc /><fc:dataset id=dataset1 idtype="1" controltype="dataset" sqltrans="%F4%D8%E6%D8%D4%F6Xrn%A0%96Xr%94%AA%90%A8%98Xr%94%EE%D0%F2%D0%E8%B8%F2%E6XrnXr%94%FC%E0%EA%B4%E0%u0102%D8XrnXr%94%DA%F2%EC%E8%B6%u0100%EE%D8Xr%94%F6%E0%F6%E6%D8Xr%94Xrn%E0%E8%DC%AE%EC%F4XrnXr%94%D8%EA%FA%B6%u0100%EE%D8Xr%94%F8%F4%D8%F2%B6%u0100%EE%D8Xr%94%F4%EC%F2%F6%AA%ECXr%94%D6%D8%E6%D8%F6%D8%A8%D0%F2%E4XrnXrn%DA%F2%EC%E8Xrn%9A%94%B0%CC%B8%AA%A0%B6XrnXrn%FC%DE%D8%F2%D8Xrn%E0%D6Xt%96Xr%7CXt%90X%7C%92%DA%D4%EE%F8%D2%D6%D0%F6%D0j%EC%D2%E2j%9A%E0%D8%E6%D6Xr%7EXr%7C%E0%D6Xr%7CXr%80j%BA%D0%E6%F8%D8X%7C%96Xt%90Xr%7C" async="否" format="<fields><field><fieldname>ID</fieldname><datatype>字符</datatype><displaylabel>ID</displaylabel><size>11</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>是</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>NAME</fieldname><datatype>字符</datatype><displaylabel>NAME</displaylabel><size>50</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>genTime</fieldname><datatype>日期</datatype><displaylabel>创建日期</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>paramUrl</fieldname><datatype>字符</datatype><displaylabel>运行参数</displaylabel><size>1000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>winSize</fieldname><datatype>字符</datatype><displaylabel>窗口大小</displaylabel><size>100</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fromType</fieldname><datatype>字符</datatype><displaylabel>类型</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>title</fieldname><datatype>字符</datatype><displaylabel>说明</displaylabel><size>200</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>imgPos</fieldname><datatype>字符</datatype><displaylabel>图片坐标</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>envType</fieldname><datatype>字符</datatype><displaylabel>设备类型</displaylabel><size>4</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>userType</fieldname><datatype>字符</datatype><displaylabel>用户分类</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>sortNo</fieldname><datatype>整数</datatype><displaylabel>新建字段</displaylabel><size>4</size><precision>0</precision><fieldkind>变量默认值</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>deleteMark</fieldname><datatype>整数</datatype><displaylabel>新建字段</displaylabel><size>4</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue>0</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><ID></ID><NAME></NAME><genTime></genTime><paramUrl>uf_check()</paramUrl><winSize></winSize><fromType></fromType><title></title><imgPos></imgPos><envType></envType><userType></userType><sortNo></sortNo><deleteMark></deleteMark></dsid>")' onGetText='bill_ondatasetgettext("<dsid><ID></ID><NAME></NAME><genTime></genTime><paramUrl></paramUrl><winSize></winSize><fromType></fromType><title></title><imgPos></imgPos><envType></envType><userType></userType><sortNo></sortNo><deleteMark></deleteMark></dsid>")' onSetText='bill_ondatasetsettext("<dsid><ID></ID><NAME></NAME><genTime></genTime><paramUrl></paramUrl><winSize></winSize><fromType></fromType><title></title><imgPos></imgPos><envType></envType><userType></userType><sortNo></sortNo><deleteMark></deleteMark></dsid>")' fieldtrans="<root><field><name>chnfromtype</name><trans></trans><rtrans></rtrans><sql>select%20code%2Cname%20from%20fc_datadict%20where%20typename%3D%27%u529F%u80FD%u70B9%u7C7B%u578B%27</sql></field></root>" savetable="FCQ_UNIT" issubds="否" submitno="1" submittype="2" isaddemptyrec="否" pubpara="否" opensortno="1" isSubGrid="否" saveastable="FC_UNIT" idparam="UNI"></fc:dataset><BUTTON style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; WIDTH: 65px; HEIGHT: 25px; BORDER-TOP: 0px; TOP: 4px; BORDER-RIGHT: 0px; LEFT: 3px" id=cmdOk onmovestart=moveStart() controltype="button" onclick='bill_onclick("uf_save()")' dropstyle="否"></BUTTON><BUTTON style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; WIDTH: 65px; HEIGHT: 25px; BORDER-TOP: 0px; TOP: 4px; BORDER-RIGHT: 0px; LEFT: 74px" id=cmdClose onmovestart=moveStart() controltype="button" onclick='bill_onclick("CloseBill()")' dropstyle="否"></BUTTON> 
<DIV style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 387px; DISPLAY: none; HEIGHT: 33px; BORDER-TOP: 1px solid; TOP: 172px; BORDER-RIGHT: 1px solid; LEFT: 74px" id=div1 class=control-border-color onmovestart=moveStart() controltype="div"><LABEL style="POSITION: absolute; WIDTH: 33px; HEIGHT: 15px; TOP: 8px; LEFT: 8px" id=label7 onmovestart=moveStart() controltype="label" inputTag="否">宽度</LABEL><INPUT style="POSITION: absolute; WIDTH: 54px; HEIGHT: 20px; TOP: 6px; LEFT: 37px" id=txtModalWidth onmovestart=moveStart() onchange="bill_onclick(&quot;uf_checkInt('txtModalWidth')&quot;)" value=260 size=9 controltype="text"><LABEL style="POSITION: absolute; WIDTH: 35px; HEIGHT: 15px; TOP: 8px; LEFT: 93px" id=label8 onmovestart=moveStart() controltype="label" inputTag="否">px</LABEL><LABEL style="POSITION: absolute; WIDTH: 32px; HEIGHT: 15px; TOP: 8px; LEFT: 276px" id=label9 onmovestart=moveStart() controltype="label" inputTag="否">高度</LABEL><INPUT style="POSITION: absolute; WIDTH: 54px; HEIGHT: 20px; TOP: 6px; LEFT: 308px" id=txtModalHeight onmovestart=moveStart() onchange="bill_onclick(&quot;uf_checkInt('txtModalHeight')&quot;)" value=300 size=9 controltype="text"><LABEL style="POSITION: absolute; WIDTH: 21px; HEIGHT: 15px; TOP: 8px; LEFT: 365px" id=label10 onmovestart=moveStart() controltype="label" inputTag="否">px</LABEL> </DIV>
<DIV style="POSITION: absolute; WIDTH: 80px; DISPLAY: none; HEIGHT: 20px; TOP: 152px; LEFT: 7px" id=cheIsModule onmovestart=moveStart() noWrap controltype="checkbox" value="0" falsevalue="0" truevalue="1" onclick='bill_onclick("uf_hideDiv()")'><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>是否用模态窗口打开</SPAN></DIV><LABEL style="POSITION: absolute; WIDTH: 74px; HEIGHT: 30px; TOP: 91px; LEFT: 10px" id=label11 onmovestart=moveStart() controltype="label" inputTag="否">功能点说明</LABEL><TEXTAREA style="POSITION: absolute; WIDTH: 387px; HEIGHT: 42px; TOP: 86px; LEFT: 75px" id=textarea1 onmovestart=moveStart() rows=1 cols=76 controltype="textarea" value="textarea1" dataset="dataset1" china="说明" field="title" induce="否"></TEXTAREA>&nbsp; <SELECT style="POSITION: absolute; WIDTH: 65px; HEIGHT: 25px; TOP: 132px; LEFT: 75px" id=combobox2 onmovestart=moveStart() datasourceName sql controltype="combobox" sqltrans temptext="电脑&#13;&#10;手机&#13;&#10;平板" tempvalue="电脑&#13;&#10;手机&#13;&#10;平板" check="1" async="否" dataset="dataset1" china="设备类型" field="envType"><OPTION selected value=电脑>电脑</OPTION><OPTION value=手机>手机</OPTION><OPTION value=平板>平板</OPTION></SELECT><LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 135px; LEFT: 12px" id=label13 onmovestart=moveStart() controltype="label" inputTag="否">设备类型</LABEL><fc:fc_code id=userType datasourceName="" xml="" controltype="dropdownlist" sqltrans="%F4%D8%E6%D8%D4%F6Xrn%D6%E0%F4%F6%E0%EA%D4%F6Xrn%F8%F4%D8%F2%B6%u0100%EE%D8Xrn%DA%F2%EC%E8Xrn%DA%D4%F0%CC%F8%EA%E0%F6Xrn%FC%DE%D8%F2%D8Xrn%D6%D8%E6%D8%F6%D8%E8%D0%F2%E4Xt%96n" format="" width="139" height="20" top="132" left="323" visible="是" dataset="dataset1" sql2="null" field="userType" FieldNameList="" isTreeNewSql="0" isShowTree="0" blninput="是" blnempty="否" multiselect="否" addrow="否" align="undefined" position="absolute"></fc:fc_code><SPAN style="POSITION: absolute; WIDTH: 76px; DISPLAY: block; HEIGHT: 17px; FONT-SIZE: 12px; TOP: 136px; LEFT: 250px" id=Label2 controltype="label" inputTag="否" align="Left">自定义分类：</SPAN></DIV><script></script></body></html>