<script>&#13;&#10;function uf_open()&#13;&#10;{&#13;&#10;	$urlParam('unit')&#13;&#10;	e_PropWinOnload();&#13;&#10;	var xmlRet = SelectSql("select id,name,url,fromName,fromType,paramUrl,modulexml from fcq_unit  where id='"+$urlParam('unitId')+"'",1,1);&#13;&#10;	var oXml = SetDom(xmlRet);&#13;&#10;	var unitId = oXml.documentElement.childNodes[0].childNodes[0].text; &#13;&#10;	txtMouldId.value = unitId;&#13;&#10;	txtTitle.value = oXml.documentElement.childNodes[0].childNodes[1].text;&#13;&#10;	var sUrl = oXml.documentElement.childNodes[0].childNodes[2].text;&#13;&#10;	var djsn = oXml.documentElement.childNodes[0].childNodes[3].text;&#13;&#10;	var fromType = oXml.documentElement.childNodes[0].childNodes[4].text;&#13;&#10;	var paramUrl = oXml.documentElement.childNodes[0].childNodes[5].text;&#13;&#10;	if(IsSpace(oXml.documentElement.childNodes[0].childNodes[6].text) == false){&#13;&#10;		var moduleXml = SetDom("<root>"+unescape(oXml.documentElement.childNodes[0].childNodes[6].text)+"</root>");&#13;&#10;		var windowHeight = moduleXml.documentElement.childNodes[14].text ;&#13;&#10;		if(IsSpace(windowHeight) == false) $id('winHeight').value = windowHeight;&#13;&#10;	}&#13;&#10;&#13;&#10;	if(IsSpace(paramUrl) == true) paramUrl = "";&#13;&#10;	&#13;&#10;	if((fromType == 1) || (fromType == 2)){&#13;&#10;		sUrl = "../../fceform/common/djframe.htm?djsn="+djsn+sUrl+paramUrl+"&unitid="+unitId; &#13;&#10;	}&#13;&#10;	if(fromType == 3) sUrl = "../../fceform/ereport/ebrun.htm?file="+djsn+"&fromdb=yes&unitid="+unitId;&#13;&#10;	if(fromType == 4) sUrl = "../../fceform/ereport/ebrun.htm?file=/ebfile/"+djsn+"&unitid="+unitId;&#13;&#10;	if(fromType == 5) {&#13;&#10;		var link ="?";&#13;&#10;		if(sUrl.indexOf('?') != -1) link = "&";&#13;&#10;		sUrl = sUrl+link+"unitid="+unitId;&#13;&#10;	}&#13;&#10;	if(fromType == 6) sUrl = "../../fceform/common/djframe.htm?djsn="+djsn+sUrl+paramUrl+"&unitid="+unitId;&#13;&#10;	txtMoreUrl.value = sUrl;&#13;&#10;	txtMainUrl.value = sUrl;&#13;&#10;}&#13;&#10;function uf_save()&#13;&#10;{&#13;&#10;	var str="TA[";&#13;&#10;	var str1="]]";&#13;&#10;	var xml="<type><![CDA"+str+txtType.value+str1+"></type>";&#13;&#10;      xml+="<moduleid><![CDA"+str+txtMouldId.value + str1+"></moduleid>";&#13;&#10;      xml+="<nodecode><![CDA"+str+txtMouldId.value +str1+"></nodecode>";&#13;&#10;      xml+="<title><![CDA"+str+txtTitle.value +str1+"></title>";&#13;&#10;      xml+="<moretype><![CDA"+str+txtMoreType.value + str1+"></moretype>";&#13;&#10;      xml+="<moreurl><![CDA"+str+txtMoreUrl.value +str1+"></moreurl>";&#13;&#10;      xml+="<settingtype><![CDA"+str+txtSetType.value + str1+"></settingtype>";&#13;&#10;      xml+="<setting><![CDA"+str+txtSetType.value + str1+"></setting>";&#13;&#10;      xml+="<mainurl><![CDA"+str+txtMainUrl.value + str1+"></mainurl>";&#13;&#10;      xml+="<sign><![CDA"+str+txtSign.value + str1+"></sign>";&#13;&#10;      xml+="<elsetype1><![CDA"+str+txtElseType1.value + str1+"></elsetype1>";&#13;&#10;      xml+="<elseurl1><![CDA"+str+txtElseUrl1.value + str1+"></elseurl1>";&#13;&#10;      xml+="<elsetype2><![CDA"+str+txtElseType2.value + str1+"></elsetype2>";&#13;&#10;      xml+="<elseurl2><![CDA"+str+txtElseUrl2.value + str1+"></elseurl2>";&#13;&#10;      xml+="<winHeight><![CDA"+str+winHeight.value + str1+"></winHeight>";&#13;&#10;      xml=escape(xml);&#13;&#10;      var xmlSql="<update tableName='fcq_unit'>"+"<set>modulexml='"+xml+"'</set> <where>  id = '"+txtMouldId.value+"'</where> </update>";&#13;&#10;      &#13;&#10;	doSaveData(xmlSql,function (){alert("保存成功");$eform('关闭窗口');});	&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_isInt(){&#13;&#10;	var ret = IsInt($id('winHeight').value);&#13;&#10;	if(!ret)	 {&#13;&#10;		alert("请输入整数");&#13;&#10;		$id('winHeight').value = "";&#13;&#10;	}&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" envType="电脑" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore dj_sn="zk_desktop" type="ZK" caption="设置生成工作台信息" window="有模式窗口" posleft postop poswidth="655" posheight="310" isfile="是" billtaborder="<root><taborder>cmdSave</taborder><taborder>txtType</taborder><taborder>txtSet</taborder><taborder>txtMainUrl</taborder><taborder>txtElseType1</taborder><taborder>txtElseType2</taborder><taborder>txtElseUrl1</taborder><taborder>txtElseUrl2</taborder><taborder>txtSign</taborder><taborder>txtMoreType</taborder><taborder>txtSetType</taborder><taborder>txtFromName</taborder><taborder>winHeight</taborder><taborder>txtMouldId</taborder><taborder>txtTitle</taborder><taborder>txtMoreUrl</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:15;radio:0;listbox:0;textarea:1;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:1;div:0;DsMain_field:0;a:0;button:1;text:16;hr:0;checkboxlist:0;radiolist:0;dropdownlist:3;grid:0;dataset:2;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0" contxml="<root><label><id>label1</id><id>label2</id><id>label3</id><id>label4</id><id>label6</id><id>label7</id><id>label8</id><id>label9</id><id>label10</id><id>label11</id><id>label12</id><id>label13</id><id>label14</id><id>label15</id></label><textarea><id>txtMoreUrl</id></textarea><button><id>cmdSave</id></button><text><id>txtType</id><id>txtSet</id><id>txtMainUrl</id><id>txtElseType1</id><id>txtElseType2</id><id>txtElseUrl1</id><id>txtElseUrl2</id><id>txtSign</id><id>txtMoreType</id><id>txtSetType</id><id>txtFromName</id><id>winHeight</id><id>txtMouldId</id><id>txtTitle</id></text></root>" center="  " BLONopen="uf_open()" BLONopenBefore BLONclose userType alertType="1" isCheckPermit="否" unselectable="on" toolbar="不带工具栏"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 88px; LEFT: 401px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">其它类型2</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 64px; LEFT: 401px" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">其它类型1</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 40px; LEFT: 401px" id=label3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">标记</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 227px; LEFT: 13px" id=label4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">主要url</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 58px; HEIGHT: 19px; TOP: 15px; LEFT: 13px" id=label6 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">功能点</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 40px; LEFT: 13px" id=label7 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">表单名</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 62px; LEFT: 13px" id=label8 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">类型</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 111px; LEFT: 402px" id=label9 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">设置类型</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 88px; LEFT: 13px" id=label10 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">更多类型</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 182px; LEFT: 13px" id=label11 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">其它url1</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 202px; LEFT: 13px" id=label12 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">其它url2</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 137px; LEFT: 13px" id=label13 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">更多url</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 15px; LEFT: 401px" id=label14 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">设置</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 286px; HEIGHT: 20px; TOP: 57px; LEFT: 78px" id=txtType onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=30 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 164px; HEIGHT: 20px; TOP: 10px; LEFT: 471px" id=txtSet onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=21 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 559px; HEIGHT: 20px; TOP: 225px; LEFT: 78px" id=txtMainUrl onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() readOnly size=99 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 164px; HEIGHT: 20px; TOP: 58px; LEFT: 471px" id=txtElseType1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 164px; HEIGHT: 20px; TOP: 82px; LEFT: 471px" id=txtElseType2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=21 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 559px; HEIGHT: 20px; TOP: 176px; LEFT: 78px" id=txtElseUrl1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=100 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 559px; HEIGHT: 20px; TOP: 200px; LEFT: 78px" id=txtElseUrl2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=98 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 164px; HEIGHT: 20px; TOP: 34px; LEFT: 471px" id=txtSign onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=21 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 286px; HEIGHT: 20px; TOP: 82px; LEFT: 78px" id=txtMoreType onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=30 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 164px; HEIGHT: 20px; TOP: 106px; LEFT: 471px" id=txtSetType onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=21 controltype="text"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 251px; LEFT: 564px" id=cmdSave onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("uf_save()")' dropstyle="否"></BUTTON><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 286px; HEIGHT: 20px; TOP: 33px; LEFT: 78px" id=txtFromName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() readOnly size=46 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 287px; HEIGHT: 20px; TOP: 107px; LEFT: 78px" id=winHeight onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() onchange='bill_onclick("uf_isInt()")' size=50 controltype="text"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 109px; LEFT: 14px" id=label15 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">窗口高度</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 188px; DISPLAY: none; HEIGHT: 20px; TOP: 10px; LEFT: 77px" id=txtMouldId onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=34 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 286px; HEIGHT: 20px; TOP: 9px; LEFT: 78px" id=txtTitle onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() readOnly size=50 controltype="text"><TEXTAREA onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 557px; HEIGHT: 39px; TOP: 133px; LEFT: 78px" id=txtMoreUrl onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() cols=111 readOnly controltype="textarea" value="textarea1" induce="否"></TEXTAREA></DIV>