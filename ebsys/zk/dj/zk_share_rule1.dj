<script>&#13;&#10;function uf_click(){&#13;&#10;	var sql1="select shareid,tbname, permit,case  permit WHEN 2 THEN '全局只读' ELSE '全局读写'  END as permit1,fromId,fromId as fromName,toId, toId as toName  from fcq_sharerule  where  tbname='"+listbox1.value+"'"&#13;&#10;	dataset1.Open(sql1);&#13;&#10;	dataset1.Field('tbname').Value=listbox1.value;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true toolbar="自定义工具栏" envType="电脑" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" isCheckPermit="否" alertType="1" userType userToolbar="<tr rowstate=&quot;add&quot;><td>addrow</td><td>增加行</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>griddel</td><td>删除行且删除记录</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>save</td><td>提交数据成功后提示</td><td></td><td>$eform('提交数据成功后提示')</td><td></td><td></td><td></td><td></td><td></td></tr>" contxml="<root><listbox><id>listbox1</id></listbox><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:1;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:1;tab:0;div:0;DsMain_field:0;a:0;button:10;text:2;hr:0;checkboxlist:0;radiolist:0;dropdownlist:1;grid:1;dataset:3;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" billtaborder="<root><taborder>grid1</taborder><taborder>listbox1</taborder></root>" BLONclose BLONopenBefore BLONopen window="当前窗口" posheight poswidth postop posleft center="  " isfile="是" type="ZK" caption="共享规则" dj_sn="zk_share_rule1" unselectable="on"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 800px; HEIGHT: 591px; TOP: 0px; LEFT: 242px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" blRowNo="否" hideHscroll="auto" canselect="是" autoheight="是" autowidth="是" autoappend="否" readonly="否" SetRowHeight="是" hideVscroll="auto" bodyrowheight="-1" bodyrows="-1" visible="是" dataset="dataset1" cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" iscrosstab="否" usertitle="是" titlerowheight="22" titlerows="1" usertitlehtml crosstabtitle crosstabdatatype="0" crosstabsumtype="0" crosstabformat rowtitle coltitle crosstabsql><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 158px; LEFT: 1064px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idparam="SHA" async="否" savetable="FCQ_SHARERULE" isSubGrid="否" issubds="否" submitno="1" submittype="1" isaddemptyrec="否" opensortno="1" pubpara="否" controltype="dataset" idtype="1" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll queryTableName="FCQ_SHARERULE" datasourceName formatxml="<root><tr rowstate=&quot;add&quot;><td>shareid</td><td>id</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>tbname</td><td>表名</td><td>字符</td><td>50</td><td></td><td>变量默认值</td><td>listbox1.value</td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>toId</td><td>共享的用户id</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>fromName</td><td>用户名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%u7528%u6237%u540D%20%20%7C%3C/format%3E%3Csql1%3Eselect%20username%20as%20fromName%2C%20userid%20as%20fromId%20from%20fcq_user%20where%20deleteMark%20%21%3D%201%3C/sql1%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E2%3C/check%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>toName</td><td>共享用户名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%u7528%u6237%u540D%20%20%7C%3C/format%3E%3Csql1%3Eselect%20username%20as%20toName%2Cuserid%20as%20toId%20%20from%20fcq_user%20where%20deleteMark%20%21%3D%201%3C/sql1%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E2%3C/check%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>permit</td><td>权限</td><td>整数</td><td>4</td><td></td><td>数据项</td><td>1</td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>100</td><td></td><td></td><td>$valid('整数');</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>permit1</td><td>权限</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td>全局只读</td><td></td><td>选%3Ccode%3E%3Cformat%3E%u6743%u9650%7C%3C/format%3E%3Csql1%3Eselect%20name%20as%20permit1%20%2Ccode%20as%20permit%20%20from%20FC_DATADICT%20where%20typename%3D%27%u6743%u9650%u7C7B%u578B%u540D%u79F0%27%20and%20name%20%21%3D%20%27%u79C1%u6709%27%3C/sql1%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E2%3C/check%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>105</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>fromId</td><td>用户id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" masterdsfield masterds subdsfield opensql fieldtrans="<root><field><name>toName</name><trans></trans><rtrans></rtrans><sql>select%20userid%2Cusername%20from%20fcq_user</sql></field><field><name>fromName</name><trans></trans><rtrans></rtrans><sql>select%20userid%2Cusername%20from%20fcq_user</sql></field></root>" saveastable><SELECT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 245px; HEIGHT: 612px; TOP: 0px; LEFT: 4px" id=listbox1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() onchange='bill_onclick("doSubmitData();uf_click()")' size=8 async="否" controltype="listbox" datasourceName tempvalue temptext AutoSizeXml="<record id ='listbox1'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>0</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" check="2" sql="select tbname ,tbchnname   from fc_entity "></SELECT></DIV>