<script>/*function uf_open(){&#13;&#10;	//TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;}&#13;&#10;var sId = "";//组织机构id&#13;&#10;function uf_clickTree(nodeValue){&#13;&#10;	sId = nodeValue;&#13;&#10;	var sWhere = "where  fcq_org.deleteMark=0 and fcq_org.sParent='"+nodeValue+"'order by fcq_org.sortNo";&#13;&#10;	if(IsSpace(nodeValue) == true)  sWhere = "where  fcq_org.deleteMark=0 and fcq_employee.employeeid is null order by fcq_org.sortNo";&#13;&#10;    DsMain.Open("select EMPLOYEEID,EMPLOYEECODE,EMPLOYEENAME,bz,fcq_employee.sortNo from FCQ_EMPLOYEE inner join fcq_org on fcq_employee.employeeId=fcq_org.sPersonId "+sWhere);&#13;&#10;	DsMain.Field('sId').Value = nodeValue;&#13;&#10;}&#13;&#10; &#13;&#10;function uf_deleteMark(){&#13;&#10;	if(IsSpace(grid1.Row) == false){&#13;&#10;		var ret = window.confirm("确定删除当前行信息吗？");	&#13;&#10;		if(ret == false) return;&#13;&#10;		var deptid = DsMain.Field('deptid').Value;&#13;&#10;		var xmlSql= "<update tableName='fcq_employee'><set>deleteMark=1</set><where> employeeid='"+DsMain.Field('employeeid').Value+"' </where> </update>"&#13;&#10;		doSaveData(xmlSql,function (){	&#13;&#10;				alert("删除成功");&#13;&#10;				DsMain.Open("select employeename,employeecode,bz from fcq_employee inner join fcq_org on fcq_employee.employeeId=fcq_org.sPersonId  where  fcq_org.deleteMark=0 and fcq_org.sParent='"+sId +"'order by fcq_employee.sortNo");&#13;&#10;				//tree1.FindNode(tree1,"code",deptid);&#13;&#10;			}); &#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function uf_moveUp(isUp){&#13;&#10;	if(IsSpace(grid1.Row) == false){&#13;&#10;		if(isUp == true){&#13;&#10;			GridChangeRowSort(true,grid1);&#13;&#10;		}else{&#13;&#10;			GridChangeRowSort(false,grid1);&#13;&#10;		}&#13;&#10;	}&#13;&#10;}&#13;&#10;function uf_add(){&#13;&#10;	//if(IsSpace(DsMain.Field('sId').Value)) {alert("先选择组织结构");return}&#13;&#10;	var sRet = DjOpen('fcq_employeeCard',DsMain,'新增') ;&#13;&#10;	if(!IsSpace(sRet)){&#13;&#10;		DsMain.Open("select employeename,employeecode,bz from fcq_employee inner join fcq_org on fcq_employee.employeeId=fcq_org.sPersonId  where  fcq_org.deleteMark=0 and fcq_org.sParent='"+sId +"'order by fcq_employee.sortNo");&#13;&#10;		DsMain.Field('sId').Value =sId;&#13;&#10;		//tree1.FindNode(tree1,"code",sRet);	&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_updata(){&#13;&#10;	if(IsSpace(grid1.Row) == false){&#13;&#10;		var sRet = DjOpen('fcq_employeeCard',DsMain,'修改') ;&#13;&#10;		if(!IsSpace(sRet)){&#13;&#10;	        DsMain.Open("select employeename,employeecode,bz from fcq_employee inner join fcq_org on fcq_employee.employeeId=fcq_org.sPersonId  where  fcq_org.deleteMark=0 and fcq_org.sParent='"+MainDs.Field('sId').Value+"'order by fcq_org.sortNo");&#13;&#10;	        DsMain.Field('sId').Value =sId;&#13;&#10;	        //tree1.FindNode(tree1,"code",sRet);&#13;&#10;	    }&#13;&#10;	}	&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_queryEmployee(){&#13;&#10;	DjOpen('fcq_employee_correspond');&#13;&#10;}*/&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" unselectable="on" OtherSave="否" codeheader="CSM" entertype="展现" keyfield="sid" runsave idtype="1" userToolbar="<tr rowstate=&quot;add&quot;><td>add</td><td>新增</td><td></td><td>$eform('打开窗口新增记录')</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>edit</td><td>修改保存</td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>del</td><td>删除</td><td></td><td>$eform('标记方式删除')</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>query</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>upmove</td><td>上移</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>downmove</td><td>下移</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>" contxml="<root><grid><id>grid1</id></grid><dataset><id>DsMain</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:6;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:3;div:0;DsMain_field:0;a:1;button:10;text:5;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:1;dataset:2;spin:0;excel:0;tree:5;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen="fcpubdata.cardWinUrl='fcq_employee1'" window="当前窗口" posheight poswidth postop posleft center="  " isfile="是" type="ZK" caption="职员信息" dj_sn="fcq_employee" billtaborder="<root><taborder>grid1</taborder></root>" BLONresizeBefore BLONresizeAfter allBrowser="否" useHelp envType="电脑" toolbar="自定义工具栏" mkbh><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 600px; HEIGHT: 260px; TOP: 1px; LEFT: 1px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" iscrosstab="否" usertitle="否" titlerowheight titlerows usertitlehtml crosstabtitle crosstabdatatype="0" crosstabsumtype="0" crosstabformat rowtitle coltitle crosstabsql controltype="grid" blRowNo="否" hideHscroll="否" visible="是" bodyrows="-1" bodyrowheight="-1" hideVscroll="否" SetRowHeight="是" readonly="否" autoappend="否" autowidth="是" autoheight="是" canselect="是" dataset="DsMain" csstext1="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #ffffff" csstext2="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #c0c0c0"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 225px; LEFT: 683px" id=DsMain onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" queryTableName="FCQ_EMPLOYEE" formatxml="<root><tr rowstate=&quot;edit&quot;><td>EMPLOYEEID</td><td>职员ID</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>EMPLOYEECODE</td><td>编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>120</td><td></td><td></td><td></td><td></td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>EMPLOYEENAME</td><td>姓名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>150</td><td></td><td></td><td></td><td></td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>BIRTHDAY</td><td>出生日期</td><td>字符</td><td>19</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>CULTURE</td><td>学历</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>CARDID</td><td>身份证</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>bz</td><td>备注</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>300</td><td></td><td></td><td></td><td></td><td></td><td>$eform('打开窗口修改记录')</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SORTNO</td><td>SORTNO</td><td>整数</td><td>4</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>DELETEMARK</td><td>DELETEMARK</td><td>整数</td><td>4</td><td></td><td>数据项</td><td>0</td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" opensql="select FCQ_EMPLOYEE.* from FCQ_EMPLOYEE where deletemark=0 order by sortNo" subdsfield masterds masterdsfield datasourceName AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen fieldtrans="<root><field><name>DEPTID</name><trans></trans><rtrans></rtrans><sql></sql></field><field><name>deptname</name><trans></trans><rtrans></rtrans><sql>select%20deptid%2Cdeptname%20from%20fcq_dept</sql></field><field><name>DEPTNAME</name><trans></trans><rtrans></rtrans><sql></sql></field><field><name>sName</name><trans></trans><rtrans></rtrans><sql></sql></field></root>" savetable="FCQ_EMPLOYEE" idparam="EMP" issubds="否" submitno="1" submittype="1" isaddemptyrec="否" saveastable pubpara="否" opensortno="1" isSubGrid="否" async="否"></DIV>