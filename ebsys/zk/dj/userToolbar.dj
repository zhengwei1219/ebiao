<script>function uf_open(){&#13;&#10;	e_PropWinOnload();&#13;&#10;	var sData = fcpubdata.obj;&#13;&#10;	if(IsSpace(sData) == false){&#13;&#10;		var dsAll = dataset1.xml;&#13;&#10;		var pos = dsAll.indexOf("<set><pages>");&#13;&#10;		sData = "<root>"+sData+dsAll.substring(pos,dsAll.length);&#13;&#10;		dataset1.OpenXmlData(sData);&#13;&#10;	}&#13;&#10;	var sXml="";&#13;&#10;	var sHtml0 = "<code><format> ID | 提示信息 </format><sql1></sql1><xml>"&#13;&#10;	var sHtml1 = "<code><format> ID | 提示信息! </format><sql1></sql1><xml>"&#13;&#10;	var sHtml2 = "</xml><blninput>是</blninput><blnempty>否</blnempty><check>2</check></code>"&#13;&#10;	for(var key in fcpubdata.toolbarButtons){&#13;&#10;		sXml += "<tr><td>"+key+"</td><td>"+fcpubdata.toolbarButtons[key][2]+"</td></tr>";&#13;&#10;	&#13;&#10;	}&#13;&#10;	&#13;&#10;	grid1.tab.children[0].children[1].cz  = sHtml0+sXml+sHtml2 ;&#13;&#10;	grid1.tab.children[0].children[2].cz  = sHtml1+sXml+sHtml2 ;&#13;&#10;	grid1.cz.FieldNameList="ID,msg";&#13;&#10;		&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;	if(dataset1.RecordCount>0){&#13;&#10;		window.returnValue = dataset1.RecordData;	&#13;&#10;	}&#13;&#10;	window.close();&#13;&#10;}&#13;&#10;function uf_sel_function(){&#13;&#10;	SelFunction(grid1.cz);&#13;&#10;	dataset1.Field('code').Value=grid1.cz.value;&#13;&#10;	dataset1.fset_cont();	&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js" unselectable="on" toolbar="不带工具栏" dj_sn="userToolbar" type="ZK" caption="自定义工具栏" mkbh codeheader keyfield window="有模式窗口" entertype="修改" posleft postop poswidth="670" posheight="400" isfile="是" OtherSave="否" idtype="1" billtaborder="<root><taborder>grid1</taborder><taborder>button4</taborder><taborder>button5</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder><taborder>cmdAdd</taborder><taborder>cmdDel</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:7;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" contxml="<root><button><id>button4</id><id>button5</id><id>cmdOk</id><id>cmdClose</id><id>cmdAdd</id><id>cmdDel</id></button><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset></root>" center="居中" BLONopen="uf_open()" BLONopenBefore BLONclose userType><IMG id=grid1 style="LEFT: 10px; WIDTH: 587px; POSITION: absolute; TOP: 31px; HEIGHT: 279px" src="../../fceform/images/ef_designer_webgrid.gif" csstext2="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #c0c0c0" csstext1="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #ffffff" crosstabsql cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" coltitle rowtitle crosstabformat crosstabsumtype="0" crosstabdatatype="0" crosstabtitle iscrosstab="否" usertitlehtml titlerows usertitle="否" titlerowheight readonly="否" autoappend="否" autowidth="是" autoheight="是" canselect="是" dataset="dataset1" visible="是" controltype="grid" SetRowHeight="是" hideHscroll="否" hideVscroll="否" blRowNo="否" bodyrowheight="-1" bodyrows="-1"><IMG id=dataset1 style="LEFT: 635px; WIDTH: 39px; POSITION: absolute; TOP: 93px; HEIGHT: 47px" src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" formatxml="<root><tr rowstate=&quot;add&quot;><td>ID</td><td>控件ID</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td>$valid('字段值不重复');</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>msg</td><td>提示信息</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>text</td><td>按钮上文字</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>code</td><td>调用代码</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Conclickopen%3Euf_sel_function%28%29%3C/onclickopen%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>230</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>width</td><td>宽度</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>50</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" Like="否" pubpara="否" iscreatetable="否" opensql chnname AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1" temptable="TMP_IMGDATASET2" saveastable isSubGrid="否" isaddemptyrec="否" submittype="1" submitno="1" savetable idparam issubds="否" subdsfield masterds masterdsfield async="否" datasourceName><BUTTON onmove=move() oncontrolselect=controlselect() id=button4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 316px; WIDTH: 61px; POSITION: absolute; TOP: 1px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("GridChangeRow(true,grid1)")'>上 移</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 383px; WIDTH: 61px; POSITION: absolute; TOP: 1px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("GridChangeRow(false,grid1)")'>下 移</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdOk onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 158px; WIDTH: 69px; FONT-FAMILY: ; POSITION: absolute; TOP: 2px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" fc_onclick='bill_onclick("uf_ok()")' dropstyle="否"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdClose onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 230px; WIDTH: 69px; FONT-FAMILY: ; POSITION: absolute; TOP: 2px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" fc_onclick='bill_onclick("CloseBill()")' dropstyle="否"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdAdd onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 14px; WIDTH: 69px; FONT-FAMILY: ; POSITION: absolute; TOP: 2px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" fc_onclick='bill_onclick("dataset1.Append()")' dropstyle="否"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdDel onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 86px; WIDTH: 69px; FONT-FAMILY: ; POSITION: absolute; TOP: 2px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" fc_onclick='bill_onclick("dataset1.Delete()")' dropstyle="否"></BUTTON></DIV>