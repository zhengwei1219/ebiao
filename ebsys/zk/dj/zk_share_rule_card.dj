<script>var key1 = "";&#13;&#10;var keyName1 = "";&#13;&#10;&#13;&#10;&#13;&#10;function uf_Open(){&#13;&#10;	new Eform.SysForm().setButtonImage();&#13;&#10;	dataset2.Field('typeId').Value = fcpubdata.obj.Field('typeId').Value;&#13;&#10;	$id('manageType').innerText = fcpubdata.obj.Field('chnname').Value;&#13;&#10;	var sql = "select tbname1,tbname2,selFunc1 ,selFunc2 ,sql1,sql2 from  fcq_relation_dict_type where typeId='"+fcpubdata.obj.Field('typeId').Value+"'";&#13;&#10;	var xmlRet1 = SelectSql(sql, 1, 1);&#13;&#10;    var oXml1 = SetDom(xmlRet1);&#13;&#10;    if (oXml1.documentElement == null) {&#13;&#10;        alert(xmlRet1);&#13;&#10;        return;&#13;&#10;    }&#13;&#10;	if (oXml1.documentElement.childNodes.length < 1) return;&#13;&#10;   &#13;&#10;    var selFunc1 = oXml1.documentElement.childNodes[0].childNodes[2].text;&#13;&#10;    var selFunc2 = oXml1.documentElement.childNodes[0].childNodes[3].text;&#13;&#10;    var sql1 = oXml1.documentElement.childNodes[0].childNodes[4].text;&#13;&#10;    var sql2 = oXml1.documentElement.childNodes[0].childNodes[5].text;&#13;&#10;    if(IsSpace(selFunc1) == false)	{//函数和sql语句的规则，有函数先用函数，没函数就用sql&#13;&#10;    	selFunc1 = unescape(selFunc1);&#13;&#10;		$id('dropTable1').onclickopen="bill_onclick(\""+selFunc1+"\")";&#13;&#10;    } else{&#13;&#10;    	sql1 = unescape(sql1);&#13;&#10;    	dropTable1.sql1 = sql1;&#13;&#10;    } &#13;&#10;    &#13;&#10;    if(IsSpace(selFunc2) == false)	{&#13;&#10;    	selFunc2 = unescape(selFunc2);&#13;&#10;    	$id('dropTable2').onclickopen="bill_onclick(\""+selFunc2+"\")";&#13;&#10;    } else{&#13;&#10;    	sql2 = unescape(sql2);&#13;&#10;    	dropTable2.sql1 = sql2;&#13;&#10;    } &#13;&#10;}&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true toolbar="自定义工具栏" BLONresizeBefore BLONresizeAfter allBrowser="是" useHelp isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen="uf_Open()" center="居中" userToolbar='<tr rowstate="add"><td>ok</td><td>提交数据成功后刷新上一窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>close</td><td>关闭窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>' contxml="<root><label><id>label2</id><id>label3</id><id>manageType</id><id>label6</id><id>label8</id><id>label9</id></label><text><id>text7</id></text><dropdownlist><id>dropTable1</id><id>dropTable2</id><id>dropdownlist8</id><id>dropdownlist9</id></dropdownlist><dataset><id>dataset2</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:9;radio:0;listbox:2;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:12;text:7;hr:0;checkboxlist:0;radiolist:0;dropdownlist:9;grid:2;dataset:3;spin:0;excel:0;tree:1;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" billtaborder="<root><taborder>dropTable1</taborder><taborder>dropTable2</taborder><taborder>dropdownlist8</taborder><taborder>dropdownlist9</taborder><taborder>text7</taborder></root>" isfile="是" posheight="300" poswidth="410" postop posleft window="有模式窗口" caption="关系词典卡片表" type="ZK" dj_sn="zk_share_rule_card" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" envType="电脑" runParams unselectable="on"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 58px; HEIGHT: 17px; TOP: 25px; LEFT: 12px" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">来自于</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 125px; LEFT: 359px" id=dataset2 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" datasourceName controltype="dataset" async="否" fieldtrans="<root><field><name>keyName2</name><trans></trans><rtrans></rtrans><sql></sql></field></root>" savetable="FCQ_SHARERULE" issubds="否" submitno="1" submittype="2" isaddemptyrec="否" pubpara="否" opensortno="1" isSubGrid="否" saveastable idparam="SHA" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll masterdsfield masterds subdsfield formatxml='<root><tr rowstate="add"><td>shareid</td><td>共享id</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>typeId</td><td>分类id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>tbname</td><td>表名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>tbchnname</td><td>表中文名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%26amp%3Bnbsp%3B%26amp%3Bnbsp%3B%u8868%u540D%26amp%3Bnbsp%3B%26amp%3Bnbsp%3B%26amp%3Bnbsp%3B%7C%26amp%3Bnbsp%3B%26amp%3Bnbsp%3B%u8868%u4E2D%u6587%u540D%26amp%3Bnbsp%3B%26amp%3Bnbsp%3B%7C%3C/format%3E%3Csql1%3Eselect%20tbname%2Ctbchnname%20from%20fc_entity%3C/sql1%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E2%3C/check%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fromId</td><td>共享着</td><td>字符</td><td>2048</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fromName</td><td>共享名</td><td>字符</td><td>2000</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>toId</td><td>共享给id</td><td>字符</td><td>2045</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>toName</td><td>共享给</td><td>字符</td><td>2000</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>permit</td><td>权限</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td>2</td><td></td><td>是</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>permit1</td><td>权限类型</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td>全局只读</td><td></td><td>选%3Ccode%3E%3Cformat%3E%u6743%u9650%u7C7B%u578B%7C%3C/format%3E%3Csql1%3Eselect%20%20name%20as%20permit1%20%2Ccode%20as%20permit%20%20from%20FC_DATADICT%20where%20typename%3D%27%u6743%u9650%u7C7B%u578B%u540D%u79F0%27%20and%20name%20%21%3D%20%27%u79C1%u6709%27%3C/sql1%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E2%3C/check%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' opensql="select shareid,tbname,typeId,fromId,toId,permit from fcq_sharerule where typeId=':{fcpubdata.obj.Field('typeId').Value}:' and shareid=':{fcpubdata.obj.Field('shareid').Value}:'"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 69px; HEIGHT: 22px; TOP: 50px; LEFT: 12px" id=label3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">共享到</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 196px; HEIGHT: 15px; TOP: 4px; LEFT: 72px" id=manageType onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否"></LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 317px; HEIGHT: 16px; TOP: 23px; LEFT: 68px; ButtonWidth: 10" id=dropTable1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" datasourceName xml sql controltype="dropdownlist" temptext tempvalue check="2" format visible="是" dataset="dataset2" china="共享名" field="fromName" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 317px; HEIGHT: 16px; TOP: 47px; LEFT: 68px; ButtonWidth: 10" id=dropTable2 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" datasourceName xml sql controltype="dropdownlist" temptext tempvalue check="2" format visible="是" dataset="dataset2" china="共享给" field="toName" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 7px; LEFT: 12px" id=label6 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">关系类型</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 69px; HEIGHT: 22px; TOP: 97px; LEFT: 12px" id=label8 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">权限类型</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 317px; HEIGHT: 16px; TOP: 94px; LEFT: 68px; ButtonWidth: 10" id=dropdownlist8 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" datasourceName xml sql="select  name as permit1 ,code as permit  from FC_DATADICT where typename='权限类型名称' and name != '私有'" controltype="dropdownlist" temptext tempvalue check="2" format=" 权限类型 |" visible="是" dataset="dataset2" china="权限类型" field="permit1" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 69px; HEIGHT: 22px; TOP: 73px; LEFT: 12px" id=label9 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">表名</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 317px; HEIGHT: 16px; TOP: 70px; LEFT: 68px; ButtonWidth: 10" id=dropdownlist9 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" datasourceName xml sql="select tbname,tbchnname from fc_entity where permit=1 or permit=2" controltype="dropdownlist" temptext tempvalue check="2" format="  表名  | 表中文名 !" visible="是" dataset="dataset2" china="表中文名" field="tbchnname" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 180px; DISPLAY: none; HEIGHT: 20px; TOP: 138px; LEFT: 83px" id=text7 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value=分类id size=32 controltype="text" dataset="dataset2" china="分类id" field="typeId"></DIV>