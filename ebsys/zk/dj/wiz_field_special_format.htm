<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
        <STYLE>
	        @import url(../../fceform/css/dj.css); 
	    </STYLE>
		<STYLE> .userData{behavior:url(#default#userData);}</STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>var objNav = new Object();
objNav.prevPage = "wiz_field_first";
objNav.nextPage = "wiz_field_finish";
objNav.saveConfig = saveConfig;
objNav.isOk = true;

function uf_open() {
	PropWinOpenConfig(objNav); 
	SetTextValue(objNav.config.showFormat, $id("showFormat"));
    uf_displayControl();

}
//保存配置信息,由工具栏来调用
function saveConfig() {  
    var sValue = new Eapi.Str().trim($id("showFormat").value);
    if (IsSpace(sValue) == false) {
    	objNav.config.showFormat = sValue;
    } 
    if (PropWinSaveConfig(objNav))	{
    	objNav.isOk = false;
    	return;	
   }
      uf_fieldLen();
}

function uf_fieldLen() {
    if (subType.value == "手机号") {
        objNav.config.len = 11;
    } else if (subType.value == "邮编") {
        objNav.config.len = 6;
    } else if (subType.value == "身份证号") {
        objNav.config.len = 18;
    } else if(subType.value == "自定义格式"){
        objNav.config.len = showFormat.value.length;
    }else{
    	objNav.config.len = len.value;
    }
}


function uf_displayControl() {
   /* if (subType.value == "自定义格式") {
        showFormat.style.display = "block";
        labShowFormat.style.display = "block";
        len.style.display = "none";
        labLen.style.display = "none";
    } else if (subType.value == "手机号" || subType.value == "邮编" || subType.value == "身份证号") {
        len.style.display = "none";
        labLen.style.display = "none";
        showFormat.style.display = "none";
        labShowFormat.style.display = "none";
    } else {
    	showFormat.style.display = "none";
        labShowFormat.style.display = "none";
        len.style.display = "block";
        labLen.style.display = "block";
    }*/
    var sDisplay1 = "block";
    var sDisplay2 = "none";
    if (subType.value == "自定义格式") {
       sDisplay1 = "none";
       sDisplay2 = "block";
    } else if (subType.value == "手机号" || subType.value == "邮编" || subType.value == "身份证号") {
        sDisplay1 = "none";
        sDisplay2 = "none";
    } 
    len.style.display = sDisplay1;
    labLen.style.display = sDisplay1;
    showFormat.style.display = sDisplay2;
    labShowFormat.style.display = sDisplay2;
}</script><script src='../../fceform/js/fcopendj.js'></script><script defer src='../../fceform/js/fcsavedj.js'></script><script src='../../fceform/js/fcselfuse.js'></script><script src='../../fceform/js/fcbasecont.js'></script><script defer src='../../fceform/js/fcother.js'></script><script defer src='../../fceform/js/selectdate.js'></script><script src='../../fceform/js/fczk.js'></script><script src='../../fceform/../fceformext/js/userfunc.js'></script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../../fceform/htc/dataset.htc)",0);</script><script src='../../fceform/js/fcdataset.js'></script>
<DIV id=SKbillsheet toolbar="不带工具栏" dj_sn="wiz_field_special_format" type="ZK" caption="wiz_field_name" codeheader keyfield window="有模式窗口" entertype="展现" posleft postop poswidth="420" posheight="430" isfile="是" OtherSave="否" idtype="1" billtaborder="<root><taborder>subType</taborder><taborder>showFormat</taborder><taborder>isNull</taborder><taborder>isRepeat</taborder><taborder>cmdActionSet</taborder><taborder>fdname</taborder><taborder>fdchnname</taborder><taborder>helpText</taborder><taborder>readTrans</taborder><taborder>saveTrans</taborder><taborder>defaultExp</taborder><taborder>len</taborder><taborder>cmdDropDown2</taborder><taborder>cmdDropDown3</taborder><taborder>button1</taborder><taborder>button2</taborder><taborder>cmdDropDown4</taborder><taborder>tbname</taborder><taborder>queryExp</taborder><taborder>cmdDropDown1</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:2;label:20;radio:0;listbox:0;textarea:2;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:2;tab:0;div:0;DsMain_field:0;a:0;button:1;text:8;hr:0;checkboxlist:0;radiolist:0;dropdownlist:3;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0" contxml="<root><checkbox><id>isNull</id><id>isRepeat</id></checkbox><label><id>labShowFormat</id><id>labFdname</id><id>labFdchnname</id><id>labHelpText</id><id>labReadTrans</id><id>labSaveTrans</id><id>labDefaultExp</id><id>labLen</id><id>lblTitle</id><id>labTbname</id><id>label21</id></label><radio><id>subType</id></radio><a><id>showCont</id><id>showTd</id></a><button><id>cmdActionSet</id><id>cmdDropDown2</id><id>cmdDropDown3</id><id>button1</id><id>button2</id><id>cmdDropDown4</id><id>cmdDropDown1</id></button><text><id>showFormat</id><id>fdname</id><id>fdchnname</id><id>helpText</id><id>readTrans</id><id>saveTrans</id><id>defaultExp</id><id>len</id><id>tbname</id><id>queryExp</id></text><dataset><id>permitDs</id></dataset></root>" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;fczk.js&#13;&#10;~userfunc.js" AutoResizeXml BLONopenBefore BLONclose BLONopen="uf_open();new Eform.SysForm().setButtonImage() " center="居中" alertType="1" isCheckPermit="否" userType runsave>&nbsp; 
<FIELDSET style="POSITION: absolute; WIDTH: 271px; HEIGHT: 61px; TOP: 189px; LEFT: 91px" id=subType onmovestart=moveStart() contentEditable=false controltype="radio" value="电话" tempvalue="电话&#13;&#10;邮编&#13;&#10;身份证号&#13;&#10;QQ号&#13;&#10;手机号&#13;&#10;自定义格式" temptext="电话&#13;&#10;邮编&#13;&#10;身份证号&#13;&#10;QQ号&#13;&#10;手机号&#13;&#10;自定义格式" onclick='bill_onclick("uf_displayControl()")' legend="选择格式" aspect="横向"><LEGEND>选择格式</LEGEND><INPUT id=RGsubType1 onclick=subType.value=RGsubType[0].value; value=电话 CHECKED type=radio name=RGsubType text="电话"><SPAN>电话</SPAN>&nbsp;<INPUT id=RGsubType2 onclick=subType.value=RGsubType[1].value; value=邮编 type=radio name=RGsubType text="邮编"><SPAN>邮编</SPAN>&nbsp;<INPUT id=RGsubType3 onclick=subType.value=RGsubType[2].value; value=身份证号 type=radio name=RGsubType text="身份证号"><SPAN>身份证号</SPAN>&nbsp;<INPUT id=RGsubType4 onclick=subType.value=RGsubType[3].value; value=QQ号 type=radio name=RGsubType text="QQ号"><SPAN>QQ号</SPAN>&nbsp;<INPUT id=RGsubType5 onclick=subType.value=RGsubType[4].value; value=手机号 type=radio name=RGsubType text="手机号"><SPAN>手机号</SPAN>&nbsp;<INPUT id=RGsubType6 onclick=subType.value=RGsubType[5].value; value=自定义格式 type=radio name=RGsubType text="自定义格式"><SPAN>自定义格式</SPAN>&nbsp;</FIELDSET> <LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 257px; LEFT: 17px" id=labShowFormat onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">显示格式</LABEL><INPUT style="POSITION: absolute; WIDTH: 271px; HEIGHT: 19px; TOP: 254px; LEFT: 91px" id=showFormat onmovestart=moveStart() value={YYYY}{MM}-{000000} size=43 controltype="text"><LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 26px; LEFT: 17px" id=labFdname onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">字段名</LABEL><INPUT style="POSITION: absolute; WIDTH: 271px; HEIGHT: 20px; TOP: 23px; LEFT: 91px" id=fdname onmovestart=moveStart() value=field1 size=48 controltype="text" onblur="bill_onexit(&quot;$valid('不能为空','字段名称不能为空!');&quot;)"><LABEL style="POSITION: absolute; WIDTH: 76px; HEIGHT: 15px; TOP: 52px; LEFT: 17px" id=labFdchnname onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">字段中文名</LABEL><INPUT style="POSITION: absolute; WIDTH: 271px; HEIGHT: 20px; TOP: 46px; LEFT: 91px" id=fdchnname onmovestart=moveStart() value=字段1 size=48 controltype="text"><LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 73px; LEFT: 17px" id=labHelpText onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">帮助文本</LABEL><INPUT style="POSITION: absolute; WIDTH: 271px; HEIGHT: 20px; TOP: 69px; LEFT: 91px" id=helpText onmovestart=moveStart() value=字段1 size=48 controltype="text"><LABEL style="POSITION: absolute; WIDTH: 70px; HEIGHT: 16px; TOP: 98px; LEFT: 17px" id=labReadTrans onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">读出时转换</LABEL><INPUT style="POSITION: absolute; WIDTH: 255px; HEIGHT: 20px; TOP: 92px; LEFT: 91px" id=readTrans onmovestart=moveStart() size=41 controltype="text"><LABEL style="POSITION: absolute; WIDTH: 70px; HEIGHT: 16px; TOP: 121px; LEFT: 17px" id=labSaveTrans onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">保存前转换</LABEL><INPUT style="POSITION: absolute; WIDTH: 255px; HEIGHT: 20px; TOP: 115px; LEFT: 91px" id=saveTrans onmovestart=moveStart() size=41 controltype="text"><BUTTON style="POSITION: absolute; WIDTH: 75px; DISPLAY: none; HEIGHT: 25px; TOP: 154px; LEFT: 287px" id=cmdActionSet onmovestart=moveStart() controltype="button" onclick='bill_onclick("eformWizFieldPowerSet()")' dropstyle="否">权限设置</BUTTON><LABEL style="POSITION: absolute; WIDTH: 70px; HEIGHT: 16px; TOP: 280px; LEFT: 17px" id=labDefaultExp onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">公式默认值</LABEL><INPUT style="POSITION: absolute; WIDTH: 255px; HEIGHT: 20px; TOP: 276px; LEFT: 91px" id=defaultExp onmovestart=moveStart() size=42 controltype="text"> 
<DIV style="POSITION: absolute; WIDTH: 78px; HEIGHT: 20px; TOP: 323px; LEFT: 88px" id=isNull onmovestart=moveStart() noWrap NotBg="否" controltype="checkbox" value="0" truevalue="1" falsevalue="0"><INPUT oncontrolselect=controlselectcancel() CHECKED type=checkbox><SPAN>此字段中总是需要一个值来保存记录</SPAN></DIV>
<DIV style="POSITION: absolute; WIDTH: 78px; HEIGHT: 20px; TOP: 342px; LEFT: 88px" id=isRepeat onmovestart=moveStart() noWrap NotBg="否" controltype="checkbox" value="0" truevalue="1" falsevalue="0"><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>不允许重复值</SPAN></DIV><INPUT style="POSITION: absolute; WIDTH: 83px; HEIGHT: 20px; TOP: 363px; LEFT: 91px" id=len onmovestart=moveStart() value=50 size=14 controltype="text" onblur="bill_onexit(&quot;$valid('正整数');&quot;)"><LABEL style="POSITION: absolute; WIDTH: 55px; HEIGHT: 14px; TOP: 367px; LEFT: 17px" id=labLen onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">字段长度</LABEL><BUTTON style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; BACKGROUND-COLOR: #c0c0c0; WIDTH: 17px; HEIGHT: 20px; BORDER-TOP: 0px; TOP: 92px; BORDER-RIGHT: 0px; LEFT: 345px" id=cmdDropDown2 onmovestart=moveStart() controltype="button" onclick='bill_onclick("PropWinFx(readTrans,tbname.value)")' dropstyle="否"></BUTTON><BUTTON style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; BACKGROUND-COLOR: #c0c0c0; WIDTH: 17px; HEIGHT: 20px; BORDER-TOP: 0px; TOP: 115px; BORDER-RIGHT: 0px; LEFT: 345px" id=cmdDropDown3 onmovestart=moveStart() controltype="button" onclick='bill_onclick("PropWinFx(saveTrans,tbname.value)")' dropstyle="否"></BUTTON><A style="POSITION: absolute; WIDTH: 188px; HEIGHT: 15px; TOP: 142px; LEFT: 91px" id=showCont onmovestart=moveStart() onclick="DjOpen('../../fceform/common/djframe.htm?djsn=zk_style_prop&amp;djtype=ZK&amp;type=2',objNav.config)" href="javascript:void(0)" target=_self controltype="a" href1>设置本字段显示控件的样式</A><A style="POSITION: absolute; WIDTH: 188px; HEIGHT: 15px; TOP: 166px; LEFT: 91px" id=showTd onmovestart=moveStart() onclick="DjOpen('../../fceform/common/djframe.htm?djsn=zk_style_prop&amp;djtype=ZK&amp;type=3',objNav.config)" href="javascript:void(0)" target=_self controltype="a" href1>设置本字段所在单元格的样式</A><BUTTON style="POSITION: absolute; WIDTH: 75px; HEIGHT: 23px; TOP: 137px; LEFT: 288px" id=button1 onmovestart=moveStart() controltype="button" onclick="bill_onclick(&quot;propWinFieldPermit(permitDs,'valueHide')&quot;)">隐藏设置</BUTTON><BUTTON style="POSITION: absolute; WIDTH: 75px; HEIGHT: 23px; TOP: 162px; LEFT: 288px" id=button2 onmovestart=moveStart() controltype="button" onclick="bill_onclick(&quot;propWinFieldPermit(permitDs,'valueDisable')&quot;)">只读设置</BUTTON><?xml:namespace prefix = fc /><fc:dataset id=permitDs idtype="1" controltype="dataset" format="<fields><field><fieldname>valueDisable</fieldname><datatype>字符</datatype><displaylabel>新建字段</displaylabel><size>3000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>valueHide</fieldname><datatype>字符</datatype><displaylabel>新建字段</displaylabel><size>3000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>expDisable</fieldname><datatype>字符</datatype><displaylabel>新建字段</displaylabel><size>3000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>expHide</fieldname><datatype>字符</datatype><displaylabel>新建字段</displaylabel><size>3000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onSetText='bill_ondatasetsettext("<dsid><valueDisable></valueDisable><valueHide></valueHide><expDisable></expDisable><expHide></expHide></dsid>")' onGetText='bill_ondatasetgettext("<dsid><valueDisable></valueDisable><valueHide></valueHide><expDisable></expDisable><expHide></expHide></dsid>")' onValid='bill_ondatasetvalid("<dsid><valueDisable></valueDisable><valueHide></valueHide><expDisable></expDisable><expHide></expHide></dsid>")' issubds="否" submitno="1" submittype="2" isaddemptyrec="否" opensortno="1" pubpara="否" isSubGrid="否" async="否"></fc:dataset><LABEL style="POSITION: absolute; WIDTH: 114px; DISPLAY: none; FONT-FAMILY: 楷体_GB2312; HEIGHT: 22px; COLOR: #000080; FONT-SIZE: 14pt; TOP: 7px; FONT-WEIGHT: bold; TEXT-DECORATION: underline; LEFT: 9px" id=lblTitle onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">字段信息</LABEL><LABEL style="POSITION: absolute; WIDTH: 356px; HEIGHT: 15px; TOP: 6px; LEFT: 5px" id=labTbname onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">表名</LABEL><INPUT style="POSITION: absolute; WIDTH: 271px; DISPLAY: none; HEIGHT: 20px; TOP: 1px; LEFT: 90px" id=tbname disabled onmovestart=moveStart() size=48 controltype="text"><LABEL style="POSITION: absolute; WIDTH: 70px; HEIGHT: 16px; TOP: 299px; LEFT: 17px" id=label21 onmovestart=moveStart() NotBg="否" controltype="label" inputTag="否">作查询条件时的默认值</LABEL><INPUT style="POSITION: absolute; WIDTH: 255px; HEIGHT: 20px; TOP: 301px; LEFT: 91px" id=queryExp onmovestart=moveStart() size=42 controltype="text"><BUTTON style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; BACKGROUND-COLOR: #c0c0c0; WIDTH: 17px; HEIGHT: 20px; BORDER-TOP: 0px; TOP: 301px; BORDER-RIGHT: 0px; LEFT: 345px" id=cmdDropDown4 onmovestart=moveStart() controltype="button" onclick='bill_onclick("PropWinFx(queryExp,tbname.value)")' dropstyle="否"></BUTTON><BUTTON style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; BACKGROUND-COLOR: #c0c0c0; WIDTH: 17px; BACKGROUND-REPEAT: no-repeat; HEIGHT: 20px; BORDER-TOP: 0px; TOP: 276px; BORDER-RIGHT: 0px; LEFT: 345px" id=cmdDropDown1 onmovestart=moveStart() controltype="button" onclick='bill_onclick("PropWinFx(defaultExp,tbname.value)")' dropstyle="是"></BUTTON></DIV><script></script></body></html>