<script>function uf_initPage()&#13;&#10;{&#13;&#10;	e_PropWinOnload();&#13;&#10;	var sHtml=GetBillType()&#13;&#10;	uf_Search();	&#13;&#10;}&#13;&#10;&#13;&#10;/**&#13;&#10; * 查询&#13;&#10;**/&#13;&#10;function uf_Search()&#13;&#10;{&#13;&#10;	var sql = "select sName,userType from fc_reportfile where 1=1 ";&#13;&#10;&#13;&#10;	var strName = $id("txtName").value;&#13;&#10;	var sUserType = $id("userType").value;&#13;&#10;	&#13;&#10;	if (strName != "" && strName != "请选择")&#13;&#10;		sql = sql + " and sName like '%"+strName+"%'";&#13;&#10;	&#13;&#10;	if(IsSpace(sUserType) == false)&#13;&#10;		sql = sql + " and userType = '"+ sUserType +"'";&#13;&#10;	sql+="and not   exists (select   1   from   fcq_unit  where  FC_REPORTFILE.sName=fcq_unit.fromName)";&#13;&#10;	dataset1.Open(sql);&#13;&#10;}&#13;&#10;&#13;&#10;/**&#13;&#10; * 保存功能点&#13;&#10;**/&#13;&#10;function uf_save()&#13;&#10;{&#13;&#10;	var djType="";&#13;&#10;	var fromName="";&#13;&#10;	var sName="";&#13;&#10;	var url="";&#13;&#10;	var sRet="";&#13;&#10;	var paramUrl = "";//参数字段 &#13;&#10;	var envType = "电脑";&#13;&#10;	var code =radio1.value;&#13;&#10;	var type = 3;&#13;&#10;	if(code == 2) {//code=1 是基本报表运行，2是电脑表单运行报表，3是手机表单运行报表&#13;&#10;		type = 2;&#13;&#10;		fromName = "ebr_db";&#13;&#10;	}else if(code == 3){&#13;&#10;		type = 2;&#13;&#10;		envType = "手机";&#13;&#10;		fromName = "ebr_m_db";&#13;&#10;	}&#13;&#10;	var l=dataset1.oDom.documentElement.childNodes.length-1;&#13;&#10;	for(var i=0;i<l;i++)&#13;&#10;	{&#13;&#10;		if(dataset1.oDom.documentElement.childNodes(i).childNodes(0).text == "是")&#13;&#10;		{&#13;&#10;			sName = dataset1.oDom.documentElement.childNodes(i).childNodes(1).text;&#13;&#10;			if(code == 1) fromName = escape(sName);&#13;&#10;			/*var sIndex=fromName.lastIndexOf('/');&#13;&#10;			if(sIndex == -1){&#13;&#10;				sName=fromName;&#13;&#10;			}else{&#13;&#10;				sName=fromName.substr(sIndex+1)&#13;&#10;			}*/&#13;&#10;			djTyp=dataset1.oDom.documentElement.childNodes(i).childNodes(2).text;&#13;&#10;			var maxCode=getMaxNo('UNI');&#13;&#10;			var sortNo=getMaxIntNo('SOR')&#13;&#10;			if(code != 1){&#13;&#10;				paramUrl = RepXml("&name=")+escape(sName);&#13;&#10;			}&#13;&#10;			sRet ="<insert tableName='FCQ_UNIT'> <names>id,name,fromName,fromtype,sortNo,deleteMark,paramUrl,genTime,envType</names> <values>'"+maxCode+"','"+sName+"','"+fromName+"',"+type+","+sortNo+" ,0 ,'"+paramUrl+"','"+ GetTime()+"','"+envType+"'</values> </insert>";&#13;&#10;		}&#13;&#10;	}&#13;&#10;	if(IsSpace(sRet) == true){&#13;&#10;		alert("没有选中的报表")&#13;&#10;	}else{&#13;&#10;		doSaveData(sRet,function(){alert("保存成功");uf_Search();});&#13;&#10;	}&#13;&#10;	&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" toolbar="不带工具栏" unselectable="on" isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen="uf_initPage();" center="  " contxml="<root><label><id>label1</id><id>Label2</id></label><radio><id>radio1</id></radio><button><id>cmdQuery</id><id>button5</id></button><text><id>txtName</id></text><dropdownlist><id>userType</id></dropdownlist><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:3;radio:1;listbox:0;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:1;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:8;text:2;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:1;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" billtaborder="<root><taborder>cmdQuery</taborder><taborder>txtName</taborder><taborder>grid1</taborder><taborder>userType</taborder><taborder>button5</taborder><taborder>radio1</taborder></root>" isfile="是" posheight poswidth postop posleft window="当前窗口" caption="库中的报表转换成功能点" type="ZK" dj_sn="zk_bank_report_switch_unit_dot" idtype="1" runsave OtherSave="否" entertype="修改" keyfield codeheader="BBB" mkbh><DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 9px; LEFT: 12px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" inputTag="否" value="label1" NotBg="否">报表名称：</DIV><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 135px; HEIGHT: 20px; TOP: 4px; LEFT: 83px" id=txtName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=24 controltype="text" CustomAttr>&nbsp;<BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 23px; TOP: 4px; LEFT: 472px" id=cmdQuery onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("uf_Search();")' controltype="button" dropstyle="否"></BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 765px; HEIGHT: 399px; TOP: 124px; LEFT: 5px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dataset1" crosstabsql coltitle rowtitle crosstabformat crosstabsumtype crosstabdatatype crosstabtitle usertitlehtml titlerows titlerowheight usertitle="否" iscrosstab="否" rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" bodyrows="-1" bodyrowheight="-1" hideVscroll="否" hideHscroll="否" SetRowHeight="是" visible="是" readonly="否" autoappend="否" autowidth="是" autoheight="是" canselect="是" autosize="否"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 59px; LEFT: 714px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" datasourceName formatxml='<root><tr rowstate="add"><td>sel</td><td>选</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>勾</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>30</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>sName</td><td>报表名</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>260</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>userType</td><td>用户分类</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' opensql subdsfield masterds masterdsfield AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen async="否" idparam isSubGrid="否" saveastable="fc_billzl" pubpara="否" isaddemptyrec="否" submittype="1" submitno="1" savetable issubds="否" opensortno="1" idtype="1" iscreatetable="否" Like="否" chnname temptable="TMP_DATASET1"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 133px; HEIGHT: 20px; TOP: 4px; LEFT: 318px; ButtonWidth: 10" id=userType onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" controltype="dropdownlist" datasourceName tempvalue temptext check="2" sql="select distinct userType from fc_billzl " format visible="是" FieldNameList isTreeNewSql="0" isShowTree="0" multiselect="否" addrow="否" blnempty="否" blninput="是" xml><SPAN style="POSITION: absolute; WIDTH: 61px; DISPLAY: block; HEIGHT: 10px; FONT-SIZE: 12px; TOP: 9px; LEFT: 255px" id=Label2 controltype="label" inputTag="否" align="Left">报表分类：</SPAN><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 161px; HEIGHT: 25px; TOP: 3px; LEFT: 547px" id=button5 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() fc_onclick='bill_onclick("uf_save();uf_Search();")' controltype="button" dropstyle="否">选中的报表转换成功能点</BUTTON> 
<FIELDSET onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 452px; HEIGHT: 82px; TOP: 34px; LEFT: 82px" id=radio1 onmovestart=moveStart() onmoveend=moveEnd() contentEditable=false onresizestart=resizeStart() controltype="radio" tempvalue="1&#13;&#10;2&#13;&#10;3" temptext="fceform/ereport/ebrun.htm?&#13;&#10;fceform/common/djframe.htm?djsn=ebr_file&amp;amp;djtype=ST&#13;&#10;fceform/common/djframe.htm?djsn=ebr_m_file&amp;amp;djtype=ST" value="1" aspect="纵向" legend="选择报表转化成功能点运行的路径"><LEGEND>选择报表转化成功能点运行的路径</LEGEND><INPUT id=RGradio11 onclick=radio1.value=RGradio1[0].value; value=1 CHECKED type=radio name=RGradio1 text="fceform/ereport/ebrun.htm?"><SPAN>fceform/ereport/ebrun.htm?</SPAN>&nbsp;<BR><INPUT id=RGradio12 onclick=radio1.value=RGradio1[1].value; value=2 type=radio name=RGradio1 text="fceform/common/djframe.htm?djsn=ebr_file&amp;djtype=ST"><SPAN>fceform/common/djframe.htm?djsn=ebr_file&amp;djtype=ST</SPAN>&nbsp;<BR><INPUT id=RGradio13 onclick=radio1.value=RGradio1[2].value; value=3 type=radio name=RGradio1 text="fceform/common/djframe.htm?djsn=ebr_m_file&amp;djtype=ST"><SPAN>fceform/common/djframe.htm?djsn=ebr_m_file&amp;djtype=ST</SPAN>&nbsp;</FIELDSET></DIV>