<script>function uf_roleAccredit(){&#13;&#10;	var orgId = Global.selectedItem;&#13;&#10;	if(IsSpace(orgId)){alert("先选择组织名");return;}&#13;&#10;	var oXml = SetDom(SelectSql("select key2 from fcq_relation_Dict where typeId='Org_Profile' and key1='"+orgId + "'",1,-1));&#13;&#10;    if (oXml.documentElement == null) {&#13;&#10;        alert(xmlRet);&#13;&#10;        return;&#13;&#10;    }&#13;&#10;    var key2="";//数据词典表的key2字段&#13;&#10;    for(var i=0;i<oXml.documentElement.childNodes.length-1;i++){&#13;&#10;    	var douhao=",";&#13;&#10;    	if(i==oXml.documentElement.childNodes.length-2) douhao = "";&#13;&#10;    	key2 += oXml.documentElement.childNodes[i].childNodes[0].text + douhao;&#13;&#10;    }&#13;&#10;    alert(oXml.xml)&#13;&#10;    alert(key2)&#13;&#10;    $id('roleName').value = key2;&#13;&#10;    dataset4.Field('profileId').Value = key2;&#13;&#10;	CommonSelect({&#13;&#10;		isgrid : 1, //可选项, 弹出窗口中是否有grid控件,其值=0或1&#13;&#10;		ismultisel : 1,//可选项, 是否多选,其值=0或1.&#13;&#10;		obj : roleName, //必选项, 用于修改的前一窗口控件对象,包含是grid对象.&#13;&#10;		gridcoltitle :["角色名称"],&#13;&#10;		hidefields : "profileId",&#13;&#10;		selectedvalue: dataset4.Field('profileId').Value, //可选项,多选时,已选中的值,会用已选中的值来初始化弹出的选择输入窗口.&#13;&#10;		sql:  "select profileId,profileName from fcq_profile where deletemark=0 "    //必选项, 弹出窗口的显示数据用的SQL语句.&#13;&#10;	})	&#13;&#10;	var roleArr = $id('roleName').value.split(',');&#13;&#10;	var xmlSql="";&#13;&#10;	for(var j=0; j<roleArr.length;j++){&#13;&#10;		xmlSql += "<delete tableName='fcq_relation_Dict'><where>  key1= '"+ orgId +"' and  key2='"+roleArr[j]+"' and typeId ='Org_Profile' </where></delete>";&#13;&#10;		xmlSql += "<insert tableName='fcq_relation_Dict'><names> key1,key2,typeId  </names><values>'"+ orgId + "','" + roleArr[j] + "','Org_Profile' </values></insert>";	&#13;&#10;	}&#13;&#10;	alert(xmlSql)&#13;&#10;	doSaveData(xmlSql,function(){alert("角色授权成功");});&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" toolbar="不带工具栏" contxml="<root><text><id>roleName</id></text><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset><tree><id>tree1</id></tree></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:1;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen window="当前窗口" posheight poswidth postop posleft center="  " isfile="是" type="ZK" caption="角色授权" dj_sn="zk_role_" billtaborder="<root><taborder>roleName</taborder><taborder>grid1</taborder></root>" envType="电脑" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore runParams><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 316px; DISPLAY: block; HEIGHT: 610px; BORDER-TOP: 1px solid; TOP: 0px; BORDER-RIGHT: 1px solid; LEFT: 6px" id=tree1 class=control-border-color onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" controltype="tree" opentb="_self" isAll="是" ischecked="否" sourcetype="3" roottext clicknode=" &#13;&#10;uf_clickTree(Global.selectedItem.code)&#13;&#10; &#13;&#10;&#13;&#10; " sql2="select  sID,sParent,sName,sID,sOrgKindId from FCQ_org  where deleteMark <> 1 order by sortNo" xml='<TreeNode id="1" text="treeItem" roottarget="_self" rootaction=""  target="_self" title="treeItem"  icon=""  check="undefined" code=""><TreeNode id="2" text="增加节点"  target="_self" title="增加节点"  icon=""  check="undefined" code=""/></TreeNode>' datasourceName sql AutoSizeXml="<record id ='tree1'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>5</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 759px; HEIGHT: 464px; TOP: 4px; LEFT: 326px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" blRowNo="否" hideHscroll="否" visible="是" bodyrows="-1" bodyrowheight="-1" hideVscroll="否" SetRowHeight="是" readonly="否" autoappend="否" autowidth="否" autoheight="否" canselect="是" dataset="dataset1" titlerowheight titlerows usertitlehtml usertitle iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 402px; HEIGHT: 20px; TOP: 395px; LEFT: 380px" id=roleName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value=PROFILEID size=73 controltype="text" dataset="dataset1" field="PROFILEID" china="PROFILEID"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 381px; LEFT: 774px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" datasourceName savetable issubds="否" submitno="1" submittype="1" isaddemptyrec="否" saveastable pubpara="否" opensortno="1" isSubGrid="否" async="否" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll idparam queryTableName="FCQ_PROFILE" formatxml='<root><tr rowstate="add"><td>PROFILEID</td><td>PROFILEID</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>PROFILENAME</td><td>PROFILENAME</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' masterdsfield masterds subdsfield opensql></DIV>