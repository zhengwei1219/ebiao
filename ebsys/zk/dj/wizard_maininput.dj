<script>var objNav=new Object();&#13;&#10;objNav.prevPage = "wizard_first" ;&#13;&#10;objNav.nextPage = "wizard_inputstyle" ;&#13;&#10;objNav.saveConfig = saveConfig;&#13;&#10;objNav.isOk = true;&#13;&#10;&#13;&#10;function uf_open() {&#13;&#10;	objNav.config = parent.parent.toolbar.WizardConfig ;&#13;&#10;	PropWinOnload(); &#13;&#10;    //SetButtonImage(cmdUp,"../../fceform/images/ef_run_button_up.gif") ;&#13;&#10;    //SetButtonImage(cmdDown,"../../fceform/images/ef_run_button_down.gif") ;&#13;&#10;	new Eapi.DbStru().listTables($id("cboSelPkTab"));&#13;&#10;	&#13;&#10;    SetTextValue(objNav.config.mainTableName,$id("cboSelPkTab"));&#13;&#10;    SetTextValue(objNav.config.mainKeyField,$id("cboSelPkField"));&#13;&#10;    if(IsSpace(objNav.config.mainFieldsHtml1) == false) $id("lstSelField1").outerHTML = objNav.config.mainFieldsHtml1;&#13;&#10;    if(IsSpace(objNav.config.mainFieldsHtml2) == false) $id("lstSelField2").outerHTML = objNav.config.mainFieldsHtml2;&#13;&#10;    &#13;&#10;    parent.parent.toolbar.execScript("new Eform.Wizard().disabledButton();")&#13;&#10;    &#13;&#10;}&#13;&#10;//保存配置信息,由工具栏来调用&#13;&#10;function saveConfig(){&#13;&#10;	var sValue = new Eapi.Str().trim($id("cboSelPkTab").value);&#13;&#10;	if(IsSpace(sValue)){&#13;&#10;		alert("主表名不能为空!");&#13;&#10;		objNav.isOk = false;&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	objNav.config.mainTableName = sValue;&#13;&#10;	var sValue = new Eapi.Str().trim($id("cboSelPkField").value);&#13;&#10;	if(IsSpace(sValue)){&#13;&#10;		alert("主键不能为空!");&#13;&#10;		objNav.isOk = false;&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	objNav.config.mainKeyField = sValue;&#13;&#10;	if($id("lstSelField2").options.length == 0 ){&#13;&#10;		alert("已选字段不能为空!");&#13;&#10;		objNav.isOk = false;&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	objNav.config.mainFields = new Eapi.Str().comboToStr($id("lstSelField2"));&#13;&#10;	objNav.config.mainFieldsHtml1=$id("lstSelField1").outerHTML;&#13;&#10;	objNav.config.mainFieldsHtml2=$id("lstSelField2").outerHTML;&#13;&#10;	objNav.isOk = true;&#13;&#10;	&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//选择主表名称,在lstSelField2控件中列出选择主表中的字段&#13;&#10;function uf_SelTabValue() {&#13;&#10;	lstSelField1.options.length = 0;&#13;&#10;	lstSelField2.options.length = 0;&#13;&#10;	var tableName = cboSelPkTab.value;&#13;&#10;	new Eapi.DbStru().listFields(tableName,lstSelField2);&#13;&#10;	new Eapi.DbStru().listFields(tableName,cboSelPkField);&#13;&#10;	//找主键字段&#13;&#10;	SelectSql("select fdname,fdtype from FC_ENTITYSUB where tbname='"+tableName+"' and type = 'ID字段'",1,1,&#13;&#10;		function (result){&#13;&#10;			var ret = result.value;&#13;&#10;			var oXml = SetDom(ret);&#13;&#10;			if(oXml.documentElement == null) return;&#13;&#10;			if(oXml.documentElement.childNodes.length==0) return;&#13;&#10;			cboSelPkField.value = oXml.documentElement.childNodes(0).childNodes(0).text;	&#13;&#10;			objNav.config.mainKeyFieldDataType = oXml.documentElement.childNodes(0).childNodes(1).text;&#13;&#10;		});&#13;&#10;}&#13;&#10;//objLeft向右objRight增加值,&#13;&#10;function add(objLeft,objRight,sValue){	&#13;&#10;	for (var i=objLeft.length-1;i>=0;i--){&#13;&#10;		if (objLeft.options(i).selected){&#13;&#10;			var oOpt=document.createElement("option")&#13;&#10;			oOpt.text=objLeft.options(i).text&#13;&#10;			oOpt.value=objLeft.options(i).value&#13;&#10;			if (objLeft.id==sValue){&#13;&#10;				objRight.add(oOpt)&#13;&#10;			}&#13;&#10;			&#13;&#10;			objLeft.remove(i)&#13;&#10;		&#13;&#10;		}&#13;&#10;	}&#13;&#10;}&#13;&#10;//把objLeft中所有的值给objRight控件&#13;&#10;function uf_addlist(objLeft,objRight,sValue) {	&#13;&#10;	for (var i=objLeft.length-1;i>=0;i--){&#13;&#10;		var oOpt=document.createElement("option")&#13;&#10;		oOpt.text=objLeft.options(i).text&#13;&#10;		oOpt.value=objLeft.options(i).value&#13;&#10;		if (objLeft.id==sValue){&#13;&#10;			objRight.add(oOpt)&#13;&#10;		}&#13;&#10;		objLeft.remove(i)&#13;&#10;	}&#13;&#10;}&#13;&#10;//objRight向右objLeft增加值,&#13;&#10;function Sellist(objLeft,objRight,sValue) {&#13;&#10;	for (var i=objRight.length-1;i>=0;i--){&#13;&#10;		if (objRight.options(i).selected){&#13;&#10;			var oOpt=document.createElement("option")&#13;&#10;			oOpt.text=objRight.options(i).text&#13;&#10;			oOpt.value=objRight.options(i).value&#13;&#10;			if (objRight.id == sValue){&#13;&#10;				objLeft.add(oOpt)&#13;&#10;			}&#13;&#10;			objRight.remove(i)&#13;&#10;		}&#13;&#10;	}	&#13;&#10;}&#13;&#10;//把objRight中所有的值给objLeft控件&#13;&#10;function uf_del(objLeft,objRight,sValue) {&#13;&#10;	for (var i=objRight.length-1;i>=0;i--){&#13;&#10;		var oOpt=document.createElement("option")&#13;&#10;		oOpt.text=objRight.options(i).text&#13;&#10;		oOpt.value=objRight.options(i).value&#13;&#10;		if (objRight.id==sValue){&#13;&#10;			objLeft.add(oOpt)&#13;&#10;		}&#13;&#10;&#13;&#10;		objRight.remove(i)&#13;&#10;	}&#13;&#10;		&#13;&#10;}&#13;&#10;//listbox控件的值上移&#13;&#10;function uf_up(obj){&#13;&#10;     for (var i=obj.length-1;i>0;i--){&#13;&#10;      if (obj.options(i).selected == true){&#13;&#10;        var s&#13;&#10;        var d&#13;&#10;        s=obj.options(i-1).text ;&#13;&#10;        d=obj.options(i-1).value ;&#13;&#10;        obj.options(i-1).text=obj.options(i).text ;&#13;&#10;        obj.options(i-1).value=obj.options(i).value ;&#13;&#10;        obj.options(i).text=s ;&#13;&#10;        obj.options(i).value=d ;&#13;&#10;        obj.options(i).selected=false ;&#13;&#10;        obj.options(i-1).selected=true ;&#13;&#10;        break ;&#13;&#10;      }&#13;&#10;    }&#13;&#10;}&#13;&#10;//listbox控件的值下移&#13;&#10;function uf_down(obj){&#13;&#10;   for (var i=0;i<obj.length-1;i++){&#13;&#10;    if (obj.options(i).selected == true){&#13;&#10;      var s="";&#13;&#10;      var d="";&#13;&#10;      s=obj.options(i+1).text ;&#13;&#10;      d=obj.options(i+1).value ;&#13;&#10;      obj.options(i+1).text=obj.options(i).text ;&#13;&#10;      obj.options(i+1).value=obj.options(i).value ;&#13;&#10;      obj.options(i).text=s ;&#13;&#10;      obj.options(i).value=d ;&#13;&#10;	  obj.options(i).selected=false&#13;&#10;     obj.options(i+1).selected=true ;&#13;&#10;      break ;&#13;&#10;    }&#13;&#10;  }&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" mkbh toolbar="不带工具栏" dj_sn="wizard_maininput" type="ZK" caption="wizard_maininput" codeheader="BBB" keyfield BLONopen="uf_open()" window="当前窗口" entertype="修改" posleft postop poswidth posheight isfile="是" OtherSave="否" idtype="1" controlno="SKButton:0;SKDBedit:0;checkbox:1;label:1;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:1;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" contxml="<root><label><id>Label1</id><id>Label2</id><id>Label8</id><id>Label7</id></label><listbox><id>lstSelField1</id><id>lstSelField2</id></listbox><button><id>cmd_CheckAllRight</id><id>cmdCheckRight</id><id>cmd_CheckLeft</id><id>cmd_CheckAllLeft</id><id>cmdSmallUp</id><id>cmdSmallDown</id></button><dropdownlist><id>cboSelPkTab</id><id>cboSelPkField</id></dropdownlist></root>" unselectable="on" center="  " BLONopenBefore BLONclose runsave billtaborder="<root><taborder>lstSelField1</taborder><taborder>lstSelField2</taborder><taborder>cmd_CheckAllRight</taborder><taborder>cmdCheckRight</taborder><taborder>cmd_CheckLeft</taborder><taborder>cmd_CheckAllLeft</taborder><taborder>cmdSmallUp</taborder><taborder>cmdSmallDown</taborder><taborder>cboSelPkTab</taborder><taborder>cboSelPkField</taborder></root>"><DIV onmove=move() oncontrolselect=controlselect() id=Label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 9px; WIDTH: 24px; FONT-FAMILY: ; POSITION: absolute; TOP: 31px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="Label1">主表名：</DIV><IMG id=cboSelPkTab onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="FONT-SIZE: 12px; LEFT: 52px; WIDTH: 143px; FONT-FAMILY: ; POSITION: absolute; TOP: 27px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; backgroundColor1: #ffffff; textalign: left; ButtonWidth: 10" onmovestart=moveStart() src="../../fceform/images/ef_designer_fccode.gif" controltype="dropdownlist" type="divbox" datasourceName sql check="1" visible="是" format="英 文 表 名| 中 文 表 名" sql2 xml sql1 multiselect="否" addrow="否" blnempty="否" blninput="是" onselchange='bill_onclick("uf_SelTabValue()")' temptext tempvalue> 
<DIV onmove=move() oncontrolselect=controlselect() id=Label2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 241px; WIDTH: 18px; FONT-FAMILY: ; POSITION: absolute; TOP: 31px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="Label2">主键：</DIV><IMG id=cboSelPkField onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="FONT-SIZE: 12px; LEFT: 274px; WIDTH: 159px; FONT-FAMILY: ; POSITION: absolute; TOP: 27px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; backgroundColor1: #ffffff; textalign: left; ButtonWidth: 10" onmovestart=moveStart() src="../../fceform/images/ef_designer_fccode.gif" controltype="dropdownlist" type="divbox" datasourceName sql check="1" visible="是" format="字段名称 !|  中文名称|" sql2 xml sql1 multiselect="否" addrow="否" blnempty="否" blninput="是" temptext tempvalue> 
<DIV onmove=move() oncontrolselect=controlselect() id=Label8 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 245px; WIDTH: 24px; FONT-FAMILY: ; POSITION: absolute; TOP: 60px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="Label8">已选字段</DIV>
<DIV onmove=move() oncontrolselect=controlselect() id=Label7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 8px; WIDTH: 24px; FONT-FAMILY: ; POSITION: absolute; TOP: 60px; HEIGHT: 15px" onmovestart=moveStart() noWrap controltype="label" value="Label7">待选字段</DIV><SELECT onmove=move() oncontrolselect=controlselect() id=lstSelField1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 7px; WIDTH: 188px; FONT-FAMILY: ; POSITION: absolute; TOP: 77px; HEIGHT: 230px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() multiple size=8 controltype="listbox" sql check="1" temptext tempvalue fc_ondblclick="bill_ondblclick(&quot;add(lstSelField1,lstSelField2,'lstSelField1')&quot;)" backheight="230" backwidth="188" CustomAttr></SELECT><BUTTON onmove=move() oncontrolselect=controlselect() id=cmd_CheckAllRight onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 101px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;uf_addlist(lstSelField1,lstSelField2,'lstSelField1')&quot;)">&gt;&gt;</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdCheckRight onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 131px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;add(lstSelField1,lstSelField2,'lstSelField1')&quot;)">&gt;</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmd_CheckLeft onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 177px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;Sellist(lstSelField1,lstSelField2,'lstSelField2')&quot;)">&lt;</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmd_CheckAllLeft onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 201px; WIDTH: 36px; FONT-FAMILY: ; POSITION: absolute; TOP: 207px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;uf_del(lstSelField1,lstSelField2,'lstSelField2')&quot;)">&lt;&lt;</BUTTON><SELECT onmove=move() oncontrolselect=controlselect() id=lstSelField2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 241px; WIDTH: 192px; FONT-FAMILY: ; POSITION: absolute; TOP: 77px; HEIGHT: 230px; BACKGROUND-COLOR: #ffffff" onmovestart=moveStart() multiple size=8 controltype="listbox" sql check="1" temptext tempvalue fc_ondblclick="bill_ondblclick(&quot;Sellist(lstSelField1,lstSelField2,'lstSelField2')&quot;)" backheight="230" backwidth="192" CustomAttr></SELECT><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdSmallUp onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 437px; WIDTH: 22px; BACKGROUND-REPEAT: no-repeat; FONT-FAMILY: ; POSITION: absolute; TOP: 150px; HEIGHT: 22px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_up(lstSelField2)")'></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdSmallDown onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 437px; WIDTH: 22px; FONT-FAMILY: ; POSITION: absolute; TOP: 175px; HEIGHT: 22px; BACKGROUND-COLOR: #d4d0c8" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_down(lstSelField2)")'></BUTTON></DIV>