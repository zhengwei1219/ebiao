<script>var orgId = "";&#13;&#10;function uf_open(){&#13;&#10;	TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;}&#13;&#10;function uf_clickTree(nodeValue){//单击树控件要获取单击节点和子节点，还有最大顺序号&#13;&#10;	orgId = nodeValue;&#13;&#10;	dataset1.Open("select key1,typeId,key2,key2 as profileName from fcq_relation_Dict where typeId='Org_Profile' and key1='"+ nodeValue +"'");//子节点的信息&#13;&#10;	us_ds2OPen(dataset1.Field('key2').Value);&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_add(){&#13;&#10;	dataset1.Append();&#13;&#10;	var ret = fcUserFunc.selectProfiles(grid1,'key2','profileName');&#13;&#10;	if(ret != "ok"){&#13;&#10;		 dataset1.Delete();&#13;&#10;	}else{$eform('提交数据');us_ds2OPen(dataset1.Field('key2').Value);}&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function us_ds2OPen(key2){&#13;&#10;	dataset2.Open("select key1,typeId,key2 ,key1 as profileName from fcq_relation_Dict where key2='" + key2 + "' and typeId='Pfile_Pfile'")	&#13;&#10;}&#13;&#10;&#13;&#10;function uf_del(key2){&#13;&#10;	&#13;&#10;	if(IsSpace(key2)) return;&#13;&#10;	DelGridRow(dataset1);	&#13;&#10;	us_ds2OPen();&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" unselectable="on" contxml="<root><label><id>label1</id></label><button><id>button4</id><id>button5</id></button><grid><id>grid1</id><id>grid2</id></grid><dataset><id>dataset1</id><id>dataset2</id></dataset><tree><id>tree1</id></tree></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:3;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:2;dataset:2;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen="uf_open()" window="当前窗口" posheight poswidth postop posleft center="  " isfile="是" type="ZK" caption="组织机构授权" dj_sn="zk_org_accredit" billtaborder="<root><taborder>grid1</taborder><taborder>button4</taborder><taborder>button5</taborder><taborder>grid2</taborder></root>" envType="电脑" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore runParams toolbar="不带工具栏"><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 320px; DISPLAY: block; HEIGHT: 587px; BORDER-TOP: 1px solid; TOP: 27px; BORDER-RIGHT: 1px solid; LEFT: 6px" id=tree1 class=control-border-color onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" sql AutoSizeXml="<record id ='tree1'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>5</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" clicknode=" &#13;&#10;uf_clickTree(Global.selectedItem.code)&#13;&#10; &#13;&#10;&#13;&#10; " roottext sourcetype="3" ischecked="否" isAll="是" opentb="_self" datasourceName sql2="select  sID,sParent,sName,sID,sOrgKindId from FCQ_org  where deleteMark <> 1 and sOrgKindId <> 'psm' order by sortNo" xml='<TreeNode id="1" text="treeItem" roottarget="_self" rootaction=""  target="_self" title="treeItem"  icon=""  check="undefined" code=""><TreeNode id="2" text="增加节点"  target="_self" title="增加节点"  icon=""  check="undefined" code=""/></TreeNode>' controltype="tree"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 300px; HEIGHT: 140px; TOP: 27px; LEFT: 333px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" titlerowheight titlerows usertitlehtml usertitle iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0" blRowNo="否" hideHscroll="auto" visible="是" bodyrows="-1" bodyrowheight="-1" hideVscroll="auto" SetRowHeight="是" readonly="否" autoappend="否" autowidth="否" autoheight="是" canselect="是" dataset="dataset1"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 99px; LEFT: 479px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" datasourceName controltype="dataset" queryTableName="FCQ_PROFILE" formatxml="<root><tr rowstate=&quot;add&quot;><td>PROFILENAME</td><td>授权的角色</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>288</td><td></td><td></td><td></td><td></td><td>us_ds2OPen(dataset1.Field('key2').Value)</td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>key2</td><td>角色id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>key1</td><td>组织机构id</td><td>字符</td><td>50</td><td>0</td><td>变量默认值</td><td>orgId</td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>typeId</td><td>关系词典类型</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td>Org_Profile</td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" masterdsfield masterds subdsfield opensql idparam saveastable AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="1" isaddemptyrec="否" pubpara="否" opensortno="1" isSubGrid="否" async="否" fieldtrans="<root><field><name>PROFILENAME</name><trans></trans><rtrans></rtrans><sql>select%20profileId%20as%20key2%2CprofileName%20from%20fcq_profile</sql></field></root>" savetable="FCQ_RELATION_DICT" idtype="5"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 1px; LEFT: 333px" id=button4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;uf_add(dataset1.Field('key2').Value)&quot;)">授权角色</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 1px; LEFT: 410px" id=button5 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;uf_del(dataset1.Field('key2').Value)&quot;)">删除角色</BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 300px; HEIGHT: 140px; TOP: 27px; LEFT: 643px" id=grid2 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" titlerowheight titlerows usertitlehtml usertitle iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0" blRowNo="否" hideHscroll="auto" visible="是" bodyrows="-1" bodyrowheight="-1" hideVscroll="auto" SetRowHeight="是" readonly="否" autoappend="否" autowidth="否" autoheight="是" canselect="是" dataset="dataset2"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 192px; LEFT: 825px" id=dataset2 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" datasourceName controltype="dataset" formatxml='<root><tr rowstate="add"><td>key2</td><td>角色id</td><td>字符</td><td>50</td><td>0</td><td>变量默认值</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>profileName</td><td>继承角色</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>288</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>key1</td><td>新建字段</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>typeId</td><td>新建字段</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' masterdsfield masterds subdsfield opensql idparam saveastable AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="4" isaddemptyrec="否" pubpara="否" opensortno="1" isSubGrid="否" async="否" fieldtrans="<root><field><name>profileName</name><trans></trans><rtrans></rtrans><sql>select%20profileId%20as%20key1%2CprofileName%20from%20fcq_profile</sql></field></root>" savetable idtype="5"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 117px; FONT-FAMILY: 宋体; HEIGHT: 26px; COLOR: #0000ff; FONT-SIZE: 14pt; TOP: 4px; FONT-WEIGHT: bold; LEFT: 6px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">组织机构</LABEL></DIV>