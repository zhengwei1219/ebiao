<script>document.body.onkeypress=uf_checkKey;&#13;&#10;function uf_open(){&#13;&#10;	new Eform.SysForm().setButtonImage();&#13;&#10;	new Eapi.DbStru().listTables($id("savetable"));	&#13;&#10;}&#13;&#10;function uf_ok() {&#13;&#10;	var name = dataset1.Field("name").Value;&#13;&#10;	window.returnValue = name;&#13;&#10;	window.close() ;&#13;&#10;}&#13;&#10;&#13;&#10;function uf_selectLayout(){&#13;&#10;	var findStr = "";&#13;&#10;	if(IsSpace($id('savetable').value) == true && IsSpace($id('layoutName').value) == true){&#13;&#10;			findStr = "";	 &#13;&#10;	}else if(IsSpace($id('savetable').value) == false && IsSpace($id('layoutName').value) == false){&#13;&#10;		findStr = " and (fc_layout.layoutid  In (Select distinct layoutid  From fc_layoutsub where tbname like '"+$id('savetable').value+"%') or fc_layout.name like '"+$id('layoutName').value+"%')  ";&#13;&#10;	}else if(IsSpace($id('savetable').value) == false){&#13;&#10;		findStr = " and fc_layout.layoutid  In (Select distinct layoutid  From fc_layoutsub where tbname like '"+$id('savetable').value+"%') ";&#13;&#10;	}else{&#13;&#10;		findStr = " and fc_layout.name like '"+$id('layoutName').value+"%' "; &#13;&#10;	}&#13;&#10;	var sql="select fc_layout.layoutid,name,chnname  from fc_layout where deleteMark=0 " + findStr + " ORDER BY fc_layout.layoutid desc";&#13;&#10;	dataset1.Open(sql);&#13;&#10;	if(dataset1.RecordCount == 1){&#13;&#10;		uf_ok()&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function uf_del() {&#13;&#10;	//var sqlXml = "<delete tableName='fc_layout'><where>  layoutid= '"+dataset1.Field('layoutid').Value+"'</where></delete>";&#13;&#10;	//sqlXml += "<delete tableName='fc_layoutsub'><where>  layoutid= '"+dataset1.Field('layoutid').Value+"'</where></delete>";&#13;&#10;	var sqlXml = "<update tableName='fc_layout'> <set>deleteMark=1</set><where>  layoutid= '"+dataset1.Field('layoutid').Value+"'</where></update>";&#13;&#10;	//sqlXml += "<update tableName='fc_layoutsub'> <set>deleteMark=1</set><where>  layoutid= '"+dataset1.Field('layoutid').Value+"'</where></update>";&#13;&#10;	var ret = window.confirm("确定删除当前模板吗？");&#13;&#10;           if(ret == false) return;&#13;&#10;           doSaveData(sqlXml,function(){alert("删除成功");});&#13;&#10;	uf_selectLayout();&#13;&#10;}&#13;&#10;&#13;&#10;//最大化函数&#13;&#10;function uf_maxwin(){&#13;&#10;	window.dialogLeft=0&#13;&#10;	window.dialogTop=0&#13;&#10;	window.dialogWidth= screen.availWidth+"px"&#13;&#10;	window.dialogHeight=screen.availHeight+"px"&#13;&#10;}&#13;&#10;&#13;&#10;function uf_checkKey(){&#13;&#10;	if((IsSpace($id('savetable').value) == true ) && (IsSpace($id('layoutName').value) == true )) return;&#13;&#10;	if(window.event.keyCode == 13 )	 uf_selectLayout();&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;" toolbar="不带工具栏" BLONopenBefore BLONclose center="居中" BLONopen="uf_open()" dj_sn="zk_ds_open_layout" type="ZK" caption="打开布局模版" codeheader keyfield="djid" window="有模式窗口" entertype="修改" posleft postop poswidth="333" posheight="450" isfile="是" OtherSave="否" idtype="1" billtaborder="<root><taborder>SKBILLgrid1</taborder><taborder>FCButton7</taborder><taborder>button0</taborder><taborder>cmdClose</taborder><taborder>cmdOk</taborder><taborder>savetable</taborder><taborder>button2</taborder><taborder>layoutName</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:3;radio:0;listbox:1;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:1;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:2;text:3;hr:0;checkboxlist:0;radiolist:0;dropdownlist:4;grid:0;dataset:2;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" contxml="<root><label><id>label1</id><id>label3</id></label><button><id>FCButton7</id><id>button0</id><id>cmdClose</id><id>cmdOk</id><id>button2</id></button><dropdownlist><id>savetable</id><id>layoutName</id></dropdownlist><grid><id>SKBILLgrid1</id></grid><dataset><id>dataset1</id></dataset></root>" userType alertType="1" isCheckPermit="否" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore unselectable="on" mkbh blmode="其他" BLONresize AutoResizeXml envType="电脑"><IMG style="POSITION: absolute; WIDTH: 340px; HEIGHT: 404px; TOP: 77px; LEFT: 2px" id=SKBILLgrid1 src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" canselect="是" autoheight="是" autowidth="是" autoappend="否" readonly="否" visible="是" SetRowHeight="是" hideHscroll="auto" hideVscroll="auto" blRowNo="否" bodyrowheight="-1" bodyrows="-1" dataset="dataset1" crosstabsql coltitle rowtitle crosstabformat crosstabsumtype="0" crosstabdatatype="0" crosstabtitle usertitlehtml titlerows titlerowheight usertitle="否" iscrosstab="否" rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" csstext1="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #ffffff" csstext2="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #c0c0c0"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 64px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 26px; FONT-SIZE: 12px; TOP: 0px; LEFT: 71px" id=FCButton7 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("uf_maxwin()")' dropstyle="否">最大化</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 64px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 26px; FONT-SIZE: 12px; TOP: 0px; LEFT: 4px" id=button0 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("uf_del()")' dropstyle="否">删除</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 68px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 1px; LEFT: 209px" id=cmdClose onresize=resize() onmove=move() controltype="button" fc_onclick='bill_onclick("CloseBill()")' dropstyle="否"></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 68px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 1px; LEFT: 138px" id=cmdOk onresize=resize() onmove=move() controltype="button" fc_onclick='bill_onclick("uf_ok()")' dropstyle="否"></BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 54px; LEFT: 537px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" async="否" datasourceName opensortno="1" issubds="否" savetable="fc_layout" submitno="1" submittype="1" isaddemptyrec="否" pubpara="否" saveastable isSubGrid="否" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll idparam formatxml='<root><tr rowstate="add"><td>layoutid</td><td>布局id</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>name</td><td>英文名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>130</td><td></td><td></td><td></td><td></td><td></td><td>uf_ok()</td><td></td><td></td></tr><tr rowstate="add"><td>chnname</td><td>中文名</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>173</td><td></td><td></td><td></td><td></td><td></td><td>uf_ok()</td><td></td><td></td></tr><tr rowstate="add"><td>tableStr</td><td>布局文件</td><td>文本</td><td>16</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>isRunEbiao</td><td>是否运行e表产生数据集</td><td>字符</td><td>1</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>isPrintFile</td><td>打印模板文件</td><td>字符</td><td>1</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>classTable</td><td>class名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>styleTable</td><td>table样式</td><td>字符</td><td>250</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>querytype</td><td>类型</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>isFixRowCol</td><td>是否固定行高列宽</td><td>字符</td><td>1</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>showHeight</td><td>显示高度</td><td>整数</td><td>4</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>viewType</td><td>视图类型</td><td>字符</td><td>20</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' masterdsfield masterds subdsfield opensql="select fc_layout.layoutId,name,chnName,isPrintFile,isRunEbiao,classTable,styleTable,tableStr,querytype,isFixRowCol,showHeight,viewType from fc_layout where deleteMark=0 ORDER BY fc_layout.layoutid desc &#13;&#10;&#13;&#10; " queryTableName="fc_layout"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 72px; HEIGHT: 18px; TOP: 36px; LEFT: 6px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">表名</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 188px; HEIGHT: 20px; TOP: 31px; LEFT: 78px; ButtonWidth: 10" id=savetable onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" controltype="dropdownlist" datasourceName tempvalue temptext check="1" sql visible="是" format="英文表名|中文表名" isShowTree="0" isTreeNewSql="0" FieldNameList blninput="是" blnempty="否" addrow="否" multiselect="否" xml><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 70px; HEIGHT: 30px; TOP: 58px; LEFT: 6px" id=label3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">布局模版名</LABEL><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 50px; HEIGHT: 23px; TOP: 54px; LEFT: 268px" id=button2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("uf_selectLayout()")'>查询</BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 188px; HEIGHT: 20px; TOP: 54px; LEFT: 78px; ButtonWidth: 10" id=layoutName onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" controltype="dropdownlist" datasourceName tempvalue temptext check="2" sql="select chnname,name  from fc_layout where name  like ':v_get%'" visible="是" format=" 中文名  |   英文名  !" isShowTree="0" isTreeNewSql="0" FieldNameList blninput="是" blnempty="否" addrow="否" multiselect="否" xml></DIV>