<script>function uf_selectData1(){//表格控件多字段模糊查找&#13;&#10;	CommonSelect({&#13;&#10;		width:600,&#13;&#10;		isgrid : 1, //可选项, 弹出窗口中是否有grid控件,其值=0或1.&#13;&#10;		isfind : 1, //1是模糊查找，0是没有模糊查找&#13;&#10;		findvalue : txtName.value,//模糊查找值&#13;&#10;		gridcolwidth : [160,260,140],//&#13;&#10;		gridcoltitle : ["登录名","用户名","编辑密码时间"],&#13;&#10;		obj : txtName,//必选项, 用于修改的前一窗口控件对象,包含是grid对象&#13;&#10;		hidefields : "userid",  //可选项, 以逗号分隔的隐藏字段名列表,只有在isgrid=1时才有效.&#13;&#10;		sql : "select userid,loginName,username,editPasswordTime from fcq_user where username like ':v_get%'  order by username"  //必选项, 弹出窗口的显示数据用的SQL语句.&#13;&#10;		})&#13;&#10;}&#13;&#10;&#13;&#10;function passworkPas(){//密码过期处理&#13;&#10;	var userid =  DsMain.Field('userid').Value;&#13;&#10;	if(IsSpace(userid) == false){&#13;&#10;		var xmlSql="<update tableName='fcq_user'><set>editPasswordTime='"+CurentTime()+"'</set><where> userid = '" +userid +"'</where></update>";&#13;&#10;     	doSaveData(xmlSql,function(){alert("密码过期处理成功");})&#13;&#10;	}else{&#13;&#10;		alert("先选择用户");&#13;&#10;	}&#13;&#10;}&#13;&#10;function userDeblocking(){//用户错误的登录次数大于5后，解锁&#13;&#10;	var userid =  DsMain.Field('userid').Value&#13;&#10;	if(IsSpace(userid) == false){&#13;&#10;		var xmlSql="<update tableName='fcq_user'><set>loginErrorTime='',loginErrorNum=0</set><where> userid = '" +userid +"'</where></update>";&#13;&#10;     	doSaveData(xmlSql,function(){alert("用户"+DsMain.Field('userName').Value+"已经解锁");})&#13;&#10;	}else{&#13;&#10;		alert("先选择用户");&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function  newPassword(){&#13;&#10;	var userid =  DsMain.Field('userid').Value;&#13;&#10;	if(IsSpace(userid) == false){&#13;&#10;		DsMain.Field('password').Value = "e10adc3949ba59abbe56e057f20f883e";&#13;&#10;		//DsMain.Update();&#13;&#10;		doSubmitData(function(){alert("初始化密码成功!");})		&#13;&#10;	}else{&#13;&#10;		alert("先选择用户");&#13;&#10;	}&#13;&#10;}&#13;&#10;function CurentTime()&#13;&#10;{ &#13;&#10;    var now = new Date();&#13;&#10;   &#13;&#10;    var year = now.getFullYear();       //年&#13;&#10;    var month = now.getMonth() + 1;     //月&#13;&#10;    var day = now.getDate();            //日&#13;&#10;   &#13;&#10;    var hh = now.getHours();            //时&#13;&#10;    var mm = now.getMinutes(); &#13;&#10;   	var ss = now.getSeconds();     //获取当前秒数(0-59)&#13;&#10;&#13;&#10;    var clock = year + "-";&#13;&#10;   &#13;&#10;    if(month < 10)&#13;&#10;        clock += "0";&#13;&#10;   &#13;&#10;    clock += month + "-";&#13;&#10;   &#13;&#10;    if(day < 10)&#13;&#10;        clock += "0";&#13;&#10;       &#13;&#10;    clock += day + " ";&#13;&#10;   &#13;&#10;    if(hh < 10)&#13;&#10;        clock += "0";&#13;&#10;       &#13;&#10;    clock += hh + ":";&#13;&#10;    if (mm < 10) clock += '0'; &#13;&#10;    clock += mm + ":";&#13;&#10;    &#13;&#10;    if(ss < 10) clock += '0';&#13;&#10;    clock += ss;&#13;&#10;    return(clock); &#13;&#10;} &#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true toolbar="不带工具栏" center="  " controlno="SKButton:0;SKDBedit:0;checkbox:0;label:4;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:4;tab:0;div:0;DsMain_field:0;a:0;button:3;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" posheight poswidth caption="系统管理员用" type="ZK" dj_sn="zk_admin_using" billtaborder="<root><taborder>cmdCommonSelect</taborder><taborder>txtName</taborder><taborder>button1</taborder><taborder>button2</taborder><taborder>button3</taborder></root>" contxml="<root><label><id>Label7</id><id>label1</id><id>label2</id><id>label3</id><id>label4</id></label><shape><id>shape1</id><id>shape2</id><id>shape3</id><id>shape4</id></shape><button><id>cmdCommonSelect</id><id>button1</id><id>button2</id><id>button3</id></button><text><id>txtName</id></text><dataset><id>DsMain</id></dataset></root>" BLONopen window="当前窗口" posleft postop isfile="是" BLONopenBefore BLONclose userType alertType="1" isCheckPermit="否" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" BLONresizeBefore BLONresizeAfter allBrowser="否" useHelp envType="电脑" unselectable="on"><IMG style="POSITION: absolute; WIDTH: 54px; HEIGHT: 53px; TOP: 47px; LEFT: 498px" id=DsMain src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" idtype="1" issubds="否" submitno="1" submittype="2" isaddemptyrec="是" pubpara="否" opensortno="1" isSubGrid="否" async="否" datasourceName AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll idparam="USE" savetable="fcq_user" saveastable="FCS_BILL" temptable="TMP_BILL_ZCASP_AA_ORDERBILL" chnname Like="否" iscreatetable="否" masterdsfield masterds subdsfield opensql formatxml='<root><tr rowstate="edit"><td>userid</td><td>用户id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>username</td><td>用户名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>PASSWORD</td><td>密码</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>editPasswordTime</td><td>编辑密码时间</td><td>字符</td><td>19</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>'><?xml:namespace prefix = v /><v:RoundRect onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 355px; HEIGHT: 71px; TOP: 7px; LEFT: 8px" id=shape1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="shape" cover="9" arcsize = "4321f" coordsize = "21600,21600" fillcolor = "#d2d2d2" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:RoundRect> <SPAN oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 15px; FONT-SIZE: 12px; TOP: 19px; LEFT: 26px" id=Label7 onresize=resize() onmove=move() controltype="label" inputTag="否" value="Label7">用户名称</SPAN><INPUT oncontrolselect=controlselect() style="POSITION: absolute; TEXT-ALIGN: left; WIDTH: 170px; DISPLAY: block; HEIGHT: 20px; FONT-SIZE: 12px; TOP: 16px; LEFT: 84px" id=txtName onresize=resize() onmove=move() value=用户名 size=11 controltype="text" dataset="DsMain" china="用户名" CanSelect="false" field="username"><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 58px; DISPLAY: block; BACKGROUND-REPEAT: no-repeat; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 14px; LEFT: 264px" id=cmdCommonSelect onresize=resize() onmove=move() controltype="button" dropstyle="是" fc_onclick='bill_onclick("uf_selectData1();")'>选择用户</BUTTON><v:RoundRect onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 353px; HEIGHT: 172px; TOP: 86px; LEFT: 8px" id=shape2 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="shape" cover="9" arcsize = "4321f" coordsize = "21600,21600" fillcolor = "#bcbc78" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:RoundRect><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 85px; HEIGHT: 25px; TOP: 106px; LEFT: 13px" id=button1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("passworkPas()")'>密码过期修复</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 67px; HEIGHT: 25px; TOP: 167px; LEFT: 13px" id=button2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("userDeblocking()")'>用户解锁</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 216px; LEFT: 13px" id=button3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("newPassword()")'>初始化密码</BUTTON><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 231px; HEIGHT: 45px; TOP: 158px; LEFT: 110px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">登录错误次数大于5，无法登录使用此功能，清除它以前的错误登录记录，使其可以重新登录。</LABEL><v:line onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 316px; HEIGHT: 15px; TOP: 149px; LEFT: 14px" id=shape3 onresize="" onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="shape" cover="9" linetype="横线" from = "0,0" to = "237pt,0" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:line><v:line onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 316px; HEIGHT: 15px; TOP: 208px; LEFT: 15px" id=shape4 onresize="" onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="shape" cover="9" linetype="横线" from = "0,0" to = "237pt,0" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:line><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 228px; HEIGHT: 35px; TOP: 216px; LEFT: 110px" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">如果用户忘记密码，重新设置用户密码为123456</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 236px; HEIGHT: 45px; TOP: 99px; LEFT: 110px" id=label3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">此密码在系统规定的时间内没有修改，使其过期，无法使用，使用此功能延长它的有效期。</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 326px; HEIGHT: 15px; TOP: 44px; LEFT: 21px" id=label4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">在编辑框中输入用户名支持模糊查找，如果就一条记录不弹出选择用户窗口，直接返回用户名。</LABEL></DIV>