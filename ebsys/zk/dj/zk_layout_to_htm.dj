<script>function uf_save() {&#13;&#10;	var xmlSql=""&#13;&#10;	var t = GetTime();&#13;&#10;	var arr = new Array();&#13;&#10;	var l=dataset2.oDom.documentElement.childNodes.length-1;&#13;&#10;	for(var i=0;i<l;i++){&#13;&#10;		//选择列在第0列.&#13;&#10;		if(dataset2.oDom.documentElement.childNodes[i].childNodes[0].text == "是"){&#13;&#10;			xmlSql += "<update tableName='fcq_unit'><set>genTime='"+ t +"'</set><where> id = '"+dataset2.oDom.documentElement.childNodes[i].childNodes[1].text+"'</where></update>";&#13;&#10;			arr[arr.length] = "../../fceform/common/djframe.htm?djsn="+dataset2.oDom.documentElement.childNodes[i].childNodes[3].text+"&isgen=htm"+dataset2.oDom.documentElement.childNodes[i].childNodes[4].text+dataset2.oDom.documentElement.childNodes[i].childNodes[5].text;&#13;&#10;		}	&#13;&#10;	}&#13;&#10;	if(xmlSql == ""){&#13;&#10;		alert("没有选中要生成htm文件的记录");&#13;&#10;	}else{&#13;&#10;		doSaveData(xmlSql,function(){new Eapi.Layout().layoutToHtm(arr,function (){alert("保存成功");$eform('关闭窗口');})})&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function uf_allSel(){&#13;&#10;	var l=dataset2.oDom.documentElement.childNodes.length-1;&#13;&#10;	for(var i=0;i<l;i++){&#13;&#10;		//选择列在第0列.&#13;&#10;		dataset2.oDom.documentElement.childNodes(i).childNodes(0).text = "是";&#13;&#10;		var oTd = grid1.tab.rows(i+1).cells(1);&#13;&#10;		oTd.style.backgroundImage="url("+fcpubdata.path+"/fceform/images/ef_run_grid_checked.gif)";&#13;&#10;		oTd.style.backgroundRepeat="no-repeat";&#13;&#10;		&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function uf_allNoSel(){&#13;&#10;	var l=dataset2.oDom.documentElement.childNodes.length-1;&#13;&#10;	for(var i=0;i<l;i++){&#13;&#10;		//选择列在第0列.&#13;&#10;		dataset2.oDom.documentElement.childNodes(i).childNodes(0).text = "否";&#13;&#10;		var oTd = grid1.tab.rows(i+1).cells(1);&#13;&#10;		oTd.style.backgroundImage="url("+fcpubdata.path+"/fceform/images/ef_run_grid_uncheck.gif)";&#13;&#10;		oTd.style.backgroundRepeat="no-repeat";&#13;&#10;		&#13;&#10;	}&#13;&#10;}&#13;&#10;function uf_setQueryNum(){&#13;&#10;	try{&#13;&#10;		setTimeout("uf_setBarPage()",2000) ;&#13;&#10;	}catch(e){}&#13;&#10;}&#13;&#10;function uf_setBarPage(){&#13;&#10;	parent.toolbar.pagesize.value = 100;&#13;&#10;}&#13;&#10;&#13;&#10;function uf_setDsPage(){&#13;&#10;	dataset2.PageSize = 100;&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true toolbar="自定义工具栏" billtaborder="<root><taborder>grid1</taborder></root>" dj_sn="zk_layout_to_htm" caption="表单模版生成运行的htm文件" type="ZK" isfile="是" center="  " posleft postop poswidth posheight window="当前窗口" BLONopen="uf_setQueryNum()" BLONopenBefore="uf_setDsPage()" BLONclose userType alertType="1" isCheckPermit="否" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:6;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:1;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" contxml="<root><grid><id>grid1</id></grid><dataset><id>dataset2</id></dataset></root>" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;fczk.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" allBrowser="否" useHelp userToolbar='<tr rowstate="add"><td>save</td><td>提交数据成功后提示</td><td></td><td>uf_save()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>query</td><td>查询</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>closewin</td><td>关闭窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>selall</td><td>全选</td><td></td><td>uf_allSel()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>noselall</td><td>全不选</td><td></td><td>uf_allNoSel()</td><td></td><td></td><td></td><td></td><td></td></tr>' unselectable="on"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 300px; HEIGHT: 140px; TOP: -1px; LEFT: 3px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" bodyrows="-1" bodyrowheight="-1" blRowNo="否" hideVscroll="auto" hideHscroll="auto" SetRowHeight="是" readonly="否" autoappend="否" autowidth="是" autoheight="是" canselect="是" dataset="dataset2" visible="是" controltype="grid" crosstabdatatype="0" crosstabsql cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" coltitle rowtitle crosstabformat crosstabsumtype="0" crosstabtitle iscrosstab="否" usertitle usertitlehtml titlerows titlerowheight><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 40px; LEFT: 512px" id=dataset2 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" async="否" isSubGrid="否" opensortno="1" pubpara="否" saveastable="FC_UNIT" isaddemptyrec="否" submittype="1" submitno="1" issubds="否" savetable="FCQ_UNIT" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll datasourceName iscreatetable queryTableName="FCQ_UNIT" fieldtrans="<root><field><name>chnfromtype</name><trans></trans><rtrans></rtrans><sql>select%20code%2Cname%20from%20fc_datadict%20where%20typename%3D%27%u529F%u80FD%u70B9%u7C7B%u578B%27</sql></field></root>" idparam="UNI" opensql="select ID,fromName,NAME,URL,paramUrl,genTime from FCQ_UNIT  where fromType=6 and deleteMark  <> 1 and url NOT  like '&amp;isgen=run%'" subdsfield masterds masterdsfield formatxml='<root><tr rowstate="add"><td>sel</td><td>选</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>勾</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>20</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>ID</td><td>ID</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>NAME</td><td>名称</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>190</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fromName</td><td>表单sn</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>160</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>URL</td><td>URL</td><td>字符</td><td>2000</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>350</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>paramUrl</td><td>运行参数</td><td>字符</td><td>1000</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>170</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>genTime</td><td>创建时间</td><td>字符</td><td>20</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>120</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>'></DIV>