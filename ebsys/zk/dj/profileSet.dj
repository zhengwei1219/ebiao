<script>var MainDiv = parent.dialogArguments[0]; //外面的大的SKbillsheet DIV&#13;&#10;var myObj = parent.dialogArguments[1]; //当前控件&#13;&#10;var objType = myObj.controltype; //控件类型&#13;&#10;var objid = myObj.id;&#13;&#10;&#13;&#10;function uf_open(){&#13;&#10;    SetButtonImage($id("cmdOk"),"../../fceform/images/ef_run_button_ok.gif");&#13;&#10;    SetButtonImage($id("cmdClose"),"../../fceform/images/ef_run_button_close.gif");&#13;&#10;	SendHttp(location.protocol+"//"+location.host+ fcpubdata.servletPath + "/WebBill"+fcpubdata.dotnetVersion+"?key=profileSet","",function(result){&#13;&#10;		if(result.value == null)return;&#13;&#10;		$id("div1").innerHTML = result.value;&#13;&#10;		var oXmlAll=SetDom("<root>"+MainDiv.roleXml+"</root>");&#13;&#10;		if(objType == "dataset"){&#13;&#10;		    var oXml = oXmlAll.selectSingleNode("root/record[@id = '"+objid+"' and @fieldname = '"+ myObj.curFieldName +"' ]");&#13;&#10;		}else{&#13;&#10;		    var oXml = oXmlAll.selectSingleNode("root/record[@id = '"+objid+"']");&#13;&#10;		}&#13;&#10;		if(oXml == null) return;&#13;&#10;		var irows = document.all.tab.rows.length;&#13;&#10;		if (irows >0)&#13;&#10;		{&#13;&#10;			for(var i=0;i<irows;i++)&#13;&#10;			{&#13;&#10;				var strId = document.all.tab.rows[i].cells[0].innerText;&#13;&#10;				strId = Trim(strId);&#13;&#10;				var oNode = oXml.selectNodes("Name[@value = '"+strId+"']")&#13;&#10;				if (oNode.length>0)&#13;&#10;				{&#13;&#10;					var chkDisplay = oNode(0).childNodes(0).text;&#13;&#10;					var chkDisabled = oNode(0).childNodes(1).text;&#13;&#10;					var chkRead = oNode(0).childNodes(2).text;&#13;&#10;					&#13;&#10;					eval("document.all.chkDisplay[i].checked = "+chkDisplay);&#13;&#10;					eval("document.all.chkDisabled[i].checked = "+chkDisabled);&#13;&#10;					eval("document.all.chkRead[i].checked = "+chkRead);&#13;&#10;				}&#13;&#10;			}&#13;&#10;		}&#13;&#10;	});&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;	var sb = new Sys.StringBuilder();&#13;&#10;	var irows = document.all.tab.rows.length;&#13;&#10;	if (irows >0)&#13;&#10;	{&#13;&#10;		sb.append("<record id='"+objid+"' controltype='"+objType+"'");&#13;&#10;		if(objType == "dataset") sb.append(" fieldname='"+myObj.curFieldName+"'");&#13;&#10;		sb.append(">");&#13;&#10;		for(var i=0;i<irows;i++)&#13;&#10;		{&#13;&#10;			var chkDisplay = document.all.chkDisplay[i].checked;&#13;&#10;			var chkDisabled = document.all.chkDisabled[i].checked;&#13;&#10;			var chkRead = document.all.chkRead[i].checked;&#13;&#10;			if (chkDisplay != false || chkDisabled != false || chkRead != false)&#13;&#10;			{&#13;&#10;				var strId = document.all.tab.rows[i].cells[0].innerText;&#13;&#10;				strId = Trim(strId);&#13;&#10;				sb.append("<Name value='"+strId+"'>");&#13;&#10;				sb.append("<Display>"+chkDisplay+"</Display>");&#13;&#10;				sb.append("<Disabled>"+chkDisabled+"</Disabled>");&#13;&#10;				sb.append("<Read>"+chkRead+"</Read>");&#13;&#10;				sb.append("</Name>");&#13;&#10;			}&#13;&#10;		}&#13;&#10;		sb.append("</record>");&#13;&#10;	}&#13;&#10;	window.returnValue = sb.toString();&#13;&#10;	window.close();&#13;&#10;	&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" userType BLONopenBefore runsave BLONclose unselectable="on" dj_sn="profileSet" caption="权限设置" type="ZK" isfile="是" center="居中" posleft postop poswidth="400" posheight="500" toolbar="不带工具栏" window="有模式窗口" BLONopen="uf_open()" idtype="1" entertype="修改" keyfield codeheader OtherSave="否" billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:1;DsMain_field:0;a:0;button:2;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" contxml="<root><label><id>label1</id></label><div><id>div1</id></div><button><id>cmdOk</id><id>cmdClose</id></button></root>"><DIV onmove=move() oncontrolselect=controlselect() id=div1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: black 1px solid; BORDER-TOP: black 1px solid; OVERFLOW-Y: auto; LEFT: 0px; OVERFLOW-X: auto; BORDER-LEFT: black 1px solid; WIDTH: 405px; BORDER-BOTTOM: black 1px solid; POSITION: absolute; TOP: 35px; HEIGHT: 406px" onmovestart=moveStart() controltype="div" NotBg="否"></DIV><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdOk onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 184px; WIDTH: 79px; FONT-FAMILY: ; POSITION: absolute; TOP: 1px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdClose onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 265px; WIDTH: 79px; FONT-FAMILY: ; POSITION: absolute; TOP: 1px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="否" fc_onclick='bill_onclick("CloseBill()")'></BUTTON><LABEL onmove=move() oncontrolselect=controlselect() id=label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-WEIGHT: bold; FONT-SIZE: 14pt; LEFT: 11px; WIDTH: 177px; COLOR: #0000ff; FONT-FAMILY: 楷体_GB2312; POSITION: absolute; TOP: 5px; HEIGHT: 23px; TEXT-DECORATION: none" onmovestart=moveStart() controltype="label" NotBg="否">控件操作权限设置</LABEL></DIV>