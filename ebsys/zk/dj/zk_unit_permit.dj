<script>var profile="";&#13;&#10;var str="";&#13;&#10;function uf_open()&#13;&#10;{&#13;&#10;	profile=fcpubdata.obj.Field('profileid').Value;&#13;&#10;	lblProfileName.innerText=fcpubdata.obj.Field('profileName').Value;&#13;&#10;	var sql="select FCQ_UNIT.id,name from  FCQ_UNIT left join fcq_profilesub on FCQ_UNIT.id = fcq_profilesub.detail where fcq_unit.deleteMark <> 1 and fcq_profilesub.profileid='"+profile+"'";&#13;&#10;	dataset1.Open(sql);&#13;&#10;	if(dataset1.oDom.documentElement.childNodes.length > 1){&#13;&#10;		var l=dataset1.oDom.documentElement.childNodes.length-1;&#13;&#10;		for(var i=0;i<l;i++)&#13;&#10;		{&#13;&#10;			var name=dataset1.oDom.documentElement.childNodes(i).childNodes(2).text;&#13;&#10;			str+=name+",";	&#13;&#10;		}&#13;&#10;	}&#13;&#10;	SetDivCheckBoxValue(cheUnitName,str,'text');&#13;&#10;}&#13;&#10;function uf_save()&#13;&#10;{&#13;&#10;	var formtype=1;//1表单2报表&#13;&#10;	var sRet="";&#13;&#10;	var sRet1="";&#13;&#10;	var unitname=GetDivCheckBoxValue(cheUnitName,'');&#13;&#10;	var arr=unitname.split(",")&#13;&#10;	for(var i=0;i<arr.length;i++)&#13;&#10;	{&#13;&#10;		sRet ="<insert tableName='FCQ_PROFILESUB'> <names>id,profileid,type,detail,permit</names> <values>'"+getMaxNo('PRO')+"','"+profile+"','"+formtype+"','"+arr[i]+"',1 </values> </insert>";&#13;&#10;		sRet1+=sRet;&#13;&#10;	}&#13;&#10;	var del="<delete tableName='FCQ_PROFILESUB'><where> profileid = '"+profile +"'</where></delete>"&#13;&#10;	sRet1=del+sRet1;&#13;&#10;	doSaveData(sRet1,function (){alert("保存成功")});&#13;&#10;	$eform('关闭窗口');&#13;&#10;	&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;//fcpubdata.eventBefore["提交数据成功后刷新上一窗口"]=function (result){&#13;&#10;	//uf_save();&#13;&#10;	//result.returnValue=false;	&#13;&#10;	&#13;&#10;//}&#13;&#10;function uf_value(){&#13;&#10;	SetDivCheckBoxValue(cheUnitName,"",'text');	&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" BLONresizeBefore BLONresizeAfter envType="电脑" unselectable="on" allBrowser="否" useHelp BLONopenBefore BLONclose center="居中" BLONopen="uf_open();new Eform.SysForm().setButtonImage();" dj_sn="zk_unit_permit" type="ZK" caption="功能权限" window="有模式窗口" posleft postop poswidth="720" posheight="450" isfile="是" billtaborder="<root></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:0;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:2;text:2;hr:0;checkboxlist:2;radiolist:0;dropdownlist:0;grid:1;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0" contxml="<root><label><id>label1</id><id>lblProfileName</id></label><checkboxlist><id>cheUnitName</id></checkboxlist><dataset><id>dataset1</id></dataset></root>" userType alertType="1" isCheckPermit="否" toolbar="自定义工具栏" userToolbar='<tr rowstate="add"><td>ok</td><td>提交数据成功后刷新上一窗口</td><td></td><td>uf_save()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>close</td><td>关闭窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>'><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 172px; LEFT: 935px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" opensql idparam subdsfield masterds masterdsfield formatxml='<root><tr rowstate="add"><td>sel</td><td>选</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>勾</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>25</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>ID</td><td>ID</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>NAME</td><td>NAME</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>200</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1" issubds="否" savetable submitno="1" submittype="1" isaddemptyrec="否" pubpara="否" saveastable isSubGrid="否" idtype="1" async="否" datasourceName queryTableName="FCQ_UNIT"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 114px; HEIGHT: 15px; TOP: 4px; LEFT: 12px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">${role}名称：</LABEL> 
<DIV onresizeend=resizeEnd() style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; FONT-STYLE: normal; WIDTH: 700px; FONT-FAMILY: 宋体; HEIGHT: 350px; FONT-SIZE: 12px; OVERFLOW: auto; BORDER-TOP: 0px; TOP: 30px; BORDER-RIGHT: 0px; LEFT: 9px" id=cheUnitName onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="checkboxlist" async="否" datasourceName check="2" sql="select id,name from fcq_unit where deleteMark <> 1" temptext tempvalue NotBg="否" AutoSizeXml="<record id ='cheUnitName'><Halign>居右</Halign><HWidth>10</HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>百分比设置</HSetType><Height></Height><HExt></HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" rows="3" other="否"></DIV><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 214px; FONT-FAMILY: 宋体; HEIGHT: 15px; TOP: 3px; TEXT-DECORATION: underline; LEFT: 86px" id=lblProfileName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" AutoSizeXml="<record id ='lblProfileName'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>百分比设置</HSetType><Height></Height><HExt></HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>"></LABEL></DIV>