<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	    <link rel="stylesheet" type="text/css" href="../../fceform/css/dj.css">
		<STYLE> .userData{behavior:url(#default#userData);}</STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>var profile="";
var str="";
function uf_open()
{
	profile=fcpubdata.obj.Field('profileid').Value;
	lblProfileName.innerText=fcpubdata.obj.Field('profileName').Value;
	var sql="select FCQ_UNIT.id,name from  FCQ_UNIT left join fcq_profilesub on FCQ_UNIT.id = fcq_profilesub.detail where fcq_unit.deleteMark <> 1 and fcq_profilesub.profileid='"+profile+"'";
	dataset1.Open(sql);
	if(dataset1.oDom.documentElement.childNodes.length > 1){
		var l=dataset1.oDom.documentElement.childNodes.length-1;
		for(var i=0;i<l;i++)
		{
			var name=dataset1.oDom.documentElement.childNodes(i).childNodes(2).text;
			str+=name+",";	
		}
	}
	SetDivCheckBoxValue(cheUnitName,str,'text');
}
function uf_save()
{
	var formtype=1;//1表单2报表
	var sRet="";
	var sRet1="";
	var unitname=GetDivCheckBoxValue(cheUnitName,'');
	var arr=unitname.split(",")
	for(var i=0;i<arr.length;i++)
	{
		sRet ="<insert tableName='FCQ_PROFILESUB'> <names>id,profileid,type,detail,permit</names> <values>'"+getMaxNo('PRO')+"','"+profile+"','"+formtype+"','"+arr[i]+"',1 </values> </insert>";
		sRet1+=sRet;
	}
	var del="<delete tableName='FCQ_PROFILESUB'><where> profileid = '"+profile +"'</where></delete>"
	sRet1=del+sRet1;
	doSaveData(sRet1,function (){alert("保存成功")});
	$eform('关闭窗口');
	
}


//fcpubdata.eventBefore["提交数据成功后刷新上一窗口"]=function (result){
	//uf_save();
	//result.returnValue=false;	
	
//}
function uf_value(){
	SetDivCheckBoxValue(cheUnitName,"",'text');	
}</script><script src='../../fceform/js/fcopendj.js'></script><script defer src='../../fceform/js/fcsavedj.js'></script><script src='../../fceform/js/fcselfuse.js'></script><script src='../../fceform/js/fcbasecont.js'></script><script defer src='../../fceform/js/fcother.js'></script><script defer src='../../fceform/js/selectdate.js'></script><script src='../../fceform/../fceformext/js/userfunc.js'></script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../../fceform/htc/dataset.htc)",0);</script><script src='../../fceform/js/fcdataset.js'></script>
<DIV id=SKbillsheet jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" BLONresizeBefore BLONresizeAfter envType="电脑" allBrowser="否" useHelp BLONopenBefore BLONclose center="居中" BLONopen="uf_open();new Eform.SysForm().setButtonImage();" dj_sn="zk_unit_permit" type="ZK" caption="功能权限" window="有模式窗口" posleft postop poswidth="720" posheight="450" isfile="是" billtaborder="<root></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:0;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:2;text:2;hr:0;checkboxlist:2;radiolist:0;dropdownlist:0;grid:1;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0" contxml="<root><label><id>label1</id><id>lblProfileName</id></label><checkboxlist><id>cheUnitName</id></checkboxlist><dataset><id>dataset1</id></dataset></root>" userType alertType="1" isCheckPermit="否" toolbar="自定义工具栏" AutoResizeXml="<record id ='lblProfileName'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>百分比设置</HSetType><Height></Height><HExt></HExt><HSetUnit>px</HSetUnit><MinH></MinH></record><record id ='cheUnitName'><Halign>居右</Halign><HWidth>10</HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>百分比设置</HSetType><Height></Height><HExt></HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" userToolbar='<tr rowstate="add"><td>ok</td><td>提交数据成功后刷新上一窗口</td><td></td><td>uf_save()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>close</td><td>关闭窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>'><?xml:namespace prefix = fc /><fc:dataset id=dataset1 controltype="dataset" opensortno="1" issubds="否" submitno="1" submittype="1" isaddemptyrec="否" pubpara="否" isSubGrid="否" idtype="1" async="否" format="<fields><field><fieldname>sel</fieldname><datatype>字符</datatype><displaylabel>选</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>ID</fieldname><datatype>字符</datatype><displaylabel>ID</displaylabel><size>11</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>NAME</fieldname><datatype>字符</datatype><displaylabel>NAME</displaylabel><size>50</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><sel></sel><ID></ID><NAME></NAME></dsid>")' onGetText='bill_ondatasetgettext("<dsid><sel></sel><ID></ID><NAME></NAME></dsid>")' onSetText='bill_ondatasetsettext("<dsid><sel></sel><ID></ID><NAME></NAME></dsid>")'></fc:dataset><LABEL style="POSITION: absolute; WIDTH: 114px; HEIGHT: 15px; TOP: 4px; LEFT: 12px" id=label1 onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">${role}名称：</LABEL> 
<DIV style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; FONT-STYLE: normal; WIDTH: 700px; FONT-FAMILY: 宋体; HEIGHT: 350px; FONT-SIZE: 12px; OVERFLOW: auto; BORDER-TOP: 0px; TOP: 30px; BORDER-RIGHT: 0px; LEFT: 9px" id=cheUnitName onmovestart=moveStart() controltype="checkboxlist" async="否" datasourceName check="2" sql temptext tempvalue sqltrans="%F4%D8%E6%D8%D4%F6Xrn%E0%D6Xr%94%EA%D0%E8%D8Xrn%DA%F2%EC%E8Xrn%DA%D4%F0%CC%F8%EA%E0%F6Xrn%FC%DE%D8%F2%D8Xrn%D6%D8%E6%D8%F6%D8%A8%D0%F2%E4XrnXt%94Xt%98Xrnp" NotBg="否" AutoSizeXml="<record id ='cheUnitName'><Halign>居右</Halign><HWidth>10</HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>百分比设置</HSetType><Height></Height><HExt></HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" rows="3" other="否"></DIV><LABEL style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 214px; FONT-FAMILY: 宋体; HEIGHT: 15px; TOP: 3px; TEXT-DECORATION: underline; LEFT: 86px" id=lblProfileName onmovestart=moveStart() controltype="label" inputTag="否" AutoSizeXml="<record id ='lblProfileName'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>百分比设置</HSetType><Height></Height><HExt></HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>"></LABEL></DIV><script></script></body></html>