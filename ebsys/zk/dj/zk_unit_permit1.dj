<script>&#13;&#10;var unitid="";&#13;&#10;var str="";&#13;&#10;function uf_open()&#13;&#10;{&#13;&#10;	new Eform.SysForm().setButtonImage();&#13;&#10;	unitid=fcpubdata.obj.Field('id').Value;&#13;&#10;	var tbName=fcpubdata.obj.Field('name').Value;&#13;&#10;	labUnitName.innerText=tbName;&#13;&#10;	var sql="select fcq_profile.profileId,profileName from fcq_profile left join fcq_profilesub on fcq_profile.profileId = fcq_profilesub.profileid where fcq_profilesub.detail='"+unitid+"'";&#13;&#10;	dataset1.Open(sql);&#13;&#10;	if(dataset1.oDom.documentElement.childNodes.length > 1)  {&#13;&#10;		var l=dataset1.oDom.documentElement.childNodes.length-1;&#13;&#10;		for(var i=0;i<l;i++)&#13;&#10;		{&#13;&#10;			var name=dataset1.oDom.documentElement.childNodes(i).childNodes(1).text;&#13;&#10;			str+=name+",";	&#13;&#10;		}&#13;&#10;	}&#13;&#10;	SetDivCheckBoxValue(cheProfileName,str,'text');&#13;&#10;}&#13;&#10;function uf_save()&#13;&#10;{&#13;&#10;	var formtype=1;//1表单2报表&#13;&#10;	var sRet="";&#13;&#10;	var sRet1="";&#13;&#10;	var profileName=GetDivCheckBoxValue(cheProfileName,'');&#13;&#10;	var arr=profileName.split(",")&#13;&#10;	for(var i=0;i<arr.length;i++)&#13;&#10;	{&#13;&#10;		sRet ="<insert tableName='FCQ_PROFILESUB'> <names>id,profileid,type,detail,permit</names> <values>'"+getMaxNo('PRO')+"','"+arr[i]+"','1','"+unitid+"',1 </values> </insert>";&#13;&#10;		sRet1+=sRet;&#13;&#10;	}&#13;&#10;	var del="<delete tableName='FCQ_PROFILESUB'><where> detail = '"+unitid+"'</where></delete>"&#13;&#10;	sRet1=del+sRet1;&#13;&#10;	doSaveData(sRet1,function (){alert("保存成功")});&#13;&#10;	$eform('关闭窗口');&#13;&#10;}&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true toolbar="不带工具栏" userToolbar='<tr rowstate="add"><td>ok</td><td>提交数据成功后刷新上一窗口</td><td></td><td>uf_save()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>close</td><td>关闭窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>' jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" isCheckPermit="否" alertType="1" userType contxml="<root><label><id>label1</id><id>labUnitName</id></label><button><id>cmdOk</id><id>cmdClose</id></button><checkboxlist><id>cheProfileName</id></checkboxlist><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:5;radio:0;listbox:0;textarea:0;combobox:2;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:1;text:5;hr:0;checkboxlist:1;radiolist:0;dropdownlist:1;grid:1;dataset:2;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" isfile="是" posheight poswidth postop posleft window="当前窗口" caption="功能权限" type="ZK" dj_sn="zk_unit_permit1" BLONopen="uf_open()" center="  " BLONclose BLONopenBefore unselectable="on" envType="电脑" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore runParams viewType=" "><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 159px; LEFT: 581px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" idparam async="否" isSubGrid="否" saveastable pubpara="否" isaddemptyrec="否" submittype="1" submitno="1" savetable issubds="否" opensortno="1" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll opensql="&#13;&#10;" subdsfield masterds masterdsfield formatxml="<root><tr rowstate=&quot;add&quot;><td>profileId</td><td>简档id</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>100</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>profileName</td><td>简档名</td><td>整数</td><td>4</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>150</td><td></td><td></td><td>$valid('整数');</td><td></td><td></td><td></td><td></td><td></td></tr></root>" queryTableName="FCQ_UNIT" datasourceName><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 82px; HEIGHT: 15px; TOP: 32px; LEFT: 14px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否" NotBg="否">功能点：</LABEL> 
<DIV onresizeend=resizeEnd() style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; FONT-STYLE: normal; WIDTH: 553px; FONT-FAMILY: 宋体; HEIGHT: 298px; FONT-SIZE: 12px; OVERFLOW: auto; BORDER-TOP: 0px; TOP: 56px; BORDER-RIGHT: 0px; LEFT: 9px" id=cheProfileName onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="checkboxlist" async="否" datasourceName sql="select profileId,profileName from fcq_profile where  profileId <> 'systemadmin'  and deleteMark <> 1" check="2" temptext tempvalue other="否" rows="2" NotBg="否"></DIV><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 328px; FONT-FAMILY: 宋体; HEIGHT: 15px; TOP: 31px; TEXT-DECORATION: underline; LEFT: 66px" id=labUnitName onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否"></LABEL><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 25px; TOP: 3px; LEFT: 11px" id=cmdOk onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("uf_save()")'></BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 25px; TOP: 3px; LEFT: 82px" id=cmdClose onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;$eform('关闭窗口')&quot;)"></BUTTON></DIV>