<script>&#13;&#10;function uf_open(){&#13;&#10;	new Eform.SysForm().setButtonImage();&#13;&#10;	new Eapi.DbStru().listTables($id("savetable"));	&#13;&#10;}&#13;&#10;function uf_ok() {&#13;&#10;	var arr = [dataset1.Field("layoutid").Value,dataset1.Field("name").Value,dataset1.Field("chnname").Value,dataset1.Field("printfile").Value,dataset1.Field("isRunEbiao").Value,dataset1.Field("classTable").Value,dataset1.Field("styleTable").Value,dataset1.Field("tableStr").Value,dataset1.Field("querytype").Value];&#13;&#10;	window.returnValue=arr;&#13;&#10;	window.close() ;&#13;&#10;}&#13;&#10;&#13;&#10;function uf_selectLayout(type){&#13;&#10;	if(IsSpace($id('savetable').value) == true){&#13;&#10;		alert('请选择表名后，再查询');&#13;&#10;		return;	&#13;&#10;	}&#13;&#10;	&#13;&#10;	var findStr = $id('savetable').value;&#13;&#10;	var sql="select fc_layout.layoutid,name,chnname,printfile,isRunEbiao,classTable,styleTable,tableStr,fc_layout.querytype from fc_layout inner join fc_layoutsub on fc_layout.layoutid = fc_layoutsub.layoutid  where fc_layoutsub.tbname like '"+findStr+"%'  ORDER BY fc_layout.layoutid desc";&#13;&#10;	dataset1.Open(sql);&#13;&#10;}&#13;&#10;&#13;&#10;function uf_del() {&#13;&#10;	var sqlXml = "<delete tableName='fc_layout'><where>  layoutid= '"+dataset1.Field('layoutid').Value+"'</where></delete>";&#13;&#10;	sqlXml += "<delete tableName='fc_layoutsub'><where>  layoutid= '"+dataset1.Field('layoutid').Value+"'</where></delete>";&#13;&#10;	var ret = window.confirm("确定删除当前模板吗？");&#13;&#10;           if(ret == false) return;&#13;&#10;           doSaveData(sqlXml,function(){alert("删除成功");});&#13;&#10;	uf_selectLayout();&#13;&#10;}&#13;&#10;&#13;&#10;//最大化函数&#13;&#10;function uf_maxwin(){&#13;&#10;	window.dialogLeft=0&#13;&#10;	window.dialogTop=0&#13;&#10;	window.dialogWidth= screen.availWidth+"px"&#13;&#10;	window.dialogHeight=screen.availHeight+"px"&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;" toolbar="不带工具栏" blmode="其他" dj_sn="zk_open_layout_file11" type="ZK" caption="打开布局模版" mkbh codeheader keyfield="djid" window="有模式窗口" entertype="修改" posleft postop poswidth="330" posheight="450" isfile="是" OtherSave="否" idtype="1" billtaborder="<root><taborder>SKBILLgrid1</taborder><taborder>FCButton7</taborder><taborder>button0</taborder><taborder>cmdClose</taborder><taborder>cmdOk</taborder><taborder>savetable</taborder><taborder>button1</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:2;radio:0;listbox:1;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:1;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:2;text:2;hr:0;checkboxlist:0;radiolist:0;dropdownlist:3;grid:0;dataset:2;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0" contxml="<root><label><id>label1</id></label><button><id>FCButton7</id><id>button0</id><id>cmdClose</id><id>cmdOk</id><id>button1</id></button><dropdownlist><id>savetable</id></dropdownlist><grid><id>SKBILLgrid1</id></grid><dataset><id>dataset1</id></dataset></root>" AutoResizeXml isCheckPermit="否" alertType="1" userType BLONopenBefore center="居中" BLONopen="uf_open()" BLONclose allBrowser="否" unselectable="on"><IMG style="POSITION: absolute; WIDTH: 340px; HEIGHT: 404px; TOP: 54px; LEFT: 4px" id=SKBILLgrid1 src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" canselect="是" autoheight="是" autowidth="是" autoappend="否" readonly="否" visible="是" SetRowHeight="是" hideHscroll="auto" hideVscroll="auto" blRowNo="否" bodyrowheight="-1" bodyrows="-1" dataset="dataset1" csstext2="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #c0c0c0" csstext1="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #ffffff" crosstabdatatype="0" crosstabsql cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" coltitle rowtitle crosstabformat crosstabsumtype="0" crosstabtitle iscrosstab="否" usertitle="否" usertitlehtml titlerows titlerowheight><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 64px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 26px; FONT-SIZE: 12px; TOP: 0px; LEFT: 71px" id=FCButton7 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_maxwin()")'>最大化</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 64px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 26px; FONT-SIZE: 12px; TOP: 0px; LEFT: 4px" id=button0 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_del()")'>删除</BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 68px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 1px; LEFT: 209px" id=cmdClose onresize=resize() onmove=move() controltype="button" dropstyle="否" fc_onclick='bill_onclick("CloseBill()")'></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 68px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 1px; LEFT: 138px" id=cmdOk onresize=resize() onmove=move() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'></BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 54px; LEFT: 537px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" opensortno="1" issubds="否" savetable="fc_layout" submitno="1" submittype="1" isaddemptyrec="否" pubpara="否" saveastable isSubGrid="否" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll queryTableName="fc_layout" async="否" datasourceName masterdsfield masterds subdsfield idparam opensql="select fc_layout.layoutid,name,chnname,printfile,isRunEbiao,classTable,styleTable,tableStr,fc_layout.querytype from fc_layout ORDER BY fc_layout.layoutid desc&#13;&#10;&#13;&#10; " formatxml="<root><tr rowstate=&quot;add&quot;><td>layoutid</td><td>布局id</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>name</td><td>英文名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>130</td><td></td><td></td><td></td><td></td><td></td><td>uf_ok()</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>chnname</td><td>中文名</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>170</td><td></td><td></td><td></td><td></td><td></td><td>uf_ok()</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>tableStr</td><td>布局文件</td><td>文本</td><td>16</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>isRunEbiao</td><td>是否运行e表产生数据集</td><td>字符</td><td>1</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>printfile</td><td>打印模板文件</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>classTable</td><td>class名</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>styleTable</td><td>table样式</td><td>字符</td><td>250</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>querytype</td><td>类型</td><td>整数</td><td>4</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td>$valid('整数');</td><td></td><td></td><td></td><td></td><td></td></tr></root>"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 40px; HEIGHT: 15px; TOP: 36px; LEFT: 6px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">表名</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 210px; HEIGHT: 20px; TOP: 31px; LEFT: 39px; ButtonWidth: 10" id=savetable onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" controltype="dropdownlist" visible="是" datasourceName format="英文表名|中文表名" check="1" temptext tempvalue sql xml multiselect="否" addrow="否" blnempty="否" blninput="是" FieldNameList isTreeNewSql="0" isShowTree="0"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 50px; HEIGHT: 23px; TOP: 29px; LEFT: 254px" id=button1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;uf_selectLayout('1')&quot;)">查询</BUTTON></DIV>