<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	    
	    <link rel="stylesheet" type="text/css" href="../../fceform/css/dj.css">
		<STYLE> .userData{behavior:url(#default#userData);}</STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>function uf_open()
{
	/*if(parent.Request.QueryString('id').toString()=="")
	{
		txtOrgid.value=parent.Request.QueryString('orgid').toString();
		txtOrgid.fireEvent("onchange");
	}
	else
	{
		dataset2.Open("select FCQ_USER.* from FCQ_USER  where userid='"+parent.Request.QueryString('id').toString()+"'");
		fcpubdata.keyValue = parent.Request.QueryString('id').toString();	
	}//*/
	var myDate = new Date();
	var nowDate = myDate.getFullYear()+"-"+myDate.getMonth()+1+"-"+myDate.getDate();
	dataset2.Field('editPasswordTime').Value= nowDate;
	new Eform.SysForm().setButtonImage();

}

function uf_isNull()
{
	var retxml=SqlToField("select loginname from fcq_user where loginname='"+txtLogName.value+"'");
	if(txtLogName.value	=="")
	{
		alert("登录名不能为空");
		return;
	}else if(retxml != "")
	{
		alert("登录名存在，请重新输入") ;
		return;	
	}else{
		$eform('提交数据成功后退出');
	}
}
function uf_sendDataset(sId,sfileName){//把选择输入控件的值传到数据集上
	if(sId.selectedIndex != -1) dataset2.Field(sfileName).Value=sId.options[sId.selectedIndex].text;
}
function uf_save(){
	//uf_sendDataset(combobox4,'deptname');	
	//uf_sendDataset(combobox1,'rolename');
	if(getTopWin().zksysset.usernameset == "是"){
		var l = Trim($id('txtName').value).length;
		if((l<6) || (l>24))	{
			alert("用户名长度应为6到24之间")	;
			return;
		}
	}
	uf_sendDataset(combobox2,'PROFILENAME');
	$eform('提交数据成功后刷新上一窗口');
}


function uf_selRole(){
	CommonSelect({
		istree: 1, //可选项, 弹出窗口中是否有tree控件,其值=0或1.树控件可以单独用,或是和grid,radiolist,checkboxlist组合用,组合用时可以设置树控件的宽度.
		height :600,
		width :450,
		obj : txtRoleId, //必选项, 用于修改的前一窗口控件对象,包含是grid对象.
		idfieldname : "roleid", //可选项, 前一窗口的id字段名,用于按字段同名传递数据.只在isgrid!=1时才有效.
		textfieldname : "rolename", //可选项, 前一窗口的text字段名,用于按字段同名传递数据.只在isgrid!=1时才有效
		hidefields : "roleid",// 隐藏字段
		istreenewsql : 1,
		roottext: "角色", //树控件的根节点文本
		sql : "select roleid,parentid,rolename ,roleid from fcq_role where deleteMark=0"	  //必选项, 弹出窗口的显示数据用的SQL语句.
	
		})	
	
}</script><script src='../../fceform/js/fcopendj.js'></script><script defer src='../../fceform/js/fcsavedj.js'></script><script src='../../fceform/js/fcselfuse.js'></script><script src='../../fceform/js/fcbasecont.js'></script><script defer src='../../fceform/js/fcother.js'></script><script defer src='../../fceform/js/selectdate.js'></script><script src='../../fceform/../fceformext/js/userfunc.js'></script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../../fceform/htc/dataset.htc)",0);</script><script src='../../fceform/js/fcdataset.js'></script>
<DIV id=SKbillsheet toolbar="不带工具栏" AutoResizeXml billtaborder="<root><taborder>txtLogName</taborder><taborder>txtName</taborder><taborder>combobox2</taborder><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" dj_sn="userCard" caption="用户卡片输入表" type="ZK" isfile="是" center="居中" posleft postop poswidth="485" posheight="115" window="有模式窗口" BLONopen="uf_open()" BLONopenBefore BLONclose userType alertType="1" isCheckPermit="否" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:12;radio:0;listbox:0;textarea:1;combobox:4;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:1;tab:0;div:0;DsMain_field:0;a:0;button:6;text:13;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:1;spin:0;excel:0;tree:1;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" contxml="<root><label><id>label1</id><id>label5</id><id>label11</id></label><combobox><id>combobox2</id></combobox><button><id>cmdOk</id><id>cmdClose</id></button><text><id>txtName</id><id>txtLogName</id></text><dataset><id>dataset2</id></dataset></root>" idtype="1" runsave keyfield="id" entertype="修改" codeheader="YHB" OtherSave="否" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" envType="电脑" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore runParams userToolbar='<tr rowstate="add"><td>ok</td><td>提交数据成功后刷新上一窗口</td><td></td><td>uf_save()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>close</td><td>关闭窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>' viewType=" " labelInputTag="label1.innerHTML+=' <font color=red>*</font>';label5.innerHTML+=' <font color=red>*</font>';label11.innerHTML+=' <font color=red>*</font>';"><SELECT style="POSITION: absolute; WIDTH: 138px; HEIGHT: 25px; TOP: 50px; LEFT: 87px" id=combobox2 onmovestart=moveStart() dataset="dataset2" controltype="combobox" sqltrans="%F4%D8%E6%D8%D4%F6Xrn%EE%F2%EC%DA%E0%E6%D8%A0%D6Xr%94%EE%F2%EC%DA%E0%E6%D8%AA%D0%E8%D8Xrn%DA%F2%EC%E8Xrn%DA%D4%F0%CC%EE%F2%EC%DA%E0%E6%D8Xrn%FC%DE%D8%F2%D8Xrn%D6%D8%E6%D8%F6%D8%A8%D0%F2%E4XrnXt%94Xt%98XrnpXrn%D0%EA%D6Xrn%EE%F2%EC%DA%E0%E6%D8%A0%D6Xt%94Xt%98XrnXr%7C%F4%u0100%F4%F6%D8%E8%D0%D6%E8%E0%EAXr%7C" async="否" datasourceName field="PROFILEID" china="PROFILEID" sql temptext tempvalue check="2"></SELECT><LABEL style="POSITION: absolute; WIDTH: 81px; HEIGHT: 17px; TOP: 54px; LEFT: 13px" id=label1 onmovestart=moveStart() controltype="label" inputTag="是" NotBg="否">默认角色名</LABEL><INPUT style="POSITION: absolute; WIDTH: 137px; HEIGHT: 20px; TOP: 27px; LEFT: 321px" id=txtName onmovestart=moveStart() size=39 dataset="dataset2" controltype="text" field="username" china="用户名" ondblclick="bill_ondblclick(&quot;uf_sendDataset(txtName,'username')&quot;)"><LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 32px; LEFT: 263px" id=label5 onmovestart=moveStart() controltype="label" inputTag="是" NotBg="否">用户名</LABEL><?xml:namespace prefix = fc /><fc:dataset id=dataset2 idtype="1" format="<fields><field><fieldname>userid</fieldname><datatype>字符</datatype><displaylabel>ID</displaylabel><size>11</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>是</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>username</fieldname><datatype>字符</datatype><displaylabel>用户名</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>LOGINNAME</fieldname><datatype>字符</datatype><displaylabel>登录名</displaylabel><size>50</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>PROFILEID</fieldname><datatype>字符</datatype><displaylabel>简档名称</displaylabel><size>11</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>ORGID</fieldname><datatype>字符</datatype><displaylabel>ORGID</displaylabel><size>11</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>PASSWORD</fieldname><datatype>字符</datatype><displaylabel>PASSWORD</displaylabel><size>50</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue>e10adc3949ba59abbe56e057f20f883e</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>deleteMark</fieldname><datatype>整数</datatype><displaylabel>删除标记</displaylabel><size>4</size><precision></precision><fieldkind>变量默认值</fieldkind><defaultvalue>0</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>sortNo</fieldname><datatype>整数</datatype><displaylabel>序列号</displaylabel><size>4</size><precision></precision><fieldkind>变量默认值</fieldkind><defaultvalue>getMaxIntNo('SOR')</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>PROFILENAME</fieldname><datatype>字符</datatype><displaylabel>PROFILENAME</displaylabel><size>50</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>skin</fieldname><datatype>字符</datatype><displaylabel>皮肤</displaylabel><size>50</size><precision></precision><fieldkind>数据项</fieldkind><defaultvalue>blue</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>editPasswordTime</fieldname><datatype>字符</datatype><displaylabel>编辑密码时间</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" controltype="dataset" sqltrans="%F4%D8%E6%D8%D4%F6Xrn%9A%94%B0%CC%B8%B4%98%B2jbXrnXrn%DA%F2%EC%E8Xrn%9A%94%B0%CC%B8%B4%98%B2XrnXrn%FC%DE%D8%F2%D8Xrn%F8%F4%D8%F2%E0%D6Xt%96Xr%7CXt%90X%7C%92%DA%D4%EE%F8%D2%D6%D0%F6%D0j%EC%D2%E2j%9A%E0%D8%E6%D6Xr%7EXr%7C%F8%F4%D8%F2%E0%D6Xr%7CXr%80j%BA%D0%E6%F8%D8X%7C%96Xt%90Xr%7C" onSetText='bill_ondatasetsettext("<dsid><userid></userid><username></username><LOGINNAME></LOGINNAME><PROFILEID></PROFILEID><ORGID></ORGID><PASSWORD></PASSWORD><deleteMark></deleteMark><sortNo></sortNo><PROFILENAME></PROFILENAME><skin></skin><editPasswordTime></editPasswordTime></dsid>")' onGetText='bill_ondatasetgettext("<dsid><userid></userid><username></username><LOGINNAME></LOGINNAME><PROFILEID></PROFILEID><ORGID></ORGID><PASSWORD></PASSWORD><deleteMark></deleteMark><sortNo></sortNo><PROFILENAME></PROFILENAME><skin></skin><editPasswordTime></editPasswordTime></dsid>")' onValid='bill_ondatasetvalid("<dsid><userid></userid><username></username><LOGINNAME></LOGINNAME><PROFILEID></PROFILEID><ORGID></ORGID><PASSWORD></PASSWORD><deleteMark>$valid(&amp;quot;整数&amp;quot;);</deleteMark><sortNo>$valid(&amp;quot;整数&amp;quot;);</sortNo><PROFILENAME></PROFILENAME><skin></skin><editPasswordTime></editPasswordTime></dsid>")' async="否" isSubGrid="否" opensortno="1" pubpara="否" saveastable="FCQ_USER" isaddemptyrec="否" submittype="2" submitno="1" issubds="否" savetable="FCQ_USER" fieldtrans="<root><field><name>rolename</name><trans></trans><rtrans></rtrans><sql>select%20roleid%20%2Crolename%20from%20fcq_role</sql></field></root>" idparam="USE"></fc:dataset><INPUT style="POSITION: absolute; WIDTH: 138px; HEIGHT: 20px; TOP: 27px; LEFT: 87px" id=txtLogName onmovestart=moveStart() dataset="dataset2" controltype="text" field="LOGINNAME" china="LOGINNAME"><LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 32px; LEFT: 13px" id=label11 onmovestart=moveStart() controltype="label" inputTag="是" NotBg="否">登录名</LABEL><BUTTON style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 2px; LEFT: 11px" id=cmdOk onmovestart=moveStart() controltype="button" onclick="bill_onclick(&quot;$eform('提交数据成功后刷新上一窗口')&quot;)"></BUTTON><BUTTON style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 2px; LEFT: 88px" id=cmdClose onmovestart=moveStart() controltype="button" onclick="bill_onclick(&quot;$eform('关闭窗口')&quot;)"></BUTTON></DIV><script></script></body></html>