<!Doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	    <link rel="stylesheet" type="text/css" href="../../fceform/css/dj.css">
		<STYLE> .userData{behavior:url(#default#userData);}</STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>var key1 = "";
var keyName1 = "";


function uf_Open(){
	new Eform.SysForm().setButtonImage();
	dataset2.Field('typeId').Value = fcpubdata.obj.Field('typeId').Value;
	$id('manageType').innerText = fcpubdata.obj.Field('chnname').Value;
	var sql = "select tbname1,tbname2,selFunc1 ,selFunc2 ,sql1,sql2 from  fcq_relation_dict_type where typeId='"+fcpubdata.obj.Field('typeId').Value+"'";
	var xmlRet1 = SelectSql(sql, 1, 1);
    var oXml1 = SetDom(xmlRet1);
    if (oXml1.documentElement == null) {
        alert(xmlRet1);
        return;
    }
	if (oXml1.documentElement.childNodes.length < 1) return;
   
    var selFunc1 = oXml1.documentElement.childNodes[0].childNodes[2].text;
    var selFunc2 = oXml1.documentElement.childNodes[0].childNodes[3].text;
    var sql1 = oXml1.documentElement.childNodes[0].childNodes[4].text;
    var sql2 = oXml1.documentElement.childNodes[0].childNodes[5].text;
    if(IsSpace(selFunc1) == false)	{//函数和sql语句的规则，有函数先用函数，没函数就用sql
    	selFunc1 = unescape(selFunc1);
		$id('dropTable1').onclickopen="bill_onclick(\""+selFunc1+"\")";
    } else{
    	sql1 = unescape(sql1);
    	dropTable1.sql1 = sql1;
    } 
    
    if(IsSpace(selFunc2) == false)	{
    	selFunc2 = unescape(selFunc2);
    	$id('dropTable2').onclickopen="bill_onclick(\""+selFunc2+"\")";
    } else{
    	sql2 = unescape(sql2);
    	dropTable2.sql1 = sql2;
    } 
}

</script><script src='../../fceform/js/fcopendj.js'></script><script defer src='../../fceform/js/fcsavedj.js'></script><script src='../../fceform/js/fcselfuse.js'></script><script src='../../fceform/js/fcbasecont.js'></script><script defer src='../../fceform/js/fcother.js'></script><script defer src='../../fceform/js/selectdate.js'></script><script src='../../fceform/../fceformext/js/userfunc.js'></script><script src='../../fceform/htc/fc_code.js'></script><script src='../../fceform/htc/dataset.js'></script><script src='../../fceform/js/fcdataset.js'></script>
<DIV id=SKbillsheet toolbar="自定义工具栏" AutoResizeXml BLONresizeBefore BLONresizeAfter allBrowser="是" useHelp isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen="uf_Open()" center="居中" userToolbar='<tr rowstate="add"><td>ok</td><td>提交数据成功后刷新上一窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>close</td><td>关闭窗口</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>' contxml="<root><label><id>label2</id><id>label3</id><id>manageType</id><id>label6</id><id>label8</id><id>label9</id></label><text><id>text7</id></text><dropdownlist><id>dropTable1</id><id>dropTable2</id><id>dropdownlist8</id><id>dropdownlist9</id></dropdownlist><dataset><id>dataset2</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:9;radio:0;listbox:2;textarea:0;combobox:1;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:12;text:7;hr:0;checkboxlist:0;radiolist:0;dropdownlist:9;grid:2;dataset:3;spin:0;excel:0;tree:1;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" billtaborder="<root><taborder>dropTable1</taborder><taborder>dropTable2</taborder><taborder>dropdownlist8</taborder><taborder>dropdownlist9</taborder><taborder>text7</taborder></root>" isfile="是" posheight="300" poswidth="410" postop posleft window="有模式窗口" caption="关系词典卡片表" type="ZK" dj_sn="zk_share_rule_card" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" envType="电脑" runParams><LABEL style="POSITION: absolute; WIDTH: 58px; HEIGHT: 17px; TOP: 25px; LEFT: 12px" id=label2 onmovestart=moveStart() controltype="label" inputTag="否">来自于</LABEL><?xml:namespace prefix = fc /><fc:dataset id=dataset2 idtype="1" controltype="dataset" sqltrans="%F4%D8%E6%D8%D4%F6Xrn%F4%DE%D0%F2%D8%E0%D6Xr%94%F6%D2%EA%D0%E8%D8Xr%94%F6%u0100%EE%D8%A0%D6Xr%94%DA%F2%EC%E8%A0%D6Xr%94%F6%EC%A0%D6Xr%94%EE%D8%F2%E8%E0%F6Xrn%DA%F2%EC%E8Xrn%DA%D4%F0%CC%F4%DE%D0%F2%D8%F2%F8%E6%D8Xrn%FC%DE%D8%F2%D8Xrn%F6%u0100%EE%D8%A0%D6Xt%96Xr%7CXt%90X%7C%92%DA%D4%EE%F8%D2%D6%D0%F6%D0j%EC%D2%E2j%9A%E0%D8%E6%D6Xr%7EXr%7C%F6%u0100%EE%D8%A0%D6Xr%7CXr%80j%BA%D0%E6%F8%D8X%7C%96Xt%90Xr%7CXrn%D0%EA%D6Xrn%F4%DE%D0%F2%D8%E0%D6Xt%96Xr%7CXt%90X%7C%92%DA%D4%EE%F8%D2%D6%D0%F6%D0j%EC%D2%E2j%9A%E0%D8%E6%D6Xr%7EXr%7C%F4%DE%D0%F2%D8%E0%D6Xr%7CXr%80j%BA%D0%E6%F8%D8X%7C%96Xt%90Xr%7C" async="否" format="<fields><field><fieldname>shareid</fieldname><datatype>字符</datatype><displaylabel>共享id</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>是</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>typeId</fieldname><datatype>字符</datatype><displaylabel>分类id</displaylabel><size>11</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>tbname</fieldname><datatype>字符</datatype><displaylabel>表名</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>tbchnname</fieldname><datatype>字符</datatype><displaylabel>表中文名</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fromId</fieldname><datatype>字符</datatype><displaylabel>共享着</displaylabel><size>2048</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>fromName</fieldname><datatype>字符</datatype><displaylabel>共享名</displaylabel><size>2000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>toId</fieldname><datatype>字符</datatype><displaylabel>共享给id</displaylabel><size>2045</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>toName</fieldname><datatype>字符</datatype><displaylabel>共享给</displaylabel><size>2000</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>permit</fieldname><datatype>字符</datatype><displaylabel>权限</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue>2</defaultvalue><displayformat></displayformat><isnull>是</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>permit1</fieldname><datatype>字符</datatype><displaylabel>权限类型</displaylabel><size>10</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue>全局只读</defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><shareid></shareid><typeId></typeId><tbname></tbname><tbchnname></tbchnname><fromId></fromId><fromName></fromName><toId></toId><toName></toName><permit></permit><permit1></permit1></dsid>")' onGetText='bill_ondatasetgettext("<dsid><shareid></shareid><typeId></typeId><tbname></tbname><tbchnname></tbchnname><fromId></fromId><fromName></fromName><toId></toId><toName></toName><permit></permit><permit1></permit1></dsid>")' onSetText='bill_ondatasetsettext("<dsid><shareid></shareid><typeId></typeId><tbname></tbname><tbchnname></tbchnname><fromId></fromId><fromName></fromName><toId></toId><toName></toName><permit></permit><permit1></permit1></dsid>")' fieldtrans="<root><field><name>keyName2</name><trans></trans><rtrans></rtrans><sql></sql></field></root>" savetable="FCQ_SHARERULE" issubds="否" submitno="1" submittype="2" isaddemptyrec="否" pubpara="否" opensortno="1" isSubGrid="否" idparam="SHA"></fc:dataset><LABEL style="POSITION: absolute; WIDTH: 69px; HEIGHT: 22px; TOP: 50px; LEFT: 12px" id=label3 onmovestart=moveStart() controltype="label" inputTag="否">共享到</LABEL><LABEL style="POSITION: absolute; WIDTH: 196px; HEIGHT: 15px; TOP: 4px; LEFT: 72px" id=manageType onmovestart=moveStart() controltype="label" inputTag="否"></LABEL><fc:fc_code id=dropTable1 datasourceName="" xml="" controltype="dropdownlist" sqltrans="" format="" width="317" height="16" top="23" left="68" visible="是" dataset="dataset2" field="fromName" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList="" position="absolute" align="undefined" sql2="null"></fc:fc_code><fc:fc_code id=dropTable2 datasourceName="" xml="" controltype="dropdownlist" sqltrans="" format="" width="317" height="16" top="47" left="68" visible="是" dataset="dataset2" field="toName" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList="" position="absolute" align="undefined" sql2="null"></fc:fc_code><LABEL style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 7px; LEFT: 12px" id=label6 onmovestart=moveStart() controltype="label" inputTag="否">关系类型</LABEL><LABEL style="POSITION: absolute; WIDTH: 69px; HEIGHT: 22px; TOP: 97px; LEFT: 12px" id=label8 onmovestart=moveStart() controltype="label" inputTag="否">权限类型</LABEL><fc:fc_code id=dropdownlist8 datasourceName="" xml="" controltype="dropdownlist" sqltrans="%F4%D8%E6%D8%D4%F6XrnXrn%EA%D0%E8%D8Xrn%D0%F4Xrn%EE%D8%F2%E8%E0%F6pXrnXr%94%D4%EC%D6%D8Xrn%D0%F4Xrn%EE%D8%F2%E8%E0%F6XrnXrn%DA%F2%EC%E8Xrn%9A%94%CC%96%90%B6%90%96%A0%94%B6Xrn%FC%DE%D8%F2%D8Xrn%F6%u0100%EE%D8%EA%D0%E8%D8Xt%96Xr%7CX%F8z%7CvtX%F8%80zxnX%F8%7C%94%7C%92X%F8x%7C%7E%92X%F8xvn%96X%F8%7C%80%9AnXr%7CXrn%D0%EA%D6Xrn%EA%D0%E8%D8XrnXrpXt%96XrnXr%7CX%F8%7C%80%94pX%F8z%7Cn%80Xr%7C" format=" 权限类型 |" width="317" height="16" top="94" left="68" visible="是" dataset="dataset2" field="permit1" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList="" position="absolute" align="undefined" sql2="null"></fc:fc_code><LABEL style="POSITION: absolute; WIDTH: 69px; HEIGHT: 22px; TOP: 73px; LEFT: 12px" id=label9 onmovestart=moveStart() controltype="label" inputTag="否">表名</LABEL><fc:fc_code id=dropdownlist9 datasourceName="" xml="" controltype="dropdownlist" sqltrans="%F4%D8%E6%D8%D4%F6Xrn%F6%D2%EA%D0%E8%D8Xr%94%F6%D2%D4%DE%EA%EA%D0%E8%D8Xrn%DA%F2%EC%E8Xrn%DA%D4%CC%D8%EA%F6%E0%F6%u0100Xrn%FC%DE%D8%F2%D8Xrn%EE%D8%F2%E8%E0%F6Xt%96pXrn%EC%F2Xrn%EE%D8%F2%E8%E0%F6Xt%96r" format="  表名  | 表中文名 !" width="317" height="16" top="70" left="68" visible="是" dataset="dataset2" field="tbchnname" addrow="否" multiselect="否" blnempty="否" blninput="是" isShowTree="0" isTreeNewSql="0" FieldNameList="" position="absolute" align="undefined" sql2="null"></fc:fc_code><INPUT style="POSITION: absolute; WIDTH: 180px; DISPLAY: none; HEIGHT: 20px; TOP: 138px; LEFT: 83px" id=text7 onmovestart=moveStart() size=32 controltype="text" dataset="dataset2" china="分类id" field="typeId"></DIV><script>var dataset2=new dataset("dataset2"); var dropTable1=new dropdownlist("dropTable1"); $obj("dropTable1").fnInit(); var dropTable2=new dropdownlist("dropTable2"); $obj("dropTable2").fnInit(); var dropdownlist8=new dropdownlist("dropdownlist8"); $obj("dropdownlist8").fnInit(); var dropdownlist9=new dropdownlist("dropdownlist9"); $obj("dropdownlist9").fnInit(); </script></body></html>