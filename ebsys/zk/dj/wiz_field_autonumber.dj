<script>var objNav = new Object();&#13;&#10;objNav.prevPage = "wiz_field_first";&#13;&#10;objNav.nextPage = "wiz_field_finish";&#13;&#10;objNav.saveConfig = saveConfig;&#13;&#10;var length1 = "";&#13;&#10;objNav.isOk = true;&#13;&#10;&#13;&#10;function uf_open() {&#13;&#10;	PropWinOpenConfig(objNav);&#13;&#10;    SetTextValue(objNav.config.initialCode, $id("initialCode"));&#13;&#10;    SetTextValue(objNav.config.showFormat, $id("showFormat"));&#13;&#10;    SetCheckBoxValue($id("isGenerateCode"), objNav.config.isGenerateCode);&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;//保存配置信息,由工具栏来调用&#13;&#10;function saveConfig() {&#13;&#10;    if (PropWinSaveConfig(objNav)){&#13;&#10;    	objNav.isOk = false&#13;&#10;    	 return;&#13;&#10;    }&#13;&#10;    var sFormat = new Eapi.Str().trim($id("showFormat").value);&#13;&#10;    if (uf_check(sFormat) == false) {&#13;&#10;        objNav.isOk = false;&#13;&#10;        alert("显示格式输入非法!");&#13;&#10;        return;&#13;&#10;    }&#13;&#10;    objNav.config.isGenerateCode = $id("isGenerateCode").value;&#13;&#10;    objNav.config.initialCode = $id("initialCode").value;&#13;&#10;    objNav.config.showFormat = $id("showFormat").value;&#13;&#10;    objNav.config.len = showFormat.value.length;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_sNull(objNav) {&#13;&#10;    var sValue = new Eapi.Str().trim($id("showFormat").value);&#13;&#10;    if (IsSpace(sValue)) {&#13;&#10;        alert("显示格式不能为空!");&#13;&#10;        objNav.isOk = false;&#13;&#10;        return true;&#13;&#10;    }&#13;&#10;}&#13;&#10;function uf_check(sFormat) {&#13;&#10;    var posStart = sFormat.lastIndexOf("{0");&#13;&#10;    var posEnd = sFormat.lastIndexOf("0}");&#13;&#10;    for (var i = 0; i < sFormat.substring(posStart + 1, posEnd + 1).length; i++) {&#13;&#10;        if (sFormat.substring(posStart + 1, posEnd + 1).substring(i, i + 1) != "0") //查看字符串内有不是0的字符&#13;&#10;            return false;&#13;&#10;    }&#13;&#10;    if (sFormat.indexOf("{YYYY}", posEnd + 2) != -1 || sFormat.indexOf("{YY}", posEnd + 2) != -1 || sFormat.indexOf("{MM}", posEnd + 2) != -1 || sFormat.indexOf("{DD}", posEnd + 2) != -1)&#13;&#10;        return false;&#13;&#10;    if (sFormat.indexOf("{0") != -1 || sFormat.indexOf("0}") != -1)//字符串里没有组成合法编号的{0和0}&#13;&#10;    {&#13;&#10;        if (sFormat.indexOf(sFormat.substring(posStart, posEnd + 2)) != sFormat.lastIndexOf(sFormat.substring(posStart, posEnd + 2)))   //判断是否有两个相同的合法值&#13;&#10;            return false;&#13;&#10;    } else {&#13;&#10;        return false;&#13;&#10;    }&#13;&#10;    return true;&#13;&#10;}&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true toolbar="不带工具栏" BLONopenBefore runsave BLONclose center="居中" BLONopen="uf_open();new Eform.SysForm().setButtonImage() " dj_sn="wiz_field_autonumber" type="ZK" caption="自动编号字段表" codeheader keyfield window="有模式窗口" entertype="展现" posleft postop poswidth="420" posheight="430" isfile="是" OtherSave="否" idtype="1" billtaborder="<root><taborder>showFormat</taborder><taborder>initialCode</taborder><taborder>isGenerateCode</taborder><taborder>cmdActionSet</taborder><taborder>fdname</taborder><taborder>fdchnname</taborder><taborder>helpText</taborder><taborder>readTrans</taborder><taborder>saveTrans</taborder><taborder>cmdDropDown1</taborder><taborder>cmdDropDown2</taborder><taborder>button2</taborder><taborder>button1</taborder><taborder>tbname</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:6;label:17;radio:0;listbox:0;textarea:1;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:0;text:12;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0" contxml="<root><checkbox><id>isGenerateCode</id></checkbox><label><id>label10</id><id>label11</id><id>Label20</id><id>lblTitle</id><id>labTbname</id><id>labFdname</id><id>labFdchnname</id><id>labHelpText</id><id>labReadTrans</id><id>labSaveTrans</id></label><a><id>showCont</id><id>showTd</id></a><button><id>cmdActionSet</id><id>cmdDropDown1</id><id>cmdDropDown2</id><id>button2</id><id>button1</id></button><text><id>showFormat</id><id>initialCode</id><id>fdname</id><id>fdchnname</id><id>helpText</id><id>readTrans</id><id>saveTrans</id><id>tbname</id></text><dataset><id>permitDs</id></dataset></root>" userType alertType="1" isCheckPermit="否" jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;fczk.js&#13;&#10;~userfunc.js" unselectable="on">&nbsp;<LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 215px; LEFT: 17px" id=label10 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">初始编号</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 236px; LEFT: 17px" id=label11 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">显示格式</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 271px; HEIGHT: 19px; TOP: 233px; LEFT: 91px" id=showFormat onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value={YYYY}{MM}-{000000} size=43 controltype="text"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 271px; HEIGHT: 19px; TOP: 211px; LEFT: 91px" id=initialCode onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=44 controltype="text">&nbsp; 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 135px; HEIGHT: 20px; TOP: 190px; LEFT: 88px" id=isGenerateCode onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="checkbox" value="0" truevalue="1" falsevalue="0" NotBg="否"><INPUT oncontrolselect=controlselectcancel() type=checkbox><SPAN>为现有记录生成编号</SPAN></DIV>
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; FONT-STYLE: normal; WIDTH: 258px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 87px; COLOR: #b2b2b2; FONT-SIZE: 12px; TOP: 259px; LEFT: 90px" id=Label20 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" value="Label20" NotBg="否" inputTag="否">显示格式说明:自动编号支持变量{YYYY}表示四位年份，{YY} 表示两位年份，{MM} 表示月份，{DD}表示日。用{0}来生产最大整数，且大括号中的0最少有一个，更多也可以，但不能有0以外的其它数字或字符。产生最大值的大括号后面不能有以上四个变量和符合产生最大值的大括号。</DIV><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 114px; DISPLAY: none; FONT-FAMILY: 楷体_GB2312; HEIGHT: 22px; COLOR: #000080; FONT-SIZE: 14pt; TOP: 7px; FONT-WEIGHT: bold; TEXT-DECORATION: underline; LEFT: 9px" id=lblTitle onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">字段信息</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 351px; HEIGHT: 16px; TOP: 2px; LEFT: 16px" id=labTbname onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否"></LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 27px; LEFT: 17px" id=labFdname onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">字段名</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 271px; HEIGHT: 20px; TOP: 23px; LEFT: 91px" id=fdname onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value=field1 size=48 controltype="text" fc_onblur="bill_onexit(&quot;$valid('不能为空','字段名称不能为空!');&quot;)"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 76px; HEIGHT: 15px; TOP: 51px; LEFT: 17px" id=labFdchnname onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">字段中文名</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 271px; HEIGHT: 20px; TOP: 46px; LEFT: 91px" id=fdchnname onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value=字段1 size=48 controltype="text"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 74px; LEFT: 17px" id=labHelpText onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">帮助文本</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 271px; HEIGHT: 20px; TOP: 69px; LEFT: 91px" id=helpText onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value=字段1 size=48 controltype="text"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 70px; HEIGHT: 16px; TOP: 98px; LEFT: 17px" id=labReadTrans onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">读出时转换</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 255px; HEIGHT: 20px; TOP: 92px; LEFT: 91px" id=readTrans onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=41 controltype="text"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 70px; HEIGHT: 16px; TOP: 121px; LEFT: 17px" id=labSaveTrans onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" NotBg="否" inputTag="否">保存前转换</LABEL><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 255px; HEIGHT: 20px; TOP: 115px; LEFT: 91px" id=saveTrans onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=41 controltype="text"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; DISPLAY: none; HEIGHT: 25px; TOP: 156px; LEFT: 287px" id=cmdActionSet onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("eformWizFieldPowerSet()")'>权限设置</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; BACKGROUND-COLOR: #c0c0c0; WIDTH: 17px; HEIGHT: 20px; BORDER-TOP: 0px; TOP: 92px; BORDER-RIGHT: 0px; LEFT: 345px" id=cmdDropDown1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("PropWinFx(readTrans,tbname.value)")'></BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="BORDER-BOTTOM: 0px; POSITION: absolute; BORDER-LEFT: 0px; BACKGROUND-COLOR: #c0c0c0; WIDTH: 17px; HEIGHT: 20px; BORDER-TOP: 0px; TOP: 115px; BORDER-RIGHT: 0px; LEFT: 345px" id=cmdDropDown2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("PropWinFx(saveTrans,tbname.value)")'></BUTTON><A onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 188px; HEIGHT: 15px; TOP: 145px; LEFT: 91px" id=showCont onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onclick="DjOpen('../../fceform/common/djframe.htm?djsn=zk_style_prop&amp;djtype=ZK&amp;type=2',objNav.config)" onresizestart=resizeStart() href="javascript:void(0)" target=_self controltype="a">设置本字段显示控件的样式</A><A onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 188px; HEIGHT: 15px; TOP: 169px; LEFT: 91px" id=showTd onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onclick="DjOpen('../../fceform/common/djframe.htm?djsn=zk_style_prop&amp;djtype=ZK&amp;type=3',objNav.config)" onresizestart=resizeStart() href="javascript:void(0)" target=_self controltype="a" href1>设置本字段所在单元格的样式</A><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 164px; LEFT: 288px" id=button2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;propWinFieldPermit(permitDs,'valueDisable')&quot;)">只读设置</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 138px; LEFT: 288px" id=button1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;propWinFieldPermit(permitDs,'valueHide')&quot;)">隐藏设置</BUTTON><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 150px; LEFT: 435px" id=permitDs onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" opensortno="1" issubds="否" savetable submitno="1" submittype="2" isaddemptyrec="否" pubpara="否" saveastable isSubGrid="否" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll masterdsfield masterds subdsfield idparam opensql formatxml='<root><tr rowstate="add"><td>valueDisable</td><td>新建字段</td><td>字符</td><td>3000</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>valueHide</td><td>新建字段</td><td>字符</td><td>3000</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>expDisable</td><td>新建字段</td><td>字符</td><td>3000</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>expHide</td><td>新建字段</td><td>字符</td><td>3000</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' datasourceName async="否"><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 271px; DISPLAY: none; HEIGHT: 20px; TOP: 1px; LEFT: 96px" id=tbname onresize=resize() onmove=move() disabled onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() size=48 controltype="text"></DIV>