<script>function uf_open(){&#13;&#10;	 var xmlpath = location.protocol + "//" + location.host + fcpubdata.path + "/zk/main/admin_design_menu.xml";&#13;&#10;    var oXml = SetDomFile(xmlpath);&#13;&#10;    var docE = oXml.documentElement;&#13;&#10;    uf_editCode(docE);&#13;&#10;    tree1.loadXmlStr(docE.xml);	&#13;&#10;    TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;    tree1.expandAll();&#13;&#10;    &#13;&#10;    var xmlpath = location.protocol + "//" + location.host + fcpubdata.path + "/zk/main/mobile_menu_set.xml";&#13;&#10;    var oXml = SetDomFile(xmlpath);&#13;&#10;    var docE2 = oXml.documentElement;&#13;&#10;    uf_editCode(docE2);&#13;&#10;    tree2.loadXmlStr(docE2.xml);&#13;&#10;    TreeRootNodeHide($id('tree2'), 'none');&#13;&#10;    tree2.expandAll();	&#13;&#10;    &#13;&#10;    var xmlpath = location.protocol + "//" + location.host + fcpubdata.path + "/zk/main/mobile_desktop_set.xml";&#13;&#10;    var oXml = SetDomFile(xmlpath);&#13;&#10;    var docE3 = oXml.documentElement;&#13;&#10;    uf_editCode(docE3);&#13;&#10;    tree3.loadXmlStr(docE3.xml);&#13;&#10;    TreeRootNodeHide($id('tree3'), 'none');&#13;&#10;    tree3.expand();	&#13;&#10;}&#13;&#10;&#13;&#10;function uf_editCode(oNode){&#13;&#10;	for(var i = 0; i < oNode.childNodes.length;i++){&#13;&#10;    	codeArr = oNode.childNodes[i].getAttribute("code").split(',');&#13;&#10;    	if(codeArr.length < 1) codeArr[0] = "";&#13;&#10;    	oNode.childNodes[i].setAttribute("code", codeArr[0]); &#13;&#10;    	if(oNode.childNodes.length > 0){&#13;&#10;    		uf_editCode(oNode.childNodes[i])&#13;&#10;    	}&#13;&#10;    }&#13;&#10;}&#13;&#10; &#13;&#10;function uf_selUnit(){&#13;&#10;		fcUserFunc.selectProfile('droProfile','profileId','profileName');&#13;&#10;		var sql = "select detail from  fcq_profilesub  where type = '1' and profileId='"+dataset1.Field('profileId').Value+"'";&#13;&#10;		var xmlRet = SelectSql(sql,1,-1);&#13;&#10;		var oXml = SetDom(xmlRet);&#13;&#10;		if (oXml.documentElement == null) {&#13;&#10;			alert(xmlRet);&#13;&#10;			return;&#13;&#10;		}&#13;&#10;		var profileList = "";&#13;&#10;		for (var j = 0; j < oXml.documentElement.childNodes.length -1;j++) {&#13;&#10;			profileList += oXml.documentElement.childNodes[j].childNodes[0].text;&#13;&#10;			if(j < oXml.documentElement.childNodes.length -2) profileList += ",";&#13;&#10;		}&#13;&#10;		uf_notSel($id('tree1'));&#13;&#10;		uf_notSel($id('tree2'));&#13;&#10;		uf_notSel($id('tree3'));&#13;&#10;		TreeSetMultiValue($id("tree1"),profileList);&#13;&#10;		TreeSetMultiValue($id("tree2"),profileList);&#13;&#10;		TreeSetMultiValue($id("tree3"),profileList);	&#13;&#10;		&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_save(){&#13;&#10;	var arr = TreeGetMultiValue($id("tree1"));&#13;&#10;	var arr2 = TreeGetMultiValue($id("tree2"));&#13;&#10;	var arr3 = TreeGetMultiValue($id("tree3"));&#13;&#10;	if(arr == null && arr2 == null && arr3 == null){&#13;&#10;		alert("没有选中任何功能点");&#13;&#10;	}else{&#13;&#10;		var xmlSql = "<delete tableName='fcq_profilesub'><where>  profileId= '"+ dataset1.Field('profileId').Value+"' and type=1 </where></delete>";&#13;&#10;		if(arr != null){&#13;&#10;			for(var i=0;i<arr.length;i++){&#13;&#10;				xmlSql += "<insert tableName='fcq_profilesub'><names> id,profileid,type,detail,permit  </names><values>'"+ getMaxNo('PRO') +"','"+dataset1.Field('profileId').Value+"',1,'"+ arr[i].code +"',1 </values></insert>";&#13;&#10;			}&#13;&#10;		}&#13;&#10;		if(arr2 != null){&#13;&#10;			for(var j=0;j<arr2.length;j++){&#13;&#10;				xmlSql += "<insert tableName='fcq_profilesub'><names> id,profileid,type,detail,permit  </names><values>'"+ getMaxNo('PRO') +"','"+dataset1.Field('profileId').Value+"',1,'"+ arr2[j].code +"',1 </values></insert>";&#13;&#10;			}&#13;&#10;		}&#13;&#10;		if(arr3 != null){&#13;&#10;			for(var l=0;l<arr3.length;l++){&#13;&#10;				xmlSql += "<insert tableName='fcq_profilesub'><names> id,profileid,type,detail,permit  </names><values>'"+ getMaxNo('PRO') +"','"+dataset1.Field('profileId').Value+"',1,'"+ arr3[l].code +"',1 </values></insert>";&#13;&#10;			}&#13;&#10;		}&#13;&#10;		doSaveData(xmlSql,function(){alert("配置成功");})&#13;&#10;&#13;&#10;	}&#13;&#10;}	&#13;&#10;function uf_notSel(obj) {	&#13;&#10;	var el = obj.document.getElementsByTagName("input");&#13;&#10;	for(var i=0;i<el.length;i++){&#13;&#10;		if(el[i].type == "checkbox"){&#13;&#10;			el[i].checked = false;	&#13;&#10;		}	&#13;&#10;	}&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" userToolbar='<tr rowstate="add"><td>save</td><td>提交数据成功后提示</td><td></td><td>uf_save()</td><td></td><td></td><td></td><td></td><td></td></tr>' toolbar="自定义工具栏" isCheckPermit="否" alertType="1" userType contxml="<root><label><id>label1</id><id>label2</id><id>label3</id><id>label4</id></label><dropdownlist><id>droProfile</id></dropdownlist><dataset><id>dataset1</id></dataset><tree><id>tree2</id><id>tree3</id><id>tree1</id></tree></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:4;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:1;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:1;grid:0;dataset:1;spin:0;excel:0;tree:5;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" billtaborder="<root><taborder>droProfile</taborder></root>" isfile="是" posheight poswidth postop posleft window="当前窗口" caption="配置功能点" type="ZK" dj_sn="zk_unit_setnew" BLONopen="uf_open()" center="  " BLONclose BLONopenBefore useHelp allBrowser="否" unselectable="on" envType="电脑" BLONresizeAfter BLONresizeBefore runParams><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 30%; HEIGHT: 534px; BORDER-TOP: 1px solid; TOP: 48px; BORDER-RIGHT: 1px solid; LEFT: 43%" id=tree2 class=control-border-color onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" datasourceName controltype="tree" AutoSizeXml="<record id ='tree2'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>5</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" ischecked="是" isAll="是" opentb="_self" sourcetype="0" roottext="全选" clicknode xml='<TreeNode id="1" text="" roottarget="_self" rootaction=""  target="_self" title=""  icon=""  check="undefined" code=""/>'><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 22%; HEIGHT: 523px; BORDER-TOP: 1px solid; TOP: 48px; BORDER-RIGHT: 1px solid; LEFT: 76%" id=tree3 class=control-border-color onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" datasourceName controltype="tree" AutoSizeXml="<record id ='tree3'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>5</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" ischecked="是" isAll="是" opentb="_self" sourcetype="0" roottext="全选" clicknode xml='<TreeNode id="1" text="" roottarget="_self" rootaction=""  target="_self" title=""  icon=""  check="undefined" code=""/>'><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 141px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 25px; FONT-SIZE: 16px; TOP: 28px; FONT-WEIGHT: bold; LEFT: 6px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">主菜单</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; TEXT-ALIGN: left; WIDTH: 103px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 25px; FONT-SIZE: 16px; TOP: 28px; FONT-WEIGHT: bold; LEFT: 43%" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">手机主菜单</LABEL><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; TEXT-ALIGN: left; WIDTH: 141px; DISPLAY: block; FONT-FAMILY: 宋体; HEIGHT: 25px; FONT-SIZE: 16px; TOP: 28px; FONT-WEIGHT: bold; LEFT: 76%" id=label3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">手机桌面</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 353px; HEIGHT: 20px; TOP: 5px; LEFT: 45px; ButtonWidth: 10" id=droProfile onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_fccode.gif" datasourceName controltype="dropdownlist" tempvalue temptext sql check="1" xml china="角色名称" format onclickopen='bill_onclick("uf_selUnit()")' FieldNameList isTreeNewSql="0" isShowTree="0" blninput="否" blnempty="否" addrow="否" multiselect="否" field="profileName" visible="是" dataset="dataset1"><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 65px; HEIGHT: 15px; TOP: 8px; LEFT: 5px" id=label4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="label" inputTag="否">角色</LABEL><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 1px; LEFT: 664px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" queryTableName="FCQ_PROFILE" datasourceName async="否" idtype="1" isSubGrid="否" saveastable pubpara="否" isaddemptyrec="否" submittype="1" submitno="1" savetable issubds="否" opensortno="1" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll formatxml="<root><tr rowstate=&quot;add&quot;><td>profileid</td><td>角色id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>profileName</td><td>角色名称</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td>$valid('汉字、字母、数字或_');$valid('字段值不重复');$valid('值已存在');</td><td></td><td></td><td></td><td></td><td></td></tr></root>" masterdsfield masterds subdsfield idparam opensql controltype="dataset"><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 40%; HEIGHT: 536px; BORDER-TOP: 1px solid; TOP: 47px; BORDER-RIGHT: 1px solid; LEFT: 3px" id=tree1 class=control-border-color onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" datasourceName controltype="tree" AutoSizeXml="<record id ='tree1'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>5</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>" ischecked="是" isAll="是" opentb="_self" sourcetype="0" roottext="全选" clicknode xml='<TreeNode id="1" text="" roottarget="_self" rootaction=""  target="_self" title=""  icon=""  check="undefined" code=""/>'></DIV>