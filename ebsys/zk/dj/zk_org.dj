<script>var treeClickCode= "";//树控件上单击节点的code值&#13;&#10;var arrName = new Array();//同级下的名称字段&#13;&#10;var arrCode = new Array();//同级下的编号字段&#13;&#10;&#13;&#10;function uf_open(){&#13;&#10;	TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;}&#13;&#10;function uf_clickTree(nodeValue){//单击树控件要获取单击节点和子节点，还有最大顺序号&#13;&#10;	treeClickCode = nodeValue;&#13;&#10;	var sWhere = "where  deleteMark <> 1 and sParent='"+nodeValue+"'order by sortNo";&#13;&#10;	if(IsSpace(nodeValue) == true)  sWhere = "where  deleteMark <> 1 and sParent is null ";&#13;&#10;	dataset1.Open("select SCODE, SFCODE, SFID, SFNAME, SID, SLEVEL, SLONGNAME, SNAME, SORGKINDID, SPARENT, SPERSONID,SORGKINDID as SORGKINDID1 ,sortNo  from FCQ_ORG "+sWhere);//子节点的信息&#13;&#10;	dataset3.Open("select  SFCODE, SFID, SFNAME, SID, SORGKINDID   from FCQ_ORG where SID='"+nodeValue+"' and deleteMark <> 1");//单击节点的信息&#13;&#10;	uf_cmdDisable();//添加按钮是否要禁用&#13;&#10;	//dataset3.Field('sSequence').Value = dataset3.Field('sSequence').Value +"/"+ uf_maxSort();&#13;&#10;}&#13;&#10;&#13;&#10;function uf_cmdDisable(){//添加按钮禁用功能&#13;&#10;	var sOrgKindID = dataset3.Field('SORGKINDID').Value;&#13;&#10;	var disable1 = false;&#13;&#10;	var disable2 = false;&#13;&#10;	var disable3 = false;&#13;&#10;	var disable4 = false;&#13;&#10;	if(sOrgKindID == "dpt"){&#13;&#10;	 	disable1 = true;	&#13;&#10;	}else if(sOrgKindID == "pos"){&#13;&#10;	 	disable1 = true;&#13;&#10;	 	disable2 = true;&#13;&#10;	 	disable3 = true;	&#13;&#10;	}else if(sOrgKindID == "psm" || sOrgKindID == "usr"){&#13;&#10;	 	disable1 = true;&#13;&#10;	 	disable2 = true;&#13;&#10;	 	disable3 = true;&#13;&#10;	 	disable4 = true;	&#13;&#10;	}&#13;&#10;	parent.toolbar.$id('ogn').disabled = disable1;&#13;&#10;	parent.toolbar.$id('dpt').disabled = disable2;&#13;&#10;	parent.toolbar.$id('pos').disabled = disable3;&#13;&#10;	parent.toolbar.$id('psm').disabled = disable4;&#13;&#10;	parent.toolbar.$id('usr').disabled = disable4;&#13;&#10;}&#13;&#10;&#13;&#10;function uf_maxSort(){//获取最大顺序号&#13;&#10;	var maxInt=1;&#13;&#10;	if(dataset1.RecordCount < 0){&#13;&#10;		 dataset3.Field('sSequence').Value 	= "001";&#13;&#10;	}else{&#13;&#10;		for(var i=0;i<dataset1.oDom.documentElement.childNodes.length-1;i++){&#13;&#10;			var sortCode = dataset1.oDom.documentElement.childNodes[i].childNodes[1].text;&#13;&#10;		}&#13;&#10;	}&#13;&#10;	maxInt += 1;&#13;&#10;	var str = "";&#13;&#10;	maxInt += "";&#13;&#10;	if(maxInt.length == 1){&#13;&#10;		str = "00";&#13;&#10;	}else if(maxInt.length == 2){&#13;&#10;		str = "0";&#13;&#10;	}&#13;&#10;	maxInt = str+maxInt;&#13;&#10;	return maxInt;&#13;&#10;}&#13;&#10;&#13;&#10;function uf_deleteMark(){&#13;&#10;	if(IsSpace(grid1.Row) == false){//是否选中表格当前行&#13;&#10;		if(dataset3.Field('SORGKINDID').Value == "ogn" || dataset3.Field('SORGKINDID').Value == "dpt" || dataset3.Field('SORGKINDID').Value == "pos"){//如果不是用户和职员需要检查一下是否有下级记录&#13;&#10;			var isSub = SqlToField("select sName from fcq_org where sParent='"+dataset1.Field('sID').Value+"' and deleteMark=0");&#13;&#10;			if(!IsSpace(isSub)) {alert("先删除“" + dataset1.Field('sName').Value + "”的下级记录后,在删除当前记录");return;}&#13;&#10;		}&#13;&#10;		var ret = window.confirm("确定删除当前行信息吗？");	&#13;&#10;		if(ret == false) return;&#13;&#10;		var xmlSql= "<update tableName='fcq_org'><set>deleteMark=1</set><where> sID='"+dataset1.Field('sID').Value+"' </where> </update>"&#13;&#10;		doSaveData(xmlSql,function (){	alert("删除成功");$id("tree1").innerHTML="";TreeRefresh($id("tree1"));TreeRootNodeHide($id('tree1'), 'none');}); &#13;&#10;		uf_clickTree(dataset1.Field('sParent').Value);&#13;&#10;		tree1.FindNode(tree1,"code",dataset1.Field('sParent').Value);&#13;&#10;	}else{&#13;&#10;		alert("选中表格中的行记录，才能进行删除操作");&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;function uf_moveUp(isUp){&#13;&#10;	if(IsSpace(grid1.Row) == false){&#13;&#10;		if(isUp == true){&#13;&#10;			GridChangeRowSort(true,grid1);&#13;&#10;		}else{&#13;&#10;			GridChangeRowSort(false,grid1);&#13;&#10;		}&#13;&#10;	}&#13;&#10;}&#13;&#10;function uf_add(argName){//ogn 组织,dpt 部门,pos岗位,psm人员&#13;&#10;	dataset3.Field('SORGKINDID').Value = argName;&#13;&#10;	dataset1.Field('SID').Value = "";//实现新增&#13;&#10;	/*if(argName == "psm") {//psm人员&#13;&#10;		DjOpen("zk_person_Card",[dataset1,dataset3]);                  &#13;&#10;	}else{&#13;&#10;		DjOpen("zk_org_card",[dataset1,dataset3]);&#13;&#10;	}*/&#13;&#10;	DjOpen("zk_org_card",[dataset1,dataset3]);&#13;&#10;	$id("tree1").innerHTML="";&#13;&#10;	TreeRefresh($id("tree1"));	&#13;&#10;	TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;	uf_clickTree(treeClickCode);&#13;&#10;	tree1.FindNode(tree1,"code",dataset1.Field('sParent').Value);&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_updata(argName){&#13;&#10;	if(IsSpace(grid1.Row) == false){&#13;&#10;		if(argName == "psm") {//psm人员&#13;&#10;			alert("类型为人员的不修改");&#13;&#10;			return;&#13;&#10;			//DjOpen("zk_person_Card",[dataset1,dataset3]);                  &#13;&#10;		}/*else{&#13;&#10;			DjOpen("zk_org_card",[dataset1,dataset3]);&#13;&#10;		}*/&#13;&#10;		dataset3.Field('editId').Value = dataset1.Field('sID').Value;&#13;&#10;		DjOpen("zk_org_card",[dataset1,dataset3]);&#13;&#10;		$id("tree1").innerHTML="";&#13;&#10;		TreeRefresh($id("tree1"));&#13;&#10;		TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;		uf_clickTree(treeClickCode);&#13;&#10;		tree1.FindNode(tree1,"code",dataset1.Field('sParent').Value);&#13;&#10;	}else{&#13;&#10;		alert("选中表格中的行记录，才能进行修改操作");&#13;&#10;	}	&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_allotEmployee(){&#13;&#10;	if(IsSpace(dataset3.Field('sId').Value)){alert("请选择职员的上级");return}&#13;&#10;	var ret = DjOpen("zk_employee_allot",dataset3);&#13;&#10;	if(ret != "ok") return;//取消不刷新&#13;&#10;	$id("tree1").innerHTML="";&#13;&#10;	TreeRefresh($id("tree1"));	&#13;&#10;	TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;	uf_clickTree(treeClickCode);&#13;&#10;	tree1.FindNode(tree1,"code",dataset1.Field('sParent').Value);&#13;&#10;&#13;&#10;}&#13;&#10;function uf_allotUser(){&#13;&#10;	if(IsSpace(dataset3.Field('sId').Value)){alert("请选择用户的上级");return}&#13;&#10;	var ret = DjOpen("zk_user_allot",dataset3);&#13;&#10;	if(ret != "ok") return;//取消不刷新&#13;&#10;	$id("tree1").innerHTML="";&#13;&#10;	TreeRefresh($id("tree1"));	&#13;&#10;	TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;	uf_clickTree(treeClickCode);&#13;&#10;	tree1.FindNode(tree1,"code",dataset1.Field('sParent').Value);&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;function uf_upMove(){&#13;&#10;	$eform('上移');&#13;&#10;	$id("tree1").innerHTML="";&#13;&#10;	TreeRefresh($id("tree1"));	&#13;&#10;	TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;	tree1.FindNode(tree1,"code",dataset1.Field('sParent').Value);&#13;&#10;}&#13;&#10;&#13;&#10;function uf_downMove(){&#13;&#10;	$eform('下移');&#13;&#10;	$id("tree1").innerHTML="";&#13;&#10;	TreeRefresh($id("tree1"));	&#13;&#10;	TreeRootNodeHide($id('tree1'), 'none');&#13;&#10;	tree1.FindNode(tree1,"code",dataset1.Field('sParent').Value);&#13;&#10;}&#13;&#10;&#13;&#10;function uf_editTopOrg(){&#13;&#10;	if(Global.selectedItem.parent == Global.selectedItem.root()){&#13;&#10;		var sID = Global.selectedItem.code;//sID字段&#13;&#10;		var text = Global.selectedItem.text;&#13;&#10;		var code = SqlToField("select sCode from fcq_org where sId='"+sID+"'") ;&#13;&#10;		var ret = DjOpen('zk_edit_org',[code,text]);&#13;&#10;		if(!IsSpace(ret)){&#13;&#10;			var type = 1;//1表示修改编号，2表示修改名称，3表示名称编号都修改&#13;&#10;			var arr = ret.split(",");&#13;&#10;			if(code == Trim(arr[0]) && text == Trim(arr[1])) {&#13;&#10;				return;&#13;&#10;			}else	if(code != Trim(arr[0]) && text!= Trim(arr[1])){&#13;&#10;				type = 3;&#13;&#10;			}else	if( text != Trim(arr[1])){&#13;&#10;				type = 2;&#13;&#10;			}else{type = 1;}&#13;&#10;			&#13;&#10;			var arr = ret.split(',');&#13;&#10;			var xmlSql = uf_updataSql(arr,sID,code,text,type);&#13;&#10;			doSaveData(xmlSql,function(){alert("修改成功");$id("tree1").innerHTML="";TreeRefresh($id("tree1"));TreeRootNodeHide($id('tree1'), 'none');})&#13;&#10;			 &#13;&#10;		}&#13;&#10;	}else{&#13;&#10;		alert("只能编辑顶级机构");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	&#13;&#10;}&#13;&#10;&#13;&#10;function uf_updataSql(arr,sID,code,text,type){//改变一级节点的编号和名称后生产updata语句 arr是修改后的编号和名称字段&#13;&#10;	var xmlSql = "";&#13;&#10;	var sFID = "/"+sID;&#13;&#10;	var sql = "select sFCode,sFName,sID from  fcq_org where  sFID like '"+sFID+"%' ";&#13;&#10;	var xmlRet = SelectSql(sql,1,-1);&#13;&#10;	var oXml = SetDom(xmlRet);&#13;&#10;	if (oXml.documentElement == null) {&#13;&#10;	    alert(xmlRet);&#13;&#10;	    return;&#13;&#10;	}&#13;&#10;	var len = oXml.documentElement.childNodes.length - 1;&#13;&#10;    for (var i = 0; i < len; i++) {&#13;&#10;        var sFCode = oXml.documentElement.childNodes[i].childNodes[0].text;&#13;&#10;        sFCode = "/"+Trim(arr[0])+sFCode.substring(code.length+1, sFCode.length); &#13;&#10;        //var sFCodeA = sFCode.split("/"+code+"/");&#13;&#10;        //if(sFCodeA[0] == "" && sFCodeA.length == 2)  sFCode = "/"+arr[0]+"/"+sFCodeA[1]&#13;&#10;        var sFName = oXml.documentElement.childNodes[i].childNodes[1].text;&#13;&#10;        sFName = "/"+Trim(arr[1])+sFName.substring(text.length+1, sFName.length); &#13;&#10;        //var sFNameA = sFName.split("/"+text+"/");&#13;&#10;        //if(sFNameA[0] == "" && sFCodeA.length == 2)  sFName = "/"+arr[1]+"/"+sFNameA[1]&#13;&#10;        var id =  oXml.documentElement.childNodes[i].childNodes[2].text; &#13;&#10;        if(type == 1){&#13;&#10;        	xmlSql += "<update tableName='fcq_org'><set>sFCode='"+ sFCode +"'</set><where> sID = '"+ id  +"'</where></update>";&#13;&#10;        }else if(type == 2){&#13;&#10;        	xmlSql += "<update tableName='fcq_org'><set>sFName='"+ sFName +"'</set><where> sID = '"+ id  +"'</where></update>";&#13;&#10;        }else{&#13;&#10;        	xmlSql += "<update tableName='fcq_org'><set>sFCode='"+ sFCode +"' ,sFName='"+ sFName +"'</set><where> sID = '"+ id  +"'</where></update>";&#13;&#10;        }&#13;&#10;    }&#13;&#10;    xmlSql += "<update tableName='fcq_org'><set>sCode='"+ arr[0] +"' ,sName='"+ arr[1] + "', sFCode='/"+ arr[0] +"' ,sFName='/"+ arr[1]  +"'</set><where> sID = '"+ sID +"'</where></update>";&#13;&#10;	//CopyToPub(xmlSql)&#13;&#10;	return xmlSql;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true toolbar="自定义工具栏" contxml="<root><grid><id>grid1</id></grid><dataset><id>dataset1</id><id>dataset3</id></dataset><tree><id>tree1</id></tree></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:6;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:3;div:0;DsMain_field:0;a:1;button:15;text:6;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:2;dataset:4;spin:0;excel:0;tree:5;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen="uf_open();" window="当前窗口" posheight poswidth postop posleft center="  " isfile="是" type="ZK" caption="组织机构" dj_sn="zk_org" billtaborder="<root><taborder>grid1</taborder></root>" envType="电脑" useHelp allBrowser="否" BLONresizeAfter BLONresizeBefore runParams jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" idtype="1" userToolbar="<tr rowstate=&quot;add&quot;><td>ogn</td><td>新建机构</td><td>新建机构</td><td>uf_add('ogn')</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>dpt</td><td>新建部门</td><td>新建部门</td><td>uf_add('dpt')</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>pos</td><td>新建岗位</td><td>新建岗位</td><td>uf_add('pos')</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>psm</td><td>分配人员</td><td>分配职员</td><td>uf_allotEmployee()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>usr</td><td>分配用户</td><td>分配用户</td><td>uf_allotUser()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>editOrg</td><td></td><td>编辑机构</td><td>uf_editTopOrg()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>edit</td><td>修改保存</td><td></td><td>uf_updata(dataset1.Field('SORGKINDID').Value)</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>del</td><td>删除</td><td></td><td>uf_deleteMark()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>upmove</td><td>上移</td><td></td><td>uf_upMove()</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>downmove</td><td>下移</td><td></td><td>uf_downMove()</td><td></td><td></td><td></td><td></td><td></td></tr>" keyfield="sid" entertype="展现" codeheader="CSM" OtherSave="否" runsave mkbh unselectable="on"><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 316px; DISPLAY: block; HEIGHT: 610px; BORDER-TOP: 1px solid; TOP: 0px; BORDER-RIGHT: 1px solid; LEFT: 6px" id=tree1 class=control-border-color onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" clicknode=" &#13;&#10;uf_clickTree(Global.selectedItem.code)&#13;&#10; &#13;&#10;&#13;&#10; " roottext sourcetype="3" ischecked="否" isAll="是" opentb="_self" datasourceName sql2="select  sID,sParent,sName,sID,sOrgKindId from FCQ_org  where deleteMark=0 order by sortNo" xml='<TreeNode id="1" text="treeItem" roottarget="_self" rootaction=""  target="_self" title="treeItem"  icon=""  check="undefined" code=""><TreeNode id="2" text="增加节点"  target="_self" title="增加节点"  icon=""  check="undefined" code=""/></TreeNode>' controltype="tree" sql AutoSizeXml="<record id ='tree1'><Halign>不动</Halign><HWidth></HWidth><HUnit>px</HUnit><WSetType>百分比设置</WSetType><Width></Width><WExt></WExt><WSetUnit>px</WSetUnit><MinW></MinW><Palign>不动</Palign><PWidth></PWidth><PUnit>px</PUnit><HSetType>伸缩设置</HSetType><Height></Height><HExt>5</HExt><HSetUnit>px</HSetUnit><MinH></MinH></record>"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 778px; HEIGHT: 369px; TOP: 0px; LEFT: 329px" id=grid1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" blRowNo="否" hideHscroll="auto" visible="是" bodyrows="-1" bodyrowheight="-1" hideVscroll="否" SetRowHeight="是" readonly="是" autoappend="否" autowidth="是" autoheight="是" canselect="是" dataset="dataset1" titlerowheight titlerows usertitlehtml usertitle iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0"><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 219px; LEFT: 947px" id=dataset1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" datasourceName controltype="dataset" issubds="否" submitno="1" submittype="1" isaddemptyrec="否" pubpara="否" opensortno="1" isSubGrid="否" async="否" fieldtrans="<root><field><name>SORGKINDID1</name><trans></trans><rtrans></rtrans><sql>select%20code%20%20as%20SORGKINDID%20%2Cname%20as%20SORGKINDID1%20from%20fc_datadict%20where%20typename%3D%27%u7EC4%u7EC7%u5355%u5143%u7C7B%u578B%27</sql></field></root>" savetable="FCQ_ORG" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll saveastable queryTableName="FCQ_ORG" formatxml="<root><tr rowstate=&quot;add&quot;><td>SID</td><td>id字段</td><td>字符</td><td>130</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sSequence</td><td>顺序号</td><td>字符</td><td>200</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SCODE</td><td>编号</td><td>字符</td><td>128</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>是</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>120</td><td></td><td></td><td></td><td></td><td></td><td>uf_updata(dataset1.Field('SORGKINDID').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SNAME</td><td>名称</td><td>字符</td><td>256</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>200</td><td></td><td></td><td></td><td></td><td></td><td>uf_updata(dataset1.Field('SORGKINDID').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SLONGNAME</td><td>长名称</td><td>字符</td><td>510</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>200</td><td></td><td></td><td></td><td></td><td></td><td>uf_updata(dataset1.Field('SORGKINDID').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SFNAME</td><td>全路径名称</td><td>字符</td><td>4096</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>300</td><td></td><td></td><td></td><td></td><td></td><td>uf_updata(dataset1.Field('SORGKINDID').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SFCODE</td><td>全路径编号</td><td>字符</td><td>4096</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SFID</td><td>全路径id</td><td>字符</td><td>4096</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot; multisel=&quot;是&quot;><td>SLEVEL</td><td>级别</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SORGKINDID</td><td>类型</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SORGKINDID1</td><td>类型</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>60</td><td></td><td></td><td></td><td></td><td></td><td>uf_updata(dataset1.Field('SORGKINDID').Value)</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SPARENT</td><td>父id</td><td>字符</td><td>64</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>SPERSONID</td><td>人员id</td><td>字符</td><td>64</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>DELETEMARK</td><td>删除标记</td><td>整数</td><td>4</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sortNo</td><td>顺序号</td><td>整数</td><td>4</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" masterdsfield masterds subdsfield opensql idparam><IMG onresizeend=resizeEnd() style="POSITION: absolute; WIDTH: 39px; HEIGHT: 47px; TOP: 271px; LEFT: 676px" id=dataset3 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" datasourceName controltype="dataset" issubds="否" submitno="1" submittype="1" isaddemptyrec="否" pubpara="否" opensortno="1" isSubGrid="否" async="否" savetable AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll saveastable queryTableName="FCQ_ORG" formatxml='<root><tr rowstate="add"><td>SFCODE</td><td>全路径编号</td><td>字符</td><td>4096</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>SFID</td><td>全路径id</td><td>字符</td><td>4096</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>SFNAME</td><td>全路径名称</td><td>字符</td><td>4096</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>SID</td><td>id字段</td><td>字符</td><td>130</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>SORGKINDID</td><td>类型</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>sSequence</td><td>顺序号</td><td>字符</td><td>200</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>editId</td><td>修改记录的id</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' masterdsfield masterds subdsfield opensql idparam></DIV>