<script>&#13;&#10;function datasetRowValue(){&#13;&#10;	txtId.value = dataset1. Field("semployeeid").Value;//用dataset1. Field("semployeeid").Value获取集数据集当前行semployeeid字段值&#13;&#10;	txtCode.value = dataset1. Field("semployeecode").Value;//用dataset1. Field("semployeecode").Value获取集数据集当前行semployeecode字段值&#13;&#10;	txtName.value = dataset1. Field("semployeename").Value;//用dataset1. Field("semployeename").Value获取集数据集当前行semployeename字段值&#13;&#10;	txtSex.value = dataset1. Field("ssex").Value;//用dataset1. Field("ssex").Value获取集数据集当前行ssex字段值&#13;&#10;}&#13;&#10;&#13;&#10;function updataXml(){&#13;&#10;	dataset1. Field("semployeeid").Value = txtId.value;&#13;&#10;	dataset1. Field("semployeecode").Value = txtCode.value;&#13;&#10;	dataset1. Field("semployeename").Value = txtName.value ;&#13;&#10;	dataset1. Field("ssex").Value = txtSex.value;&#13;&#10;	dataset1.Update('不检查');//提交数据集当前行数组中的数据到数据集的xml数据中&#13;&#10;	textareaXmlData.value=dataset1.xml;//把数据集的xml数据赋给textarea控件&#13;&#10;}	&#13;&#10;&#13;&#10;function viewXml(){//获取数据集的xml记录&#13;&#10;&#13;&#10;	textareaXmlData.value =dataset1.xml;&#13;&#10;}&#13;&#10;&#13;&#10;function selectRow(){//选择数据集的当前行&#13;&#10;	//dataset1.SetPos(2);&#13;&#10;	dataset1.dset_fset(1);//数据集dataset1的数据区的xml数据刷新到数据集的当前行&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js" mkbh runsave codeheader="BBB" keyfield entertype="修改" OtherSave="否" idtype="1" unselectable="on" contxml="<root><label><id>label19</id><id>label21</id><id>label22</id><id>label23</id><id>label24</id><id>label25</id><id>label27</id><id>label28</id></label><textarea><id>textareaXmlData</id></textarea><shape><id>shape1</id><id>shape2</id><id>shape3</id><id>shape5</id><id>shape7</id><id>shape10</id><id>shape12</id></shape><button><id>button5</id><id>button9</id><id>button16</id><id>button19</id><id>button20</id><id>button21</id><id>button22</id><id>button17</id><id>button25</id></button><text><id>txtName</id><id>txtCode</id><id>txtId</id><id>txtSex</id></text><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:28;radio:1;listbox:0;textarea:6;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:1;SKBILLgrid:0;shape:13;tab:0;div:0;DsMain_field:0;a:0;button:25;text:14;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:2;dataset:3;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" billtaborder="<root><taborder>button5</taborder><taborder>button9</taborder><taborder>textareaXmlData</taborder><taborder>button16</taborder><taborder>button19</taborder><taborder>button20</taborder><taborder>button21</taborder><taborder>button22</taborder><taborder>button17</taborder><taborder>txtName</taborder><taborder>txtCode</taborder><taborder>txtId</taborder><taborder>txtSex</taborder><taborder>button25</taborder></root>" isCheckPermit="否" alertType="1" userType BLONclose BLONopenBefore BLONopen window="当前窗口" toolbar="不带工具栏" posheight poswidth postop posleft center="  " isfile="是" type="FT" caption="数据流向示例" dj_sn="help_6_6_controlData3"><IMG id=dataset1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 1188px; WIDTH: 39px; POSITION: absolute; TOP: 199px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" idtype="1" queryTableName="FCS_EMPLOYEE" datasourceName formatxml="<root><tr rowstate=&quot;add&quot;><td>semployeeid</td><td>职员id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>semployeecode</td><td>职员编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80px</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>semployeename</td><td>职员名称</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80px</td><td></td><td></td><td>$valid('汉字、字母、数字或_');$valid('字段值不重复');$valid('值已存在');</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>ssex</td><td>性别</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td>女</td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>100px</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" AfterScroll BeforeScroll AfterPost BeforePost AfterOpen async="否" masterdsfield masterds subdsfield issubds="否" idparam savetable submitno="1" submittype="1" BeforeOpen opensql="select top  3 FCS_EMPLOYEE.semployeecode,FCS_EMPLOYEE.semployeeid,FCS_EMPLOYEE.semployeename,FCS_EMPLOYEE.ssex from FCS_EMPLOYEE" isSubGrid="否" isaddemptyrec="否" pubpara="否" saveastable controltype="dataset" opensortno="1"><BUTTON onmove=move() oncontrolselect=controlselect() id=button5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 79px; WIDTH: 218px; POSITION: absolute; TOP: 3px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("datasetRowValue()")' dropstyle="否">数据集的当前行数组中的数据</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button9 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 701px; WIDTH: 172px; POSITION: absolute; TOP: 4px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("updataXml()")' dropstyle="否">修改数据集的XML结构的数据</BUTTON><?xml:namespace prefix = v /><v:line id=shape1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize="" style="LEFT: 7px; WIDTH: 1172px; POSITION: absolute; TOP: 210px; HEIGHT: 11px" onmovestart=moveStart() controltype="shape" cover="9" linetype="横线" from = "0,0" to = "879pt,0" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:line><v:line id=shape2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize="" style="LEFT: 6px; WIDTH: 1152px; POSITION: absolute; TOP: 37px; HEIGHT: 15px" onmovestart=moveStart() controltype="shape" cover="9" linetype="横线" from = "0,0" to = "12in,0" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:line><v:RoundRect id=shape3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 11px; WIDTH: 451px; POSITION: absolute; TOP: 38px; HEIGHT: 169px" onmovestart=moveStart() controltype="shape" cover="9" arcsize = "4321f" coordsize = "21600,21600" fillcolor = "#e3e3e3" strokecolor = "#dfdfdf" strokeweight = ".75pt"><v:stroke></v:stroke></v:RoundRect>&nbsp; <v:RoundRect id=shape5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 620px; WIDTH: 541px; POSITION: absolute; TOP: 41px; HEIGHT: 160px" onmovestart=moveStart() controltype="shape" cover="9" arcsize = "4321f" coordsize = "21600,21600" fillcolor = "#d9ecff" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:RoundRect><LABEL onmove=move() oncontrolselect=controlselect() id=label19 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 637px; WIDTH: 72px; POSITION: absolute; TOP: 57px; HEIGHT: 150px" onmovestart=moveStart() controltype="label" inputTag="否">用数据集的Update('不检查')方法将数据集当前行数组中的数据提交到数据集的xml数据区:</LABEL><TEXTAREA onmove=move() oncontrolselect=controlselect() id=textareaXmlData onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 734px; WIDTH: 414px; POSITION: absolute; TOP: 48px; HEIGHT: 147px" onmovestart=moveStart() rows=1 cols=80 controltype="textarea" induce="否" value="textarea6"></TEXTAREA><v:line id=shape7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize="" style="LEFT: 476px; WIDTH: 86px; POSITION: absolute; TOP: 15px; HEIGHT: 15px" onmovestart=moveStart() controltype="shape" cover="9" linetype="右箭头" from = "0,0" to = "64.5pt,0" fillcolor = "white" strokecolor = "blue" strokeweight = "2pt"><v:stroke endarrow = "classic"></v:stroke></v:line><BUTTON onmove=move() oncontrolselect=controlselect() id=button16 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 75px; WIDTH: 194px; POSITION: absolute; TOP: 216px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("datasetRowValue()")' dropstyle="否">数据集当前行数组中的数据</BUTTON><v:line id=shape10 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize="" style="LEFT: 487px; WIDTH: 75px; POSITION: absolute; TOP: 232px; HEIGHT: 18px" onmovestart=moveStart() controltype="shape" cover="9" linetype="左箭头" from = "0,0" to = "56.25pt,0" fillcolor = "white" strokecolor = "blue" strokeweight = "2pt"><v:stroke startarrow = "open"></v:stroke></v:line><v:Rect id=shape12 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 642px; WIDTH: 270px; POSITION: absolute; TOP: 214px; HEIGHT: 94px" onmovestart=moveStart() controltype="shape" cover="9" coordsize = "21600,21600" fillcolor = "white" strokecolor = "silver" strokeweight = ".75pt"><v:stroke></v:stroke></v:Rect> <LABEL onmove=move() oncontrolselect=controlselect() id=label21 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 653px; WIDTH: 66px; POSITION: absolute; TOP: 224px; HEIGHT: 30px" onmovestart=moveStart() controltype="label" inputTag="否">选数据集某行记录到数据集的当前行数组中：</LABEL><BUTTON onmove=move() oncontrolselect=controlselect() id=button19 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 733px; WIDTH: 75px; POSITION: absolute; TOP: 220px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("dataset1.MoveFirst()")'>第一条记录</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button20 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 814px; WIDTH: 75px; POSITION: absolute; TOP: 220px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("dataset1.MovePrev() ;")'>上一条记录</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button21 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 733px; WIDTH: 75px; POSITION: absolute; TOP: 248px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("dataset1.MoveNext() ;")'>下一条记录</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button22 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 814px; WIDTH: 85px; POSITION: absolute; TOP: 246px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("dataset1.MoveLast();")'>最后一条记录</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button17 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 733px; WIDTH: 90px; POSITION: absolute; TOP: 275px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("dataset1.SetPos(1)")' dropstyle="否">指定记录号</BUTTON><LABEL onmove=move() oncontrolselect=controlselect() id=label22 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 42px; WIDTH: 292px; POSITION: absolute; TOP: 51px; HEIGHT: 19px" onmovestart=moveStart() controltype="label" inputTag="否">数据集当前行记录中semployeeid字段的值是</LABEL><LABEL onmove=move() oncontrolselect=controlselect() id=label23 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 47px; WIDTH: 158px; POSITION: absolute; TOP: 75px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" inputTag="否">semployeecode字段的值是</LABEL><LABEL onmove=move() oncontrolselect=controlselect() id=label24 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 47px; WIDTH: 158px; POSITION: absolute; TOP: 100px; HEIGHT: 20px" onmovestart=moveStart() controltype="label" inputTag="否">semployeename字段的值是</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=txtName onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; LEFT: 203px; BORDER-LEFT: 0px; WIDTH: 120px; POSITION: absolute; TOP: 100px; HEIGHT: 20px" onmovestart=moveStart() size=21 controltype="text"><INPUT onmove=move() oncontrolselect=controlselect() id=txtCode onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; LEFT: 204px; BORDER-LEFT: 0px; WIDTH: 121px; POSITION: absolute; TOP: 73px; HEIGHT: 20px" onmovestart=moveStart() size=22 controltype="text"><INPUT onmove=move() oncontrolselect=controlselect() id=txtId onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; LEFT: 299px; BORDER-LEFT: 0px; WIDTH: 94px; POSITION: absolute; TOP: 47px; HEIGHT: 20px" onmovestart=moveStart() size=16 controltype="text"><LABEL onmove=move() oncontrolselect=controlselect() id=label25 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 50px; WIDTH: 102px; POSITION: absolute; TOP: 124px; HEIGHT: 19px" onmovestart=moveStart() controltype="label" inputTag="否">ssex字段的值是</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=txtSex onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; LEFT: 145px; BORDER-LEFT: 0px; WIDTH: 118px; POSITION: absolute; TOP: 123px; HEIGHT: 20px" onmovestart=moveStart() size=19 controltype="text"> <LABEL onmove=move() oncontrolselect=controlselect() id=label27 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 278px; WIDTH: 106px; POSITION: absolute; TOP: 127px; HEIGHT: 21px" onmovestart=moveStart() controltype="label" inputTag="否">，修改控件的值后</LABEL><LABEL onmove=move() oncontrolselect=controlselect() id=label28 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 44px; WIDTH: 332px; POSITION: absolute; TOP: 147px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" inputTag="否">可以把控件的值赋给数据集当前行的字段中(用dataset1.Field('字段名').Value=txtId.value)，用数据集的Update('不检查')方法提交到数据集的xml数据中</LABEL><BUTTON onmove=move() oncontrolselect=controlselect() id=button25 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 1026px; WIDTH: 133px; POSITION: absolute; TOP: 6px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("viewXml()")'>查看数据集的xml数据</BUTTON></DIV>