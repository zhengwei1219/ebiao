<script>var tablename=""; //表名&#13;&#10;&#13;&#10;function uf_open() {&#13;&#10;	tablename=parent.Request.QueryString('tablename').toString(); &#13;&#10;	e_PropWinOnload();&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_ok(){//单击确定按钮返回选择的查询条件&#13;&#10;	var sRet = '';&#13;&#10;	sRet = new Eapi.Str().trim( uf_where());&#13;&#10;	if(sRet == ""){&#13;&#10;		alert("生成的SQL语句为空!");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	window.returnValue = [sRet];&#13;&#10;	CloseBill();&#13;&#10;}&#13;&#10;function uf_where(){//拼接条件语句&#13;&#10;	var l = grid2.Rows;&#13;&#10;	var sWhere = "";&#13;&#10;	var zifu="";&#13;&#10;	for(var i=1;i<l;i++){&#13;&#10;		var fdtype = grid2.tab.rows(i).cells(8).innerText;&#13;&#10;		&#13;&#10;		var fdName = grid2.tab.rows(i).cells(7).innerText;&#13;&#10;		if(fdtype == "字符") zifu="'";&#13;&#10;		var sOr = "";&#13;&#10;		if(i<l-1) {&#13;&#10;			if(grid2.tab.rows(i).cells(6).innerText == "或者"){&#13;&#10;				sOr =  " or ";&#13;&#10;			}else  {&#13;&#10;				sOr = " and ";&#13;&#10;			}&#13;&#10;		}&#13;&#10;		var reg =  /[\']/;&#13;&#10;		var ret = !reg.test(grid2.tab.rows(i).cells(4).innerText);&#13;&#10;		if(ret == false){&#13;&#10;			alert('不能有单引号');&#13;&#10;			return;&#13;&#10;		}&#13;&#10;        if(grid2.tab.rows(i).cells(1).innerText.length != grid2.tab.rows(i).cells(5).innerText.length) return alert("括号"+grid2.tab.rows(i).cells(1).innerText+"和括号"+grid2.tab.rows(i).cells(5).innerText+"个数不匹配");&#13;&#10;        &#13;&#10;		sWhere += grid2.tab.rows(i).cells(1).innerText + fdName + _OpNameTo(grid2.tab.rows(i).cells(3).innerText)+ zifu + grid2.tab.rows(i).cells(4).innerText + zifu +grid2.tab.rows(i).cells(5).innerText + sOr;&#13;&#10;	}&#13;&#10;	sWhere = new Eapi.Str().trim(sWhere);&#13;&#10;	return sWhere;&#13;&#10;}&#13;&#10;&#13;&#10;function _OpNameTo(sName) {&#13;&#10;	var sRet1 = "";&#13;&#10;	switch (sName) {&#13;&#10;		&#13;&#10;		case "＝" : sRet1 = "="; break;&#13;&#10;		case "＞" : sRet1 = ">"; break;&#13;&#10;		case "＜" : sRet1 = "<"; break;&#13;&#10;		case "＞＝" : sRet1 = ">="; break;&#13;&#10;		case "！＝" : sRet1 = "!="; break;&#13;&#10;		case "开始于" : sRet1 = " like "; break;&#13;&#10;	}&#13;&#10;	return sRet1;&#13;&#10;}	&#13;&#10;&#13;&#10;&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;fcgensql.js&#13;&#10;~userfunc.js" AutoResizeXml isCheckPermit="否" alertType="1" unselectable="on" contxml="<root><button><id>cmdClose</id><id>cmdOk</id><id>FCButton10</id><id>FCButton11</id></button><grid><id>grid2</id></grid><dataset><id>dataset2</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:1;label:4;radio:0;listbox:1;textarea:1;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:2;tab:2;div:2;DsMain_field:0;a:0;button:7;text:1;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:5;dataset:3;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" billtaborder="<root><taborder>cmdClose</taborder><taborder>cmdOk</taborder><taborder>FCButton10</taborder><taborder>FCButton11</taborder><taborder>grid2</taborder></root>" OtherSave="否" codeheader="BBB" keyfield entertype="修改" idtype="1" BLONclose BLONopenBefore BLONopen="uf_open()" window="有模式窗口" toolbar="不带工具栏" posheight="230" poswidth="620" postop posleft center="居中" isfile="是" type="FT" caption="sql语句条件生成器" dj_sn="help_4_4_queryCondition2" userType mkbh>&nbsp; <IMG id=dataset2 style="LEFT: 613px; WIDTH: 41px; POSITION: absolute; TOP: 138px; HEIGHT: 47px" src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" isaddemptyrec="否" submittype="1" submitno="1" issubds="否" isSubGrid="否" savetable idparam subdsfield masterds masterdsfield async="否" datasourceName opensortno="4" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll opensql iscreatetable="否" pubpara="否" formatxml='<root><tr rowstate="add"><td>sign1</td><td>(</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cxml%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%28%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%28%28%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%28%28%28%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%28%28%28%28%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%28%28%28%28%28%3C/td%3E%3C/tr%3E%3C/xml%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u662F%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Ctemptext%3E%28%0D%0A%28%28%0D%0A%28%28%28%0D%0A%28%28%28%28%0D%0A%28%28%28%28%28%3C/temptext%3E%3Cfieldnamelist%3Esign1%3C/fieldnamelist%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>32</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="edit"><td>chnname</td><td>字段中文名</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%u7F16%u53F7%7C%u7C7B%u578B%7C%u540D%u79F0%20%21%3C/format%3E%3Csql1%3Eselect%20fdname%2Cfdtype%2Cchnname%20from%20fc_entitysub%20where%20tbname%3D%27%3A%7Btablename%7D%3A%27%3C/sql1%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E2%3C/check%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>160</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>swhere1</td><td>条件</td><td>字符</td><td>20</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cxml%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%uFF1D%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%uFF1E%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%uFF1C%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%uFF1E%uFF1D%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%uFF1C%uFF1D%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%uFF01%uFF1D%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%u5F00%u59CB%u4E8E%3C/td%3E%3C/tr%3E%3C/xml%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Ctemptext%3E%uFF1D%0D%0A%uFF1E%0D%0A%uFF1C%0D%0A%uFF1E%uFF1D%0D%0A%uFF1C%uFF1D%0D%0A%uFF01%uFF1D%0D%0A%u5F00%u59CB%u4E8E%3C/temptext%3E%3Cfieldnamelist%3Eswhere1%3C/fieldnamelist%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>60</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="edit"><td>svalue</td><td>字段或值</td><td>字符</td><td>20</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>160</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>sign2</td><td>)</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cxml%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%29%3C/td%3E%3Ctd%3E%29%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%29%29%3C/td%3E%3Ctd%3E%29%29%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%29%29%29%3C/td%3E%3Ctd%3E%29%29%29%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%29%29%29%29%3C/td%3E%3Ctd%3E%29%29%29%29%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%29%29%29%29%29%3C/td%3E%3Ctd%3E%29%29%29%29%29%3C/td%3E%3C/tr%3E%3C/xml%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u662F%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Ctempvalue%3E%29%0D%0A%29%29%0D%0A%29%29%29%0D%0A%29%29%29%29%0D%0A%29%29%29%29%29%3C/tempvalue%3E%3Ctemptext%3E%29%0D%0A%29%29%0D%0A%29%29%29%0D%0A%29%29%29%29%0D%0A%29%29%29%29%29%3C/temptext%3E%3Cfieldnamelist%3Esign2%3C/fieldnamelist%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>32</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>swhere2</td><td>或与</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cxml%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%u4E0E%3C/td%3E%3C/tr%3E%3Ctr%20height%3D%2716px%27%20%3E%3Ctd%3E%u6216%u8005%3C/td%3E%3C/tr%3E%3C/xml%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u5426%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3Ctemptext%3E%u4E0E%0D%0A%u6216%u8005%3C/temptext%3E%3Cfieldnamelist%3Eswhere2%3C/fieldnamelist%3E%3CisShowTree%3E0%3C/isShowTree%3E%3CisTreeNewSql%3E0%3C/isTreeNewSql%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>40</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fdname</td><td>字段英文名</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>0</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>fdtype</td><td>类型</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>0</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' saveastable temptable="TMP_TTGRID4" chnname Like="否"><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdClose onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 94px; WIDTH: 55px; POSITION: absolute; TOP: 1px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("CloseBill()")' dropstyle="否"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdOk onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 12px; WIDTH: 55px; POSITION: absolute; TOP: 1px; HEIGHT: 26px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_ok()")' dropstyle="否"></BUTTON> <IMG id=grid2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 9px; WIDTH: 523px; POSITION: absolute; TOP: 30px; HEIGHT: 142px" onmovestart=moveStart() src="../../fceform/images/ef_designer_webgrid.gif" blRowNo="否" hideHscroll="auto" canselect="是" autoheight="是" autowidth="否" autoappend="否" readonly="否" titlerowheight titlerows usertitlehtml usertitle="否" SetRowHeight="是" hideVscroll="auto" bodyrowheight="-1" bodyrows="-1" iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0" visible="是" dataset="dataset2" controltype="grid" autosize="否"><BUTTON onmove=move() oncontrolselect=controlselect() id=FCButton10 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 538px; WIDTH: 58px; FONT-FAMILY: ; POSITION: absolute; TOP: 41px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" fc_onclick='bill_onclick("dataset2.Append()")' dropstyle="否">新增行</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=FCButton11 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 538px; WIDTH: 58px; FONT-FAMILY: ; POSITION: absolute; TOP: 73px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" fc_onclick='bill_onclick("dataset2.Delete()")' dropstyle="否">删除行</BUTTON></DIV><p id=splitaddhtml /><link type='text/css' rel='stylesheet' href='../css/shape.css'  />
