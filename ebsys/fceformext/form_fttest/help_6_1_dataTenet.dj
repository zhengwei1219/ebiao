<script>&#13;&#10;function assignment(){//xml&#13;&#10;&#13;&#10;	dataset1.OpenXml("<root><tr><td>ZCF00000098</td><td>方成科技 </td><td>B00007 </td><td>咸阳市秦都向群中西经营部</td></tr><set><pages>0</pages><fields><field><fieldname>SDWID</fieldname><datatype>字符</datatype><displaylabel>单位ID</displaylabel><size>11</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>是</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>BZ</fieldname><datatype>字符</datatype><displaylabel>备注</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>SDWCODE</fieldname><datatype>字符</datatype><displaylabel>单位编号</displaylabel><size>15</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>SDWNAME</fieldname><datatype>字符</datatype><displaylabel>单位名称</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields></set></root>")  &#13;&#10;	&#13;&#10;}&#13;&#10;function uf_open(){//sql&#13;&#10;	dataset2.Open ("select top 1 FCS_DEPT.sdeptid,FCS_DEPT.sdeptcode,FCS_DEPT.sdeptname from FCS_DEPT")	&#13;&#10;}	&#13;&#10;function domv(){//dom&#13;&#10;	var oRoot =dataset3.oDom.documentElement;&#13;&#10;		dataset3.Append();&#13;&#10;		//dataset3.Update("不检查");&#13;&#10;		//修改数据集中的数据&#13;&#10;		oRoot.childNodes(0).childNodes(0).text = "商品编号" &#13;&#10;		oRoot.childNodes(0).childNodes(1).text = "商品名称" ;&#13;&#10;		dataset3.dset_fset()&#13;&#10;		dataset3.fset_cont1()&#13;&#10;}&#13;&#10;&#13;&#10;function alterValue(){//文本控件中的数据转换成字段集&#13;&#10;	//dataset1.cont1_fset()&#13;&#10;	alert(dataset1. Field("sdwcode").Value);	&#13;&#10;	alert(dataset1. Field("sdwname").Value)	;&#13;&#10;}&#13;&#10;function updataXml(){&#13;&#10;	//dataset1.Update('不检查');&#13;&#10;	alert(dataset1.oDom.xml);&#13;&#10;}		</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js" isCheckPermit="否" alertType="1" BLONopen unselectable="on" toolbar="不带工具栏" dj_sn="help_6_1_dataTenet" type="FT" caption="数据流向示例" window="当前窗口" posleft postop poswidth posheight isfile="是" billtaborder="<root><taborder>text1</taborder><taborder>text2</taborder><taborder>button4</taborder><taborder>button5</taborder><taborder>button6</taborder><taborder>text3</taborder><taborder>text4</taborder><taborder>button7</taborder><taborder>text5</taborder><taborder>text6</taborder><taborder>button9</taborder><taborder>textarea2</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:13;radio:0;listbox:0;textarea:2;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:2;tab:0;div:0;DsMain_field:0;a:0;button:11;text:10;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:2;dataset:3;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" contxml="<root><label><id>label1</id><id>label2</id><id>label3</id><id>label4</id><id>label5</id><id>label6</id></label><textarea><id>textarea2</id></textarea><shape><id>shape1</id><id>shape2</id></shape><button><id>button4</id><id>button5</id><id>button6</id><id>button7</id><id>button9</id></button><text><id>text1</id><id>text2</id><id>text3</id><id>text4</id><id>text5</id><id>text6</id></text><dataset><id>dataset1</id><id>dataset2</id><id>dataset3</id></dataset></root>" center="  " BLONopenBefore BLONclose userType mkbh codeheader="BBB" keyfield entertype="修改" OtherSave="否" idtype="1" runsave><INPUT onmove=move() oncontrolselect=controlselect() id=text1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 80px; WIDTH: 145px; COLOR: #000000; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 41px; HEIGHT: 20px; TEXT-DECORATION: underline" onmovestart=moveStart() size=24 controltype="text" field="sdwcode" china="单位编号" dataset="dataset1"><INPUT onmove=move() oncontrolselect=controlselect() id=text2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 331px; WIDTH: 183px; COLOR: #000000; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 41px; HEIGHT: 20px" onmovestart=moveStart() size=32 controltype="text" field="sdwname" china="单位名称" dataset="dataset1"><IMG id=dataset1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 740px; WIDTH: 39px; POSITION: absolute; TOP: 111px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" datasourceName idtype="1" queryTableName="FCS_DW" masterdsfield masterds subdsfield issubds="否" idparam savetable submitno="1" submittype="1" isSubGrid="否" isaddemptyrec="否" saveastable formatxml="<root><tr rowstate=&quot;add&quot;><td>sdwid</td><td>单位id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>bz</td><td>备注</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sdwcode</td><td>单位编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sdwname</td><td>单位名称</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td>$valid('汉字、字母、数字或_');$valid('字段值不重复');$valid('值已存在');</td><td></td><td></td><td></td><td></td><td></td></tr></root>" pubpara="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1"><BUTTON onmove=move() oncontrolselect=controlselect() id=button4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 11px; WIDTH: 165px; POSITION: absolute; TOP: 1px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("assignment()")'>XML串装入数据集对象</BUTTON><LABEL onmove=move() oncontrolselect=controlselect() id=label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 15px; WIDTH: 58px; POSITION: absolute; TOP: 45px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">单位编号</LABEL><LABEL onmove=move() oncontrolselect=controlselect() id=label2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 268px; WIDTH: 61px; POSITION: absolute; TOP: 45px; HEIGHT: 16px" onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">单位名称</LABEL><BUTTON onmove=move() oncontrolselect=controlselect() id=button5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 192px; WIDTH: 124px; POSITION: absolute; TOP: 1px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("alterValue()")'>显示数据中的字段值</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 569px; WIDTH: 164px; POSITION: absolute; TOP: 213px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_open()")'>用sql语句给数据集装入值</BUTTON><INPUT onmove=move() oncontrolselect=controlselect() id=text3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 89px; WIDTH: 144px; POSITION: absolute; TOP: 218px; HEIGHT: 20px" onmovestart=moveStart() size=25 controltype="text" field="sdeptcode" china="部门编号" dataset="dataset2"><INPUT onmove=move() oncontrolselect=controlselect() id=text4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 348px; WIDTH: 189px; POSITION: absolute; TOP: 218px; HEIGHT: 20px" onmovestart=moveStart() size=34 controltype="text" field="sdeptname" china="部门名称" dataset="dataset2"><IMG id=dataset2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 805px; WIDTH: 39px; POSITION: absolute; TOP: 240px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" datasourceName idtype="1" queryTableName="FCS_DEPT" masterdsfield masterds subdsfield issubds="否" idparam savetable submitno="1" submittype="1" isSubGrid="否" isaddemptyrec="否" saveastable formatxml="<root><tr rowstate=&quot;add&quot;><td>sdeptid</td><td>部门id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sdeptcode</td><td>部门编号</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>120px</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sdeptname</td><td>部门名称</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>120px</td><td></td><td></td><td>$valid('汉字、字母、数字或_');$valid('字段值不重复');$valid('值已存在');</td><td></td><td></td><td></td><td></td><td></td></tr></root>" pubpara="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1"><LABEL onmove=move() oncontrolselect=controlselect() id=label3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 20px; WIDTH: 57px; POSITION: absolute; TOP: 223px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">部门编号</LABEL><LABEL onmove=move() oncontrolselect=controlselect() id=label4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 276px; WIDTH: 57px; POSITION: absolute; TOP: 222px; HEIGHT: 19px" onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">部门名称</LABEL><BUTTON onmove=move() oncontrolselect=controlselect() id=button7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 565px; WIDTH: 197px; POSITION: absolute; TOP: 247px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("domv()")'>在数据集中的dom对象添加数据</BUTTON><INPUT onmove=move() oncontrolselect=controlselect() id=text5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 88px; WIDTH: 145px; POSITION: absolute; TOP: 250px; HEIGHT: 20px" onmovestart=moveStart() size=25 controltype="text" field="sitemcode" china="物品编号" dataset="dataset3"><INPUT onmove=move() oncontrolselect=controlselect() id=text6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 348px; WIDTH: 190px; POSITION: absolute; TOP: 250px; HEIGHT: 20px" onmovestart=moveStart() size=34 controltype="text" field="sitemname" china="物品名称" dataset="dataset3"><IMG id=dataset3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 807px; WIDTH: 39px; POSITION: absolute; TOP: 192px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" datasourceName idtype="1" queryTableName="FCS_ITEM" masterdsfield masterds subdsfield issubds="否" idparam savetable submitno="1" submittype="1" isSubGrid="否" isaddemptyrec="否" saveastable formatxml="<root><tr rowstate=&quot;add&quot;><td>sitemcode</td><td>物品编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sitemname</td><td>物品名称</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td>$valid('汉字、字母、数字或_');$valid('字段值不重复');$valid('值已存在');</td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>sitemid</td><td>产品id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" pubpara="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="1"><LABEL onmove=move() oncontrolselect=controlselect() id=label5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 278px; WIDTH: 65px; POSITION: absolute; TOP: 255px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">商品名称</LABEL><LABEL onmove=move() oncontrolselect=controlselect() id=label6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 24px; WIDTH: 56px; POSITION: absolute; TOP: 255px; HEIGHT: 15px" onmovestart=moveStart() controltype="label" inputTag="否" NotBg="否">商品编号</LABEL><BUTTON onmove=move() oncontrolselect=controlselect() id=button9 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 331px; WIDTH: 172px; POSITION: absolute; TOP: 1px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("updataXml()")'>查看数据集的XML结构的数据</BUTTON><TEXTAREA onmove=move() oncontrolselect=controlselect() id=textarea2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 15px; WIDTH: 577px; COLOR: #0000ff; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 72px; HEIGHT: 82px" onmovestart=moveStart() rows=1 cols=108 controltype="textarea" value="textarea2" induce="否">通过dataset1.OpenXml("xml串")给数据集控件的xml数据区装入数据，dataset1.dset_fset()将dataset对象传递给field字段集，通过dataset1.fset_cont1()将field字段集传递给text控件。你修改text控件的之后触发了onchange事件,将零散控件上的当前行的值保存到数据集的当前行数组中。它是通过执行 ds.cont1_fset()方法,将零散控件上的当前行的值保存到数据集的当前行数组中,并执行 ds.cont_onDataChange()方法。</TEXTAREA><?xml:namespace prefix = v /><v:line id=shape1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize="" style="LEFT: 17px; WIDTH: 800px; POSITION: absolute; TOP: 200px; HEIGHT: 15px" onmovestart=moveStart() controltype="shape" linetype="横线" cover="9" from = "0,0" to = "600pt,0" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:line><v:line id=shape2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize="" style="LEFT: 10px; WIDTH: 800px; POSITION: absolute; TOP: 289px; HEIGHT: 15px" onmovestart=moveStart() controltype="shape" linetype="横线" cover="9" from = "0,0" to = "600pt,0" fillcolor = "white" strokecolor = "black" strokeweight = ".75pt"><v:stroke></v:stroke></v:line></DIV>