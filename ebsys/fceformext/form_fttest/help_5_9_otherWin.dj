<script>&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;" userType mastertable="FCS_BILL" mkbh blmode="其它" runsave BLONclose BLONopen="new Eform.SysForm().setButtonImage()" center="  " unselectable="on" toolbar="翻页组_增加行_删除行_增加_删除_保存" dj_sn="help_5_9_otherWin" type="FT" caption="带导航条的主从表从另一窗口输入" codeheader="DAA" keyfield="djbh" window="当前窗口" entertype="修改" posleft postop poswidth posheight isfile="是" OtherSave="否" idtype="1" billtaborder="<root><taborder>textarea1</taborder><taborder>cmdOpenWin</taborder><taborder>cmdDropDown2</taborder><taborder>cmdDropDown1</taborder><taborder>cmdDate1</taborder><taborder>txtBz</taborder><taborder>txtDept</taborder><taborder>txtAddress</taborder><taborder>txtCode</taborder><taborder>txtDate</taborder><taborder>txtName</taborder><taborder>txtDjbh</taborder><taborder>grid1</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:1;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:1;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:6;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" contxml="<root><label><id>Label17</id><id>Label14</id><id>Label5</id><id>Label11</id><id>Label6</id><id>Label2</id><id>Label7</id><id>Label4</id></label><textarea><id>textarea1</id></textarea><button><id>cmdOpenWin</id><id>cmdDropDown2</id><id>cmdDropDown1</id><id>cmdDate1</id></button><text><id>txtBz</id><id>txtDept</id><id>txtAddress</id><id>txtCode</id><id>txtDate</id><id>txtName</id><id>txtDjbh</id></text><grid><id>grid1</id></grid><dataset><id>dssub1</id><id>DsMain</id></dataset></root>" BLONopenBefore>&nbsp;</INPUT></INPUT></INPUT></INPUT></INPUT><SPAN onmove=move() oncontrolselect=controlselect() id=Label17 onresize=resize() style="DISPLAY: block; FONT-WEIGHT: bold; FONT-SIZE: 20px; LEFT: 11px; WIDTH: 357px; COLOR: #0000ff; FONT-FAMILY: 楷体_GB2312; POSITION: absolute; TOP: 17px; HEIGHT: 25px; TEXT-ALIGN: left; TEXT-DECORATION: underline; backgroundColor1: #c0c0c0" value="Label17" controltype="label" NotBg="否" inputTag="否">从另一窗口输入从表数据的主从表</SPAN><TEXTAREA onmove=move() oncontrolselect=controlselect() id=textarea1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 15px; WIDTH: 722px; POSITION: absolute; TOP: 463px; HEIGHT: 41px" onmovestart=moveStart() rows=1 cols=143 value="textarea1" controltype="textarea" induce="否">这是一个从表数据从另一个窗口输入的主从表，如果从表数据过多，从另一窗口输入比grid控件输入方便。</TEXTAREA><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdOpenWin onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 613px; WIDTH: 122px; FONT-FAMILY: ; POSITION: absolute; TOP: 97px; HEIGHT: 25px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="否" fc_onclick="bill_onclick(&quot;DjOpen('mainSubTotherWindow1',dssub1,'有模式窗口')&quot;)">从新窗口中输入</BUTTON><IMG id=dssub1 style="LEFT: 762px; WIDTH: 38px; POSITION: absolute; TOP: 168px; HEIGHT: 44px" src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" Like="否" chnname temptable="TMP_ZCASPGRID1" fieldtrans="<root><field><name>dj_sn</name><trans>transRecNo+1</trans><rtrans></rtrans></field></root>" saveastable formatxml="<root><tr rowstate=&quot;edit&quot;><td>djbh</td><td>单据编号</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>sitemcode</td><td>商品编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>100</td><td></td><td></td><td></td><td></td><td></td><td>SelectZlSql('select sitemid,sitemcode,sitemname,dprice,dprice as dmoney,1 as dnum from FCS_ITEM order by sitemcode','是','sitemid','',grid1)</td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>sitemname</td><td>商品名称</td><td>字符</td><td>40</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>140</td><td></td><td></td><td></td><td></td><td></td><td>SelectZlSql('select sitemid,sitemcode,sitemname,dprice,dprice as dmoney,1 as dnum from FCS_ITEM order by sitemcode','是','sitemid','',grid1)</td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>dnum</td><td>数量</td><td>实数</td><td>14</td><td>2</td><td>数据项</td><td>1</td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>dprice</td><td>单价</td><td>实数</td><td>10</td><td>3</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>dmoney</td><td>金额</td><td>实数</td><td>14</td><td>2</td><td>实际计算项</td><td>$f_value('dprice')*$f_value('dnum')</td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>right</td><td>110</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>sitemid</td><td>商品内码</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>jehj</td><td>金额合计</td><td>实数</td><td>15</td><td>2</td><td>汇总项</td><td>sum('dmoney')</td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;edit&quot;><td>jehetobig</td><td>大写金额</td><td>字符</td><td>40</td><td>0</td><td>汇总项</td><td>ChangeToBig(sum('dmoney'))</td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>djbhsub</td><td>id</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" pubpara="否" iscreatetable="否" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen opensortno="2" datasourceName isaddemptyrec="否" submittype="1" submitno="1" savetable="FCS_BILLSUB1" idparam="DDA" issubds="是" subdsfield="djbh" masterds="DsMain" masterdsfield="djbh" isSubGrid="否"><IMG id=DsMain style="LEFT: 553px; WIDTH: 54px; POSITION: absolute; TOP: 81px; HEIGHT: 53px" src="../../fceform/images/ef_designer_dataset.gif" idtype="1" controltype="dataset" Like="否" chnname temptable="TMP_BILL_ZCASP_AA_ORDERBILL" saveastable="FCS_BILL" formatxml='<root><tr rowstate="edit"><td>bz</td><td>备注</td><td>字符</td><td>60</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="edit"><td>djbh</td><td>单据编号</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="edit"><td>sdate</td><td>开票日期</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>sdeptid</td><td>部门内码</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>sdwid</td><td>单位内码</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>sdeptcode</td><td>部门编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>sdeptname</td><td>部门名称</td><td>字符</td><td>40</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>sdwcode</td><td>单位编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>sdwname</td><td>单位名称</td><td>字符</td><td>40</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>saddress</td><td>地址</td><td>字符</td><td>60</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' pubpara="否" iscreatetable="否" opensql="select  FCS_BILL.djbh,FCS_BILL.sdwid,FCS_BILL.sdeptid,FCS_BILL.bz , sdate ,FCS_DW.sdwcode,FCS_DEPT.sdeptname,FCS_DW.sdwname,FCS_DW.saddress&#13;&#10; from FCS_BILL,FCS_DEPT,FCS_DW where&#13;&#10; FCS_BILL.sdwid=FCS_DW.sdwid and FCS_DEPT.sdeptid=FCS_BILL.sdeptid&#13;&#10; order by FCS_BILL.djbh&#13;&#10;" AfterScroll="fcpubdata.keyValue=DsMain.Field('djbh').Value ; dssub1.Open('select FCS_BILLSUB1.*,FCS_ITEM.sitemcode,FCS_ITEM.sitemname from FCS_BILLSUB1 inner join FCS_ITEM on FCS_BILLSUB1.sitemid=FCS_ITEM.sitemid where djbh=:key_value' ) ;" BeforeScroll AfterPost BeforePost BeforeOpen="DsMain.PageSize=1" AfterOpen opensortno="1" datasourceName isaddemptyrec="否" submittype="2" submitno="1" savetable="FCS_BILL" idparam="DAA" issubds="否" subdsfield masterds masterdsfield isSubGrid="否"><IMG id=grid1 style="LEFT: 10px; WIDTH: 722px; POSITION: absolute; TOP: 139px; HEIGHT: 290px" src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dssub1" csstext2="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #c0c0c0" csstext1="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #ffffff" crosstabdatatype="0" crosstabsql cavg="否" cmax="否" cmin="否" csum="否" ccount="否" ravg="否" rmax="否" rmin="否" rsum="否" rcount="否" coltitle rowtitle crosstabformat crosstabsumtype="0" crosstabtitle iscrosstab="否" bodyrows="-1" bodyrowheight="-1" hideVscroll="否" SetRowHeight="是" usertitle="否" usertitlehtml titlerows titlerowheight="30" visible="是" readonly="否" autoappend="是" autowidth="是" autoheight="否" canselect="是"><INPUT onmove=move() oncontrolselect=controlselect() id=txtBz onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 235px; WIDTH: 297px; POSITION: absolute; TOP: 114px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" readOnly value=备注 controltype="text" dataset="DsMain" field="bz" CanSelect="false" china="备注"><SPAN onmove=move() oncontrolselect=controlselect() id=Label14 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 181px; WIDTH: 67px; FONT-FAMILY: ; POSITION: absolute; TOP: 118px; HEIGHT: 15px" value="Label14" controltype="label">备&nbsp;&nbsp;&nbsp; 注</SPAN><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdDropDown2 onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; DISPLAY: block; FONT-SIZE: 12px; LEFT: 156px; BORDER-LEFT: 0px; WIDTH: 17px; BORDER-BOTTOM: 0px; BACKGROUND-REPEAT: no-repeat; FONT-FAMILY: ; POSITION: absolute; TOP: 114px; HEIGHT: 20px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="是" fc_onclick="bill_onclick(&quot;SelectZlSql('select sdeptid,sdeptcode,sdeptname from FCS_DEPT order by sdeptcode','否','sdeptid')&quot;)"></BUTTON><INPUT onmove=move() oncontrolselect=controlselect() id=txtDept onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 67px; WIDTH: 90px; POSITION: absolute; TOP: 114px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" readOnly value=部门名称 controltype="text" dataset="DsMain" field="sdeptname" CanSelect="false" china="部门名称" fc_ondblclick="bill_ondblclick(&quot;SelectZlSql('select sdeptid,sdeptcode,sdeptname from FCS_DEPT order by sdeptcode','否','sdeptid')&quot;)"><SPAN onmove=move() oncontrolselect=controlselect() id=Label5 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 12px; WIDTH: 65px; FONT-FAMILY: ; POSITION: absolute; TOP: 118px; HEIGHT: 15px" value="Label5" controltype="label">部门名称</SPAN><SPAN onmove=move() oncontrolselect=controlselect() id=Label11 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 12px; WIDTH: 65px; FONT-FAMILY: ; POSITION: absolute; TOP: 97px; HEIGHT: 15px" value="Label11" controltype="label" NotBg="否" inputTag="否">地址</SPAN><INPUT onmove=move() oncontrolselect=controlselect() id=txtAddress onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 67px; WIDTH: 295px; POSITION: absolute; TOP: 93px; HEIGHT: 20px; BACKGROUND-COLOR: #c0c0c0; TEXT-ALIGN: left" readOnly value=地址 controltype="text" dataset="DsMain" field="saddress" CanSelect="false" china="地址"><SPAN onmove=move() oncontrolselect=controlselect() id=Label6 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 12px; WIDTH: 65px; FONT-FAMILY: ; POSITION: absolute; TOP: 76px; HEIGHT: 15px" value="Label6" controltype="label">单位编号</SPAN><INPUT onmove=move() oncontrolselect=controlselect() id=txtCode onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 67px; WIDTH: 90px; POSITION: absolute; TOP: 72px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" readOnly value=单位编号 controltype="text" dataset="DsMain" field="sdwcode" CanSelect="false" china="单位编号" fc_ondblclick="bill_ondblclick(&quot;SelectZlSql('select sdwid,sdwcode,sdwname,saddress from FCS_DW order by sdwcode','否','sdwid')&quot;)"><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdDropDown1 onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; DISPLAY: block; FONT-SIZE: 12px; LEFT: 156px; BORDER-LEFT: 0px; WIDTH: 17px; BORDER-BOTTOM: 0px; BACKGROUND-REPEAT: no-repeat; FONT-FAMILY: ; POSITION: absolute; TOP: 72px; HEIGHT: 20px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="是" fc_onclick="bill_onclick(&quot;SelectZlSql('select sdwid,sdwcode,sdwname,saddress from FCS_DW order by sdwcode','否','sdwid')&quot;)"></BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=cmdDate1 onresize=resize() style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; DISPLAY: block; FONT-SIZE: 12px; LEFT: 161px; BORDER-LEFT: 0px; WIDTH: 20px; BORDER-BOTTOM: 0px; BACKGROUND-REPEAT: no-repeat; FONT-FAMILY: ; POSITION: absolute; TOP: 51px; HEIGHT: 20px; BACKGROUND-COLOR: #d4d0c8" controltype="button" dropstyle="是" fc_onclick='bill_onclick("SelectDate(txtDate)")'></BUTTON><INPUT onmove=move() oncontrolselect=controlselect() id=txtDate onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 67px; WIDTH: 90px; POSITION: absolute; TOP: 51px; HEIGHT: 20px; BACKGROUND-COLOR: #ffffff; TEXT-ALIGN: left" value=开票日期 controltype="text" dataset="DsMain" field="sdate" CanSelect="false" china="开票日期" fc_ondblclick='bill_ondblclick("SelectDate(txtDate)")'><SPAN onmove=move() oncontrolselect=controlselect() id=Label2 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 12px; WIDTH: 66px; FONT-FAMILY: ; POSITION: absolute; TOP: 56px; HEIGHT: 15px" value="Label2" controltype="label">开票日期</SPAN><SPAN onmove=move() oncontrolselect=controlselect() id=Label7 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 182px; WIDTH: 65px; FONT-FAMILY: ; POSITION: absolute; TOP: 75px; HEIGHT: 15px" value="Label7" controltype="label">单位名称</SPAN><INPUT onmove=move() oncontrolselect=controlselect() id=txtName onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 235px; WIDTH: 297px; POSITION: absolute; TOP: 72px; HEIGHT: 20px; BACKGROUND-COLOR: #c0c0c0; TEXT-ALIGN: left" readOnly value=单位名称 controltype="text" dataset="DsMain" field="sdwname" CanSelect="false" china="单位名称"><INPUT onmove=move() oncontrolselect=controlselect() id=txtDjbh onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 422px; WIDTH: 110px; POSITION: absolute; TOP: 51px; HEIGHT: 20px; BACKGROUND-COLOR: #c0c0c0; TEXT-ALIGN: left" readOnly value=单据编号 controltype="text" dataset="DsMain" field="djbh" CanSelect="false" china="单据编号"><SPAN onmove=move() oncontrolselect=controlselect() id=Label4 onresize=resize() style="DISPLAY: block; FONT-SIZE: 12px; LEFT: 372px; WIDTH: 65px; FONT-FAMILY: ; POSITION: absolute; TOP: 56px; HEIGHT: 15px" value="Label4" controltype="label">单据编号</SPAN></DIV>