<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:fc xmlns:v="urn:schemas-microsoft-com:vml">
	<HEAD>
	    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<STYLE> .userData{behavior:url(#default#userData);}
	@import url(../../fceform/css/dj.css); 
	</STYLE>
		<script src="../../fceform/js/MicrosoftAjax.js"></script>
		<script src="../../fceform/js/fcpub.js"></script>
		<script src="../../fceform/js/fcrundj.js"></script>
		<script src="../../fceform/js/tabpane.js"></script>		
	</HEAD>
	<body background="../../fceform/images/ef_run_background.gif"  onload="pub_window_onload()"
		onkeydown="RunTabindex()" onbeforeunload="pub_window_onbeforeunload()" onkeypress="pub_window_onkeypress()"
		onresize="pub_window_onresize()">
		<script>pub_djhtm();</script>
<script>var oldXml = "";
function uf_read() {
	var sXml = "" ;
	sXml=dataset1.xml ;
	//调用后台的 webbill.cs中的readdsdata函数来处理数据集中的数据,并返回处理结果
	var s = new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host+ fcpubdata.servletPath + "/WebBill"
		+fcpubdata.dotnetVersion+"?readdsdata",sXml);
	
	alert(s);
}
//取得数据集中改变了的数据
function uf_getchangedata(){
	var oList = dataset1.oDom.documentElement.selectNodes("//tr[@rowstate='edit' or @rowstate='add']")	;
	if(oList == null) return;
	var s =new Sys.StringBuilder() ;
	for(var i=0;i<oList.length;i++){
		s.append(oList.item(i).xml);
	}
	//加上删除的数据
	s.append(dataset1.DeletedData);
	alert(s.toString());
}
//用一个XML字符串来打开数据集,而不是用一个sql语句.
function uf_openxmldata() {
//	var sXml=dataset1.xml ;
	dataset1.OpenXmlData(oldXml);
	
}
//取grid控件的当前列的字段名
function uf_getfieldname() {
	alert(GridColNoToFieldName(grid1,grid1.Col));
	
}
function uf_test1() {
	dataset1.OpenXmlData("<root><set><pages>0</pages><fields><field> <fieldname>ZA0100</fieldname><datatype>字符</datatype><displaylabel>编码</displaylabel><size>40</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB07ID</fieldname><datatype>字符</datatype><displaylabel>单位人员编制序号</displaylabel><size>9</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZB9991</fieldname><datatype>字符</datatype><displaylabel>起始时间</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZB9992</fieldname><datatype>字符</datatype><displaylabel>截止时间</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZC9993</fieldname><datatype>字符</datatype><displaylabel>状态标志</displaylabel><size>1</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZC9995</fieldname><datatype>字符</datatype><displaylabel>备注</displaylabel><size>255</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0705</fieldname><datatype>字符</datatype><displaylabel>编制总数</displaylabel><size>5</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0710</fieldname><datatype>字符</datatype><displaylabel>实有人数</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0715</fieldname><datatype>字符</datatype><displaylabel>缺编人数</displaylabel><size>6</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0717</fieldname><datatype>字符</datatype><displaylabel>超编人数</displaylabel><size>6</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0720</fieldname><datatype>字符</datatype><displaylabel>行政编制数</displaylabel><size>5</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0725</fieldname><datatype>字符</datatype><displaylabel>事业编制数</displaylabel><size>5</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0721</fieldname><datatype>字符</datatype><displaylabel>行政在职数</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0726</fieldname><datatype>字符</datatype><displaylabel>事业在职数</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0701</fieldname><datatype>字符</datatype><displaylabel>年份</displaylabel><size>4</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields></set></root>");
}</script><script src='../../fceform/js/fcopendj.js'></script><script defer src='../../fceform/js/fcsavedj.js'></script><script src='../../fceform/js/fcselfuse.js'></script><script src='../../fceform/js/fcbasecont.js'></script><script defer src='../../fceform/js/fcother.js'></script><script defer src='../../fceform/js/selectdate.js'></script><script src='../../fceform/js/fcdate.js'></script><script src='../../fceform/../fceformext/js/userfunc.js'></script><link href=../../fceform/css/tabstyle.css type=text/css rel=stylesheet><link type='text/css' rel='stylesheet' href='../../fceform/css/Button.css'/><script >document.styleSheets[0].addRule("fc\\:webgrid","behavior: url(../../fceform/htc/webgrid.htc)",0);</script><script src='../../fceform/js/fcwebgrid.js'></script><script >document.styleSheets[0].addRule("fc\\:fc_code","behavior: url(../../fceform/htc/fc_code.htc)",0);</script><script >document.styleSheets[0].addRule("fc\\:dataset","behavior: url(../../fceform/htc/dataset.htc)",0);</script><script src='../../fceform/js/fcdataset.js'></script>
<DIV id=SKbillsheet jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;fcdate.js&#13;&#10;~userfunc.js" runsave BLONclose BLONopen center="  " contxml="<root><label><id>label2</id></label><button><id>button1</id><id>button2</id><id>button3</id><id>button5</id><id>button6</id><id>button7</id><id>button8</id><id>button10</id></button><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:2;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:10;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:1;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" billtaborder="<root><taborder>button1</taborder><taborder>grid1</taborder><taborder>button2</taborder><taborder>button3</taborder><taborder>button5</taborder><taborder>button6</taborder><taborder>button7</taborder><taborder>button8</taborder><taborder>button10</taborder></root>" idtype="1" OtherSave="否" isfile="是" posheight poswidth postop posleft entertype="修改" window="当前窗口" keyfield codeheader="BBB" mkbh caption="用自定的.net后台程序来处理dataset数据" type="EX" dj_sn="sh_y_ActionDataSet1" toolbar="不带工具栏" AutoResizeXml><?xml:namespace prefix = fc /><fc:dataset id=dataset1 controltype="dataset" temptable="TMP_DATASET1" opensortno="1" pubpara="否" saveastable="fcs_dw" format="<fields><field><fieldname>SDWID</fieldname><datatype>字符</datatype><displaylabel>单位ID</displaylabel><size>11</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>SDWCODE</fieldname><datatype>字符</datatype><displaylabel>单位编号</displaylabel><size>15</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>是</primarykey><fieldvalid></fieldvalid><tag></tag></field><field><fieldname>SDWNAME</fieldname><datatype>字符</datatype><displaylabel>单位名称</displaylabel><size>50</size><precision>0</precision><fieldkind>数据项</fieldkind><defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>是</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields>" onValid='bill_ondatasetvalid("<dsid><SDWID></SDWID><SDWCODE></SDWCODE><SDWNAME></SDWNAME></dsid>")' onGetText='bill_ondatasetgettext("<dsid><SDWID></SDWID><SDWCODE></SDWCODE><SDWNAME></SDWNAME></dsid>")' onSetText='bill_ondatasetsettext("<dsid><SDWID></SDWID><SDWCODE></SDWCODE><SDWNAME></SDWNAME></dsid>")' sqltrans="%F4%D8%E6%D8%D4%F6XrnbXrn%DA%F2%EC%E8Xrn%DA%D4%F4%CC%D6%FC" isSubGrid="undefined"></fc:dataset><fc:webgrid id=grid1 onkeydown='bill_ongridkeydown("<grid1><col></col><col></col></grid1>")' ondblclick='bill_ongriddblclick("<grid1><col></col><col></col></grid1>")' onclick='bill_ongridclick("<grid1><col></col><col></col></grid1>")' controltype="grid" visible="是" dataset="dataset1" canselect="是" autoheight="否" autowidth="否" autoappend="否" readonly="否" format="<cols><col><fname>SDWCODE</fname><cname>单位编号</cname><width>15</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>80</columnwidth><align>left</align></col><col><fname>SDWNAME</fname><cname>单位名称</cname><width>50</width><dtype>字符</dtype><readonly>否</readonly><visible>是</visible><u></u><v></v><s></s><r></r><columnwidth>180</columnwidth><align>left</align></col></cols>" width="560" height="360" top="99" left="6">
<TABLE id=t style="TABLE-LAYOUT: fixed; FONT-SIZE: 12px; LEFT: 0px; POSITION: absolute; TOP: 0px; BORDER-COLLAPSE: collapse; BACKGROUND-COLOR: #ffffff" cellSpacing=0 cellPadding=1 frame=box>
<TBODY>
<TR class=fcGridFirstRow style="FONT-SIZE: 12px; BACKGROUND-COLOR: #c0c0c0">
<TD></TD></TR></TBODY></TABLE></fc:webgrid><BUTTON id=button1 style="LEFT: 235px; WIDTH: 228px; POSITION: absolute; TOP: 63px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("uf_read()")' dropstyle="否">用.net后台接收数据集的数据</BUTTON><BUTTON id=button2 style="LEFT: 13px; WIDTH: 190px; POSITION: absolute; TOP: 65px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("uf_getchangedata()")' dropstyle="否">只取变动后的数据</BUTTON><BUTTON id=button3 style="LEFT: 488px; WIDTH: 75px; POSITION: absolute; TOP: 62px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("dataset1.Append()")' dropstyle="否">add line</BUTTON><BUTTON id=button5 style="LEFT: 610px; WIDTH: 113px; POSITION: absolute; TOP: 143px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("uf_openxmldata()")' dropstyle="否">OpenXMLData</BUTTON><BUTTON id=button6 style="LEFT: 609px; WIDTH: 75px; POSITION: absolute; TOP: 112px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("oldXml=dataset1.xml;")' dropstyle="否">set value</BUTTON><BUTTON id=button7 style="LEFT: 571px; WIDTH: 75px; POSITION: absolute; TOP: 63px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("dataset1.Delete()")' dropstyle="否">del line</BUTTON> 
<DIV id=label2 style="FONT-WEIGHT: bold; LEFT: 10px; WIDTH: 144px; COLOR: #0000ff; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 13px; HEIGHT: 18px; TEXT-DECORATION: underline" onmovestart=moveStart() noWrap controltype="label" value="label2" NotBg="否">用自定的.net后台程序来处理dataset数据</DIV><BUTTON id=button8 style="LEFT: 462px; WIDTH: 75px; POSITION: absolute; TOP: 19px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("uf_test1()")' dropstyle="否">test</BUTTON><BUTTON id=button10 style="LEFT: 563px; WIDTH: 75px; POSITION: absolute; TOP: 20px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" onclick='bill_onclick("CopyToPub(dataset1.xml)")' dropstyle="否">button10</BUTTON></DIV></body></html>