<script>var oldXml = "";&#13;&#10;function uf_read() {&#13;&#10;	var sXml = "" ;&#13;&#10;	sXml=dataset1.xml ;&#13;&#10;	//调用后台的 webbill.cs中的readdsdata函数来处理数据集中的数据,并返回处理结果&#13;&#10;	var s = new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host+ fcpubdata.servletPath + "/WebBill"&#13;&#10;		+fcpubdata.dotnetVersion+"?readdsdata",sXml);&#13;&#10;	&#13;&#10;	alert(s);&#13;&#10;}&#13;&#10;//取得数据集中改变了的数据&#13;&#10;function uf_getchangedata(){&#13;&#10;	var oList = dataset1.oDom.documentElement.selectNodes("//tr[@rowstate='edit' or @rowstate='add']")	;&#13;&#10;	if(oList == null) return;&#13;&#10;	var s =new Sys.StringBuilder() ;&#13;&#10;	for(var i=0;i<oList.length;i++){&#13;&#10;		s.append(oList.item(i).xml);&#13;&#10;	}&#13;&#10;	//加上删除的数据&#13;&#10;	s.append(dataset1.DeletedData);&#13;&#10;	alert(s.toString());&#13;&#10;}&#13;&#10;//用一个XML字符串来打开数据集,而不是用一个sql语句.&#13;&#10;function uf_openxmldata() {&#13;&#10;//	var sXml=dataset1.xml ;&#13;&#10;	dataset1.OpenXmlData(oldXml);&#13;&#10;	&#13;&#10;}&#13;&#10;//取grid控件的当前列的字段名&#13;&#10;function uf_getfieldname() {&#13;&#10;	alert(GridColNoToFieldName(grid1,grid1.Col));&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_test1() {&#13;&#10;	dataset1.OpenXmlData("<root><set><pages>0</pages><fields><field> <fieldname>ZA0100</fieldname><datatype>字符</datatype><displaylabel>编码</displaylabel><size>40</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB07ID</fieldname><datatype>字符</datatype><displaylabel>单位人员编制序号</displaylabel><size>9</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZB9991</fieldname><datatype>字符</datatype><displaylabel>起始时间</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZB9992</fieldname><datatype>字符</datatype><displaylabel>截止时间</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZC9993</fieldname><datatype>字符</datatype><displaylabel>状态标志</displaylabel><size>1</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>ZC9995</fieldname><datatype>字符</datatype><displaylabel>备注</displaylabel><size>255</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>否</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0705</fieldname><datatype>字符</datatype><displaylabel>编制总数</displaylabel><size>5</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0710</fieldname><datatype>字符</datatype><displaylabel>实有人数</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0715</fieldname><datatype>字符</datatype><displaylabel>缺编人数</displaylabel><size>6</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0717</fieldname><datatype>字符</datatype><displaylabel>超编人数</displaylabel><size>6</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0720</fieldname><datatype>字符</datatype><displaylabel>行政编制数</displaylabel><size>5</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0725</fieldname><datatype>字符</datatype><displaylabel>事业编制数</displaylabel><size>5</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0721</fieldname><datatype>字符</datatype><displaylabel>行政在职数</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0726</fieldname><datatype>字符</datatype><displaylabel>事业在职数</displaylabel><size>8</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field><field> <fieldname>AB0701</fieldname><datatype>字符</datatype><displaylabel>年份</displaylabel><size>4</size><precision>0</precision> <fieldkind>数据项</fieldkind>	<defaultvalue></defaultvalue><displayformat></displayformat><isnull>否</isnull><iskey>否</iskey><valid>否</valid><procvalid>否</procvalid><link>否</link><target></target><href></href><visible>是</visible><primarykey>否</primarykey><fieldvalid></fieldvalid><tag></tag></field></fields></set></root>");&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;fcdate.js&#13;&#10;~userfunc.js" runsave BLONclose BLONopen center="  " contxml="<root><label><id>label2</id></label><button><id>button1</id><id>button2</id><id>button3</id><id>button5</id><id>button6</id><id>button7</id><id>button8</id><id>button10</id></button><grid><id>grid1</id></grid><dataset><id>dataset1</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:2;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:10;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:1;dataset:1;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0" billtaborder="<root><taborder>button1</taborder><taborder>grid1</taborder><taborder>button2</taborder><taborder>button3</taborder><taborder>button5</taborder><taborder>button6</taborder><taborder>button7</taborder><taborder>button8</taborder><taborder>button10</taborder></root>" idtype="1" OtherSave="否" isfile="是" posheight poswidth postop posleft entertype="修改" window="当前窗口" keyfield codeheader="BBB" mkbh caption="用自定的.net后台程序来处理dataset数据" type="EX" dj_sn="sh_y_ActionDataSet1" toolbar="不带工具栏" unselectable="on"><IMG id=dataset1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 622px; WIDTH: 39px; POSITION: absolute; TOP: 189px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" controltype="dataset" temptable="TMP_DATASET1" opensortno="1" AfterOpen BeforeOpen BeforePost AfterPost BeforeScroll AfterScroll chnname opensql="select * from fcs_dw" iscreatetable="否" pubpara="否" Like="否" formatxml='<root><tr rowstate="add"><td>SDWID</td><td>单位ID</td><td>字符</td><td>11</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>SDWCODE</td><td>单位编号</td><td>字符</td><td>15</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>SDWNAME</td><td>单位名称</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>180</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' saveastable="fcs_dw"><IMG id=grid1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 6px; WIDTH: 577px; POSITION: absolute; TOP: 99px; HEIGHT: 377px" onmovestart=moveStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" visible="是" dataset="dataset1" canselect="是" autoheight="否" autowidth="否" autoappend="否" readonly="否" titlerowheight usertitle="否" titlerows usertitlehtml iscrosstab="否" crosstabtitle crosstabdatatype crosstabsumtype crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql csstext1="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #ffffff" csstext2="FONT-SIZE: 12px; OVERFLOW: hidden; BACKGROUND-COLOR: #c0c0c0"><BUTTON onmove=move() oncontrolselect=controlselect() id=button1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 235px; WIDTH: 228px; POSITION: absolute; TOP: 63px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_read()")' dropstyle="否">用.net后台接收数据集的数据</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 13px; WIDTH: 190px; POSITION: absolute; TOP: 65px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_getchangedata()")' dropstyle="否">只取变动后的数据</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 488px; WIDTH: 75px; POSITION: absolute; TOP: 62px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("dataset1.Append()")' dropstyle="否">add line</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 610px; WIDTH: 113px; POSITION: absolute; TOP: 143px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_openxmldata()")' dropstyle="否">OpenXMLData</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 609px; WIDTH: 75px; POSITION: absolute; TOP: 112px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("oldXml=dataset1.xml;")' dropstyle="否">set value</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 571px; WIDTH: 75px; POSITION: absolute; TOP: 63px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("dataset1.Delete()")' dropstyle="否">del line</BUTTON> 
<DIV onmove=move() oncontrolselect=controlselect() id=label2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-WEIGHT: bold; LEFT: 10px; WIDTH: 144px; COLOR: #0000ff; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 13px; HEIGHT: 18px; TEXT-DECORATION: underline" onmovestart=moveStart() noWrap controltype="label" value="label2" NotBg="否">用自定的.net后台程序来处理dataset数据</DIV><BUTTON onmove=move() oncontrolselect=controlselect() id=button8 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 462px; WIDTH: 75px; POSITION: absolute; TOP: 19px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("uf_test1()")' dropstyle="否">test</BUTTON><BUTTON onmove=move() oncontrolselect=controlselect() id=button10 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="LEFT: 563px; WIDTH: 75px; POSITION: absolute; TOP: 20px; HEIGHT: 25px" onmovestart=moveStart() controltype="button" fc_onclick='bill_onclick("CopyToPub(dataset1.xml)")' dropstyle="否">button10</BUTTON></DIV>