<script>//取地址上的值&#13;&#10;function $(param){&#13;&#10;	return parent.Request.QueryString(param).toString();&#13;&#10;}&#13;&#10;&#13;&#10;//取控件&#13;&#10;function $get(obj){&#13;&#10;	return document.getElementById(obj);&#13;&#10;}&#13;&#10;&#13;&#10;//初始化&#13;&#10;function onLoad(){&#13;&#10;	var ntid = $("ntid");&#13;&#10;	var wfid = $("wfId");&#13;&#10;	//初始化值&#13;&#10;	var sql = "select * from wf_project_task where ntid = "+ntid;&#13;&#10;	dsValues.Open(sql);&#13;&#10;	dsValues.SetPos(0);&#13;&#10;	&#13;&#10;	//主任分解试验任务&#13;&#10;	sql = "select * from SJ_ZRFJSYRW where wfid = "+wfid;&#13;&#10;	dsMain.Open(sql);&#13;&#10;	dsMain.SetPos(0);&#13;&#10;	&#13;&#10;	//参与试验的专业组&#13;&#10;	sql = "select user_id as userid,user_name as orgDirector,user_orgname as orgName from wf_user where user_id in (select userid from Testrelgroup where tid = "+dsValues.Field("ntid").Value+")"; &#13;&#10;	dsRel.Open(sql);&#13;&#10;	&#13;&#10;	//主任所添加的试验项目&#13;&#10;	sql = "select id as tid,syxmmc as itemName,th as mapno from zh_syxmgl where id in (select tid from zrRelTestItem where zid = "+dsMain.Field("ntid").Value+")";&#13;&#10;	dsRelTestItem.Open(sql);&#13;&#10;	var count = dsRelTestItem.RecordCount;&#13;&#10;	for(var i = 0;i<count;i++){&#13;&#10;		dsRelTestItem.SetPos(i);&#13;&#10;		dsTask.Append();&#13;&#10;		dsTask.SetPos(i);&#13;&#10;		dsTask.Field("wfid").Value = wfid;&#13;&#10;		dsTask.Field("tid").Value = dsRelTestItem.Field("tid").Value;&#13;&#10;		dsTask.Field("testItemName").Value = dsRelTestItem.Field("itemName").Value;&#13;&#10;		dsTask.Field("userids").Value = "";&#13;&#10;		dsTask.Field("usersname").Value = "";&#13;&#10;		dsTask.fset_cont();&#13;&#10;	}&#13;&#10;	dsTask.SetPos(0);&#13;&#10;	grid12.SetFocus(grid12.tab.rows(1).cells(2),"程序给焦点");&#13;&#10;	&#13;&#10;	$get("label22").style.cursor = "pointer";&#13;&#10;	$get("label22").innerText = dsMain.Field("testProgram").Value;&#13;&#10;	$get("label22").onclick =saveOutline;//&#13;&#10;	&#13;&#10;	$get("label23").style.cursor = "pointer";&#13;&#10;	$get("label23").innerText = dsMain.Field("testDraw").Value;&#13;&#10;	$get("label23").onclick =saveDraw;// &#13;&#10;	&#13;&#10;	&#13;&#10;	&#13;&#10;}&#13;&#10;&#13;&#10;//添加参试人员&#13;&#10;function addUser(gird){&#13;&#10;	dsTemp.Open("select 1 from dual where 1 <> 1");&#13;&#10;	var sql = "select user_name as 姓名,user_orgname as 组织,user_id as userids,user_name as usersname from wf_user u where u.user_orgid = 228 and u.user_id in (select user_id from wf_user_role where role_id = 71)";&#13;&#10;	SelectZlSql(sql,"是","userids,usersname","",gird);&#13;&#10;	var count = dsTemp.RecordCount;&#13;&#10;	if(count == 0)&#13;&#10;		return;&#13;&#10;	var userids = "";&#13;&#10;	var usernames = "";&#13;&#10;	&#13;&#10;	try{&#13;&#10;		for(var i =0 ;i<count;i++){&#13;&#10;			dsTemp.SetPos(i);&#13;&#10;			if(i == 0){&#13;&#10;				userids += dsTemp.Field("userids").Value;&#13;&#10;				usernames += dsTemp.Field("usersname").Value;&#13;&#10;				continue;&#13;&#10;			}&#13;&#10;			userids += "," + dsTemp.Field("userids").Value;&#13;&#10;			usernames += "," + dsTemp.Field("usersname").Value;&#13;&#10;		}&#13;&#10;		dsTask.Fields.Field["userids"].Value = userids;&#13;&#10;		dsTask.Fields.Field["usersname"].Value = usernames;&#13;&#10;		dsTask.fset_cont();&#13;&#10;		&#13;&#10;		dsTask.RecNo=0&#13;&#10;		grid12.hide();&#13;&#10;		//为主管试验员加载数据&#13;&#10;		grid12.onCellChange = function () {&#13;&#10;			//alert(event.newTD.cz.xml);&#13;&#10;			if(event.newTD.cellIndex != 3) return ;  //焦点是否在第三列上&#13;&#10;			var sHtml1 = "<code><format>姓名!|</format><sql1></sql1><xml>";&#13;&#10;			var sHtml2 = "</xml><blninput>否</blninput><blnempty>否</blnempty><check>2</check><onclickopen>event.showlist=true</onclickopen></code>";&#13;&#10;			var tds = "";&#13;&#10;			dsTask.RecNo = event.newTD.parentNode.rowIndex - 1;&#13;&#10;			var usernames = dsTask.Fields.Field["usersname"].Value.split(",");&#13;&#10;			var userids = dsTask.Fields.Field["userids"].Value.split(",");&#13;&#10;			for(var i = 0 ;i < userids.length;i++){&#13;&#10;				tds += "<tr><td>" + usernames[i] + "</td><td>" + userids[i] + "</td></tr>";&#13;&#10;			}&#13;&#10;			var sXml = sHtml1+tds+sHtml2 ;&#13;&#10;			grid12.tab.children[0].children[3].cz  = sXml;&#13;&#10;		}&#13;&#10;	}catch(e){&#13;&#10;		alert(e.message);&#13;&#10;	}&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//下载试验大纲&#13;&#10;function saveOutline(){&#13;&#10;	download(dsMain,"testProgram","testProgramPath");&#13;&#10;}&#13;&#10;&#13;&#10;//下载试件图纸&#13;&#10;function saveDraw(){&#13;&#10;	download(dsMain,"testDraw","testDrawPath");&#13;&#10;}&#13;&#10;&#13;&#10;//添加专业组&#13;&#10;function addOrg(){&#13;&#10;	//dsSour.Field(i).FieldName&#13;&#10;	var count = dsRel.RecordCount;&#13;&#10;	var userIds="-1";&#13;&#10;	for(var i =0 ;i<count;i++){&#13;&#10;		dsRel.SetPos(i);&#13;&#10;		userIds += ","+ dsRel.Fields.Field["userid"].Value;&#13;&#10;	}&#13;&#10;	var sql = 'select u.user_orgname as 专业组名称,u.user_name as 专业主任师,\'删 除\' as operator,u.user_id as userid,u.user_name as orgDirector,u.user_orgname as orgName from wf_user u, wf_user_role r where u.user_id = r.user_id and r.role_id = 61 and u.user_id not in ('+userIds+')';&#13;&#10;	SelectZlSql(sql,"是","","",grid10);&#13;&#10;	dsRel.OpenXmlData(dsRel.xml);&#13;&#10;}&#13;&#10;&#13;&#10;//添加试验项目&#13;&#10;function addTestItem(){&#13;&#10;	var count = dsRelTestItem.RecordCount;&#13;&#10;	var itemIds="-1";&#13;&#10;	for(var i =0 ;i<count;i++){&#13;&#10;		dsRelTestItem.SetPos(i);&#13;&#10;		itemIds += ","+ dsRelTestItem.Fields.Field["tid"].Value;&#13;&#10;	}&#13;&#10;	var sql = 'select z.syxmmc as 试验项目名称,z.th as 图号,\'删 除\' as operator,z.id as tid,z.syxmmc as itemName,z.th as mapno from zh_syxmgl z where z.id not in ('+itemIds+')';&#13;&#10;	SelectZlSql(sql,"是","","",grid11);&#13;&#10;	dsRelTestItem.OpenXmlData(dsRelTestItem.xml);&#13;&#10;}&#13;&#10;&#13;&#10;//删除表格行&#13;&#10;function del(ds){&#13;&#10;	ds.Delete();&#13;&#10;	//$eform('删除行');&#13;&#10;	//ds.OpenXmlData(ds.xml);&#13;&#10;}&#13;&#10;&#13;&#10;//下载文件&#13;&#10;function download(ds,nameField,pathField){&#13;&#10;	var path= ds.Fields.Field[pathField].Value;&#13;&#10;	var fileName= ds.Fields.Field[nameField].Value;&#13;&#10;	downloadByPath(fileName,path);&#13;&#10;}&#13;&#10;&#13;&#10;//上传文件&#13;&#10;//upType =1 上传大纲任务书&#13;&#10;//upType =2 上传试件图纸&#13;&#10;function upfile(upType) {&#13;&#10;	if(upload1.disabled)return;&#13;&#10;		var extName = upload1.extfiles;&#13;&#10;		&#13;&#10;		var tmpfileId = getMaxNo("UPF",fcpubdata.area.mkbh);&#13;&#10;		var url = location.protocol+"//"+location.host+ GetUrlFirstPart() + "/file.do?command=uploadFile&tmpfileId=" + tmpfileId  + "&extName=" + extName;&#13;&#10;	    window.showModalDialog(url,null,"scroll:no;status:no;dialogHeight:480px;dialogWidth:640px;dialogTop:180;dialogLeft:250px");&#13;&#10;	    &#13;&#10;	    //查询一下&#13;&#10;	    var arr = new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host+ GetUrlFirstPart() + "/file.do?command=getTmpFile&tmpfileId=" + tmpfileId,"",function (result){ &#13;&#10;	        var retX=result.value;&#13;&#10;			var oXml=SetDom(retX);&#13;&#10;			if(oXml.documentElement == null) {&#13;&#10;			    alert(retX);&#13;&#10;			    return null;&#13;&#10;			}&#13;&#10;			var tb=upload1.children[0];&#13;&#10;			for(var i=0;i<oXml.documentElement.childNodes.length;i++){&#13;&#10;				//表格列内容:&#13;&#10;				//图标 : 超级链接 : 备注 : 隐藏单据编号 : 标志(新增/删除/空) : 删除&#13;&#10;				if(isSpace(oXml.documentElement.childNodes(i).childNodes(0).text)==false){&#13;&#10;					var oTr=upload_addrow(tb);&#13;&#10;	&#13;&#10;					&#13;&#10;					//由扩展名得到图标路径.&#13;&#10;					var extName=oXml.documentElement.childNodes(i).childNodes(3).text;&#13;&#10;					var tmp_extname = extName.substring(1,extName.length) ;&#13;&#10;					&#13;&#10;					if (tmp_extname != "avi" && tmp_extname != "css" && tmp_extname != "doc" && tmp_extname != "gif" && tmp_extname != "htm" && tmp_extname != "jpg" && tmp_extname != "js" && tmp_extname != "mid" && tmp_extname != "psd" && tmp_extname != "rar" && tmp_extname != "txt" && tmp_extname != "wav" && tmp_extname != "xml" && tmp_extname != "xsl" && tmp_extname != "zip" && tmp_extname != "asf" && tmp_extname != "mpeg" && tmp_extname != "mpg" && tmp_extname != "pdf" && tmp_extname != "ppt" && tmp_extname != "swf" && tmp_extname != "au" && tmp_extname != "bmp" && tmp_extname != "ini" && tmp_extname != "mdb" && tmp_extname != "midi" && tmp_extname != "mov" && tmp_extname != "mp3" && tmp_extname !="xls"){&#13;&#10;						tmp_extname = "other" ;&#13;&#10;					}&#13;&#10;					var fileName1=tmp_extname+".gif";&#13;&#10;					var gifPath=fcpubdata.path+'/fceform/images/filetype/';&#13;&#10;					oTr.cells(0).innerHTML="<img src='"+gifPath+fileName1+"'></img>";&#13;&#10;	&#13;&#10;					&#13;&#10;					//隐藏单据编号&#13;&#10;					oTr.cells(3).innerText = oXml.documentElement.childNodes(i).childNodes(2).text + "⊙" + extName + "⊙" + oXml.documentElement.childNodes(i).childNodes(5).text;&#13;&#10;					&#13;&#10;					//备注&#13;&#10;					var bz = oXml.documentElement.childNodes(i).childNodes(4).text;&#13;&#10;					if(bz == "null")&#13;&#10;					{&#13;&#10;						bz = "";&#13;&#10;					}&#13;&#10;					oTr.cells(2).innerText = bz;&#13;&#10;					oTr.cells(4).innerText = "新增";&#13;&#10;					&#13;&#10;					var tmpPath = fcpubdata.path;&#13;&#10;					//超级链接 修改了路径  <a href="####" onclick="queryFirstPage()" >&#13;&#10;					//tb.rows(i).cells(1).innerHTML = "<a target='_blank' href='"+location.protocol+"//"+location.host+tmpPath+oXml.documentElement.childNodes(i).childNodes(0).text +"'>"+sepFile(oXml.documentElement.childNodes(i).childNodes(1).text)+"</a>";&#13;&#10;					oTr.cells(1).innerHTML = "<a href='####' onclick=downloadFileNew('"+oXml.documentElement.childNodes(i).childNodes(2).text+"') >" +oXml.documentElement.childNodes(i).childNodes(1).text+"</a>";&#13;&#10;					//删除&#13;&#10;					oTr.cells(5).innerHTML = "<span style='cursor:hand;color:blue;text-decoration:underline;width:70px' onclick='uploadDelFile("+i+")'  >删除</span>";&#13;&#10;					//后台的临时文件名,包含路径&#13;&#10;					oTr.cells(6).innerText = oXml.documentElement.childNodes(i).childNodes(0).text;&#13;&#10;					&#13;&#10;				}&#13;&#10;			}&#13;&#10;			var array = getUploadFile();&#13;&#10;			var now = array.length-1;&#13;&#10;            var info = array[now];&#13;&#10;            if(info != null){&#13;&#10;				var namefile = info[1];&#13;&#10;				var namepath = info[2];&#13;&#10;				if(upType == '1'){&#13;&#10;					dsMain.Field("testProgram").Value = namefile;&#13;&#10;					dsMain.Field("testProgramPath").Value = namepath;&#13;&#10;					$get("text12").value = namefile;&#13;&#10;				}else{&#13;&#10;					dsMain.Field("testDraw").Value = namefile;&#13;&#10;					dsMain.Field("testDrawPath").Value = namepath;&#13;&#10;					$get("text10").value = namefile;&#13;&#10;				}&#13;&#10;			}&#13;&#10;		});	&#13;&#10;	     &#13;&#10;	 	fcpubdata.isEdit=true;&#13;&#10;	 	//return arr;  &#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" unselectable="on" userType BLONclose BLONopenBefore center="  " contxml="<root><label><id>label1</id><id>label2</id><id>label3</id><id>label4</id><id>label5</id><id>label6</id><id>label7</id><id>label8</id><id>label9</id><id>label10</id><id>label12</id><id>label21</id><id>label16</id><id>label20</id><id>label22</id><id>label23</id></label><combobox><id>combobox1</id></combobox><tab><id>tab1</id></tab><text><id>text1</id><id>text2</id><id>text3</id><id>text4</id><id>text5</id><id>text6</id><id>text7</id><id>text8</id><id>text9</id><id>text13</id></text><grid><id>grid12</id><id>grid11</id><id>grid10</id><id>grid13</id></grid><dataset><id>dsMain</id><id>dsRel</id><id>dsValues</id><id>dsRelTestItem</id><id>dsTask</id><id>dsTemp</id></dataset></root>" controlno="SKButton:0;SKDBedit:0;checkbox:1;label:23;radio:0;listbox:0;textarea:0;combobox:4;password:0;upload:2;SKDBtext:0;chart:0;dbimg:0;img:2;SKBILLgrid:0;shape:0;tab:1;div:4;DsMain_field:0;a:2;button:8;text:13;hr:0;checkboxlist:0;radiolist:0;dropdownlist:3;grid:13;dataset:6;spin:0;excel:0;tree:0;ebshow:0;ebiao:1;layout:1" billtaborder="<root><taborder>text1</taborder><taborder>combobox1</taborder><taborder>text2</taborder><taborder>text3</taborder><taborder>text4</taborder><taborder>text5</taborder><taborder>text6</taborder><taborder>text7</taborder><taborder>text8</taborder><taborder>text9</taborder><taborder>grid10</taborder><taborder>grid11</taborder><taborder>text13</taborder><taborder>grid12</taborder><taborder>grid13</taborder></root>" isfile="是" posheight poswidth postop posleft window="当前窗口" BLONopen="onLoad()" caption="专业主任师分配试验任务" type="FLOW" dj_sn="zyzrsfpsyrw" toolbar="确定_取消"><IMG id=dsMain onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 311px; WIDTH: 39px; POSITION: absolute; TOP: 275px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" queryTableName="SJ_ZRFJSYRW" datasourceName="tdm" formatxml='<root><tr rowstate="add"><td>testDrawPath</td><td>试验图纸路径</td><td>字符</td><td>255</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>testProgramPath</td><td>文件路径</td><td>字符</td><td>255</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>testDraw</td><td>试验图纸</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>ntid</td><td>主键</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>wfId</td><td>流程实例ID</td><td>字符</td><td>22</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>testProgram</td><td>文件名称</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' async="否" masterdsfield masterds subdsfield idparam="SEQ_WF_PROJECT_TASK" savetable opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="4" isaddemptyrec="否" opensortno="1" pubpara="否" isSubGrid="否" saveastable controltype="dataset" idtype="3"><IMG id=dsRel onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 415px; WIDTH: 39px; POSITION: absolute; TOP: 277px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" queryTableName="testRelGroup" datasourceName="tdm" formatxml='<root><tr rowstate="add"><td>tid</td><td>试验任务ID</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>userid</td><td>用户ID</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>ntid</td><td>主键</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>orgName</td><td>专业组名称</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>orgDirector</td><td>专业主任师</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' async="否" masterdsfield masterds subdsfield idparam="SEQ_testRelGroup" savetable opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="4" isaddemptyrec="否" opensortno="2" pubpara="否" isSubGrid="否" saveastable controltype="dataset" idtype="3"><LABEL onmove=move() oncontrolselect=controlselect() id=label1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 18px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 19px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">试验任务名称:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 129px; WIDTH: 169px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 15px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="testName" china="试验任务名称" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 380px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 19px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">试验任务编号:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text2 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 492px; WIDTH: 169px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 15px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="testNum" china="试验任务编号" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 18px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 59px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">试验种类:</LABEL><SELECT onmove=move() oncontrolselect=controlselect() id=combobox1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 129px; WIDTH: 170px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 56px; HEIGHT: 25px" disabled onmovestart=moveStart() datasourceName async="否" controltype="combobox" field="testType" china="试验种类" dataset="dsValues" check="1" tempvalue="1&#13;&#10;2&#13;&#10;3&#13;&#10;4" temptext="静力试验&#13;&#10;振动试验&#13;&#10;疲劳试验&#13;&#10;系统试验" sql><OPTION value=1 selected>静力试验</OPTION><OPTION value=2>振动试验</OPTION><OPTION value=3>疲劳试验</OPTION><OPTION value=4>系统试验</OPTION></SELECT><LABEL onmove=move() oncontrolselect=controlselect() id=label4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 380px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 60px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">架次:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text3 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 492px; WIDTH: 169px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 56px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="vehicles" china="架次" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 18px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 98px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">机型:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text4 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 129px; WIDTH: 171px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 94px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="Models" china="机型" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 380px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 102px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">图号:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text5 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 492px; WIDTH: 169px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 94px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="mapNo" china="图号" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 18px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 141px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">试件名称:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text6 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 129px; WIDTH: 171px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 137px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="specimenName" china="试件名称" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label8 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 380px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 144px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">委托单位:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text7 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 492px; WIDTH: 169px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 137px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="authorizedBy" china="委托单位" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label9 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 18px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 184px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">数量:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text8 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 129px; WIDTH: 171px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 180px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="quantity" china="数量" dataset="dsValues"><LABEL onmove=move() oncontrolselect=controlselect() id=label10 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 380px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 186px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">计划结束时间:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text9 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 492px; WIDTH: 169px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 180px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=30 controltype="text" field="planEndDate" china="计划结束日期" dataset="dsValues"> <LABEL onmove=move() oncontrolselect=controlselect() id=label12 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 19px; WIDTH: 89px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 310px; HEIGHT: 16px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">试件图纸:</LABEL> 
<DIV id=tab1 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=page_onresize() style="LEFT: 17px; WIDTH: 650px; POSITION: absolute; TOP: 340px; HEIGHT: 320px" onmovestart=moveStart() controltype="tab" value="分配任务" CustomAttr="font-color:red">
<TABLE onmousedown=pageonclick() id=fcpagesubtable onresizestart=CancelEvent() bgColor=white>
<TBODY>
<TR contentEditable=false>
<TD style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; FONT-SIZE: 3px; BORDER-LEFT: #8ba7b6 1px solid; COLOR: black; BACKGROUND-COLOR: white" align=middle width=80 height=20><FONT size=2>分配任务</FONT></TD>
<TD style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; COLOR: red; BACKGROUND-COLOR: white" align=middle width=80 height=20><FONT size=2>试验项目</FONT></TD>
<TD style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; COLOR: black; BACKGROUND-COLOR: white" align=middle width=80 height=20><FONT size=2>参与试验专业组</FONT></TD></TR></TBODY></TABLE>
<DIV oncontrolselect=controlselect() id=fcpagesub onresizestart=CancelEvent() style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; WIDTH: 648px; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; TOP: 22px; HEIGHT: 300px; BACKGROUND-COLOR: white" onmovestart=CancelEvent()><IMG id=grid12 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 0px; WIDTH: 646px; POSITION: absolute; TOP: 24px; HEIGHT: 273px" onmovestart=moveStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dsTask" visible="是" titlerowheight titlerows usertitlehtml usertitle readonly="否" canselect="是" autoappend="否" autoheight="否" autowidth="否" SetRowHeight="是" hideHscroll="否" hideVscroll="否" blRowNo="否" bodyrowheight="-1" bodyrows="-1" iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0"><LABEL onmove=move() oncontrolselect=controlselect() id=label21 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 10pt; LEFT: 3px; WIDTH: 204px; COLOR: #ff0000; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 7px; HEIGHT: 14px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="是">*注:所有试验项目都必需分配到人!</LABEL></DIV>
<DIV oncontrolselect=controlselect() id=fcpagesub onresizestart=CancelEvent() style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; Z-INDEX: 1; BORDER-LEFT: #8ba7b6 1px solid; WIDTH: 648px; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; TOP: 22px; HEIGHT: 300px; BACKGROUND-COLOR: white" onmovestart=CancelEvent()><IMG id=grid11 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 0px; WIDTH: 647px; POSITION: absolute; TOP: 0px; HEIGHT: 290px" onmovestart=moveStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dsRelTestItem" visible="是" titlerowheight titlerows usertitlehtml usertitle readonly="是" canselect="是" autoappend="否" autoheight="否" autowidth="否" SetRowHeight="是" hideHscroll="否" hideVscroll="否" blRowNo="否" bodyrowheight="-1" bodyrows="-1" iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0"> </DIV>
<DIV oncontrolselect=controlselect() id=fcpagesub onresizestart=CancelEvent() style="BORDER-RIGHT: #8ba7b6 1px solid; BORDER-TOP: #8ba7b6 1px solid; BORDER-LEFT: #8ba7b6 1px solid; WIDTH: 648px; BORDER-BOTTOM: #8ba7b6 1px solid; POSITION: absolute; TOP: 22px; HEIGHT: 300px; BACKGROUND-COLOR: white" onmovestart=CancelEvent()>&nbsp;<IMG id=grid10 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 0px; WIDTH: 647px; POSITION: absolute; TOP: 0px; HEIGHT: 290px" onmovestart=moveStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dsRel" visible="是" titlerowheight titlerows usertitlehtml usertitle readonly="否" canselect="是" autoappend="否" autoheight="否" autowidth="否" SetRowHeight="是" hideHscroll="否" hideVscroll="否" blRowNo="否" bodyrowheight="-1" bodyrows="-1" iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0"> </DIV></DIV><LABEL onmove=move() oncontrolselect=controlselect() id=label16 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 18px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 268px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">试验大纲任务书:</LABEL><IMG id=dsValues onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 778px; WIDTH: 39px; POSITION: absolute; TOP: 91px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" queryTableName="WF_PROJECT_TASK" datasourceName formatxml="<root><tr rowstate=&quot;add&quot;><td>ntid</td><td>主键</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>quantity</td><td>数量</td><td>字符</td><td>4</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>planEndDate</td><td>计划结束日期</td><td>字符</td><td>20</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td>$valid('日期');</td><td></td><td></td><td>$eform('选择日期')</td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>testType</td><td>试验种类</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>vehicles</td><td>架次</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>Models</td><td>机型</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>mapNo</td><td>图号</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>specimenName</td><td>试件名称</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>authorizedBy</td><td>委托单位</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>wf_id</td><td>流程实例ID</td><td>字符</td><td>22</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>taskBookNo</td><td>任务书编号</td><td>字符</td><td>50</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>testName</td><td>试验任务名称</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate=&quot;add&quot;><td>testNum</td><td>试验任务编号</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>" async="否" masterdsfield masterds subdsfield idparam savetable opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="4" isaddemptyrec="否" opensortno="1" pubpara="否" isSubGrid="否" saveastable controltype="dataset" idtype="1"><LABEL onmove=move() oncontrolselect=controlselect() id=label20 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 18px; WIDTH: 105px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 222px; HEIGHT: 18px" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">试验大纲任务书编号:</LABEL><INPUT onmove=move() oncontrolselect=controlselect() id=text13 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 129px; WIDTH: 532px; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 225px; HEIGHT: 26px; TEXT-ALIGN: left" onmovestart=moveStart() readOnly size=92 controltype="text" field="taskBookNo" china="任务书编号" dataset="dsValues"><IMG id=dsRelTestItem onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 531px; WIDTH: 39px; POSITION: absolute; TOP: 276px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" queryTableName="zrRelTestItem" datasourceName="tdm" formatxml='<root><tr rowstate="add"><td>zid</td><td>主任务分解试验ID</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>ntid</td><td>主键</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>tid</td><td>试验项目ID</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>itemName</td><td>项目名称</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>center</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>mapNo</td><td>图号</td><td>字符</td><td>50</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' async="否" masterdsfield masterds subdsfield idparam="SEQ_zrRelTestItem" savetable opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="4" isaddemptyrec="否" opensortno="1" pubpara="否" isSubGrid="否" saveastable controltype="dataset" idtype="3"><IMG id=dsTask onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 741px; WIDTH: 39px; POSITION: absolute; TOP: 388px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" queryTableName="SJ_ZRSFPSYRW" datasourceName="tdm" formatxml='<root><tr rowstate="add"><td>ntid</td><td>主键</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>wfid</td><td>流程实例ID</td><td>字符</td><td>22</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>tid</td><td>所选试验项目ID</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>userids</td><td>参试人员</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>headTest</td><td>主管试验员</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>testItemName</td><td>项目名称</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>usersName</td><td>参试人员</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td>addUser(grid13)</td><td></td><td></td></tr><tr rowstate="add"><td>headTestName</td><td>主管试验员</td><td>字符</td><td>30</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' async="否" masterdsfield masterds subdsfield idparam="SEQ_SJ_ZRSFPSYRW" savetable="SJ_ZRSFPSYRW" opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="1" isaddemptyrec="否" opensortno="1" pubpara="否" isSubGrid="否" saveastable controltype="dataset" idtype="3"><LABEL onmove=move() oncontrolselect=controlselect() id=label22 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 128px; WIDTH: 533px; COLOR: #0000ff; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 270px; HEIGHT: 16px; BACKGROUND-COLOR: #c0c0c0; TEXT-DECORATION: underline" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">label22</LABEL><LABEL onmove=move() oncontrolselect=controlselect() id=label23 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() onresize=resize() style="FONT-SIZE: 12pt; LEFT: 128px; WIDTH: 532px; COLOR: #0000ff; FONT-STYLE: normal; FONT-FAMILY: 宋体; POSITION: absolute; TOP: 309px; HEIGHT: 16px; BACKGROUND-COLOR: #c0c0c0; TEXT-DECORATION: underline" onmovestart=moveStart() controltype="label" NotBg="否" inputTag="否">label22</LABEL><IMG id=grid13 onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 717px; WIDTH: 52px; POSITION: absolute; TOP: 464px; HEIGHT: 32px" onmovestart=moveStart() src="../../fceform/images/ef_designer_webgrid.gif" controltype="grid" dataset="dsTemp" visible="否" titlerowheight titlerows usertitlehtml usertitle readonly="否" canselect="是" autoappend="否" autoheight="否" autowidth="否" SetRowHeight="是" hideHscroll="否" hideVscroll="否" blRowNo="否" bodyrowheight="-1" bodyrows="-1" iscrosstab="否" crosstabtitle crosstabsumtype="0" crosstabformat rowtitle coltitle rcount="否" rsum="否" rmin="否" rmax="否" ravg="否" ccount="否" csum="否" cmin="否" cmax="否" cavg="否" crosstabsql crosstabdatatype="0"><IMG id=dsTemp onresizeend=resizeEnd() onresizestart=resizeStart() onmoveend=moveEnd() style="LEFT: 844px; WIDTH: 39px; POSITION: absolute; TOP: 451px; HEIGHT: 47px" onmovestart=moveStart() src="../../fceform/images/ef_designer_dataset.gif" queryTableName="SJ_ZRSFPSYRW" datasourceName="tdm" formatxml='<root><tr rowstate="add"><td>ntid</td><td>主键</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>是</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>wfid</td><td>流程实例ID</td><td>字符</td><td>22</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>tid</td><td>所选试验项目ID</td><td>字符</td><td>10</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>userids</td><td>参试人员</td><td>字符</td><td>100</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>headTest</td><td>主管试验员</td><td>字符</td><td>11</td><td></td><td>数据项</td><td></td><td></td><td>否</td><td>否</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>testItemName</td><td>项目名称</td><td>字符</td><td>10</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr rowstate="add"><td>usersName</td><td>参试人员</td><td>字符</td><td>100</td><td>0</td><td>数据项</td><td></td><td></td><td>是</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td>addUser(grid12)</td><td></td><td></td></tr><tr rowstate="add"><td>headTestName</td><td>主管试验员</td><td>字符</td><td>30</td><td>0</td><td>数据项</td><td></td><td></td><td>选%3Ccode%3E%3Cformat%3E%3C/format%3E%3Cblninput%3E%u662F%3C/blninput%3E%3Cblnempty%3E%u5426%3C/blnempty%3E%3Ccheck%3E1%3C/check%3E%3C/code%3E</td><td>是</td><td>否</td><td>否</td><td>是</td><td>否</td><td>否</td><td>否</td><td></td><td></td><td>left</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></root>' async="否" masterdsfield masterds subdsfield idparam="SEQ_SJ_ZRSFPSYRW" savetable opensql AfterScroll BeforeScroll AfterPost BeforePost BeforeOpen AfterOpen issubds="否" submitno="1" submittype="4" isaddemptyrec="否" opensortno="1" pubpara="否" isSubGrid="否" saveastable controltype="dataset" idtype="3"></DIV>