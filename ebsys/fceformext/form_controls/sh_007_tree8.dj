<script>function uf_newsql1() {&#13;&#10;	var s1='';&#13;&#10;	alert(s1)&#13;&#10;	//新的sql语句&#13;&#10;	var newsql = "select sdeptcode,sdeptname from FCS_DEPT where sdeptname like '销%' order by sdeptcode " ;&#13;&#10;	//清空原来的树数据&#13;&#10;	$id("tree1").innerHTML="";&#13;&#10;	TreeRefresh($id("tree1"),newsql);	&#13;&#10;}&#13;&#10;function uf_newsql2() {&#13;&#10;	$id("tree1").innerHTML="";&#13;&#10;	TreeRefresh($id("tree1"));	&#13;&#10;	&#13;&#10;}&#13;&#10;function uf_newsql() {&#13;&#10;	//新的sql语句 &#13;&#10;	var newsql = "select sdeptcode,sdeptname,sdeptid from FCS_DEPT where sdeptname like '库%'  order by sdeptcode " ;&#13;&#10;	//由SQL语句得到新的树数据&#13;&#10;	var tmp1 = new Eapi.RunAjax().sendHttp(location.protocol+"//"+location.host + fcpubdata.servletPath +"/WebBill"&#13;&#10;		+fcpubdata.dotnetVersion+"?key=getTreeXml","<sql>" + RepXml(newsql) + "</sql>") ;&#13;&#10;	&#13;&#10;	//清空原来的树数据&#13;&#10;	document.getElementById("tree1").innerHTML="";&#13;&#10;	&#13;&#10;	//构建新的树&#13;&#10;	var tree1=new xtreeItem("","根","","","","",true,"",""); &#13;&#10;	&#13;&#10;	Global.checkedType = 3;&#13;&#10;	&#13;&#10;	tree1.setup(document.getElementById("tree1"));&#13;&#10;	tree1.loadXmlStr('<TreeNode >'+tmp1+'</TreeNode>');&#13;&#10;}&#13;&#10;//取多选时选中的值&#13;&#10;function uf_getvalue(){&#13;&#10;	var arr = TreeGetMultiValue($id("tree1"));&#13;&#10;	if(arr == null){&#13;&#10;		alert("没有选中任何节点");&#13;&#10;	}else{&#13;&#10;		var s = "";&#13;&#10;		for(var i=0;i<arr.length;i++){&#13;&#10;			s +="选中的第"+i+"节点: "&#13;&#10;			s += "code值:"+arr[i].code;	&#13;&#10;			s += "text值:"+arr[i].text;&#13;&#10;		}&#13;&#10;		alert(s);&#13;&#10;	}&#13;&#10;}&#13;&#10;//设置多选&#13;&#10;function uf_setvalue(){&#13;&#10;	TreeSetMultiValue($id("tree1"),"ZAB00000103,ZAB00000105");&#13;&#10;}&#13;&#10;function uf_select() {&#13;&#10;		//tree1.select();&#13;&#10;		//tree1.FindNode(tree1,"text","库房二部");&#13;&#10;		tree1.FindNode(tree1,"code","005033")&#13;&#10;&#13;&#10;}&#13;&#10;</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" unselectable="on" toolbar="不带工具栏" dj_sn="sh_007_tree8" type="SH1" caption="动态SQL语句生成树" mkbh codeheader="BBB" keyfield window="当前窗口" entertype="修改" posleft postop poswidth posheight isfile="是" OtherSave="否" idtype="1" billtaborder="<root><taborder>button2</taborder><taborder>button3</taborder><taborder>button4</taborder><taborder>button5</taborder><taborder>button6</taborder><taborder>button7</taborder><taborder>button8</taborder><taborder>button9</taborder><taborder>button10</taborder><taborder>button11</taborder><taborder>text1</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:2;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:11;text:1;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:2;ebshow:0;ebiao:0;layout:0;page:0;eblayout:0;test:undefined" contxml="<root><label><id>label2</id></label><button><id>button2</id><id>button3</id><id>button4</id><id>button5</id><id>button6</id><id>button7</id><id>button8</id><id>button9</id><id>button10</id><id>button11</id></button><text><id>text1</id></text><tree><id>tree1</id></tree></root>"><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 213px; DISPLAY: block; HEIGHT: 350px; BORDER-TOP: 1px solid; TOP: 42px; BORDER-RIGHT: 1px solid; LEFT: 11px" id=tree1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" sql="select sdeptcode,sdeptname,sdeptcode as id from FCS_DEPT  order by sdeptcode " opentb="_self" isAll="否" ischecked="否" sourcetype="1" roottext="根" clicknode="alert(Global.selectedItem.childNodes.length);" xml='<TreeNode id="1" text="aa" roottarget="_blank" rootaction=""  target="_blank" title="aa"  icon=""  check="undefined" code=""><TreeNode id="2" text="节点1"  target="_blank" title="节点1"  icon=""  check="undefined" code=""/><TreeNode id="3" text="节点2"  target="_blank" title="节点2"  icon=""  check="undefined" code=""><TreeNode id="4" text="节点21"  target="_blank" title="节点21"  icon=""  check="undefined" code=""/><TreeNode id="5" text="节点22"  target="_blank" title="节点22"  icon=""  check="undefined" code=""/><TreeNode id="6" text="节点23"  target="_blank" title="节点23"  icon=""  check="undefined" code=""><TreeNode id="7" text="增加节点"  target="_blank" title="增加节点"  icon=""  check="undefined" code=""/></TreeNode></TreeNode><TreeNode id="8" text="节点3"  target="_blank" title="节点3"  icon=""  check="undefined" code=""/><TreeNode id="9" text="增加节点"  target="_blank" title="增加节点"  icon=""  check="undefined" code=""/></TreeNode>' controltype="tree" datasourceName>&nbsp;<BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 202px; HEIGHT: 25px; TOP: 56px; LEFT: 292px" id=button2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_newsql1()")'>用新的sql语句来产生树数据</BUTTON><INPUT onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 123px; HEIGHT: 20px; TOP: 142px; LEFT: 295px" id=text1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() value=库 size=22 controltype="text"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 140px; LEFT: 427px" id=button3 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_newsql2()")'>直接刷新</BUTTON> 
<DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 36px; HEIGHT: 15px; TOP: 120px; LEFT: 296px" id=label2 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() noWrap controltype="label" NotBg="否" value="label2">模糊查询值:</DIV><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 205px; HEIGHT: 25px; TOP: 86px; LEFT: 291px" id=button4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_newsql()")'>变成可以多选的树</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 120px; HEIGHT: 25px; TOP: 86px; LEFT: 503px" id=button5 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_getvalue()")'>取多选时选中的值</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 109px; HEIGHT: 25px; TOP: 86px; LEFT: 632px" id=button6 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_setvalue()")'>设置多选</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 190px; LEFT: 294px" id=button7 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("tree1.expandAll()")'>expandall</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 75px; HEIGHT: 25px; TOP: 190px; LEFT: 381px" id=button8 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("tree1.collapseAll();")'>收缩all</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 143px; HEIGHT: 25px; TOP: 190px; LEFT: 479px" id=button9 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_select()")'>选中某个节点</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 128px; HEIGHT: 25px; TOP: 250px; LEFT: 290px" id=button10 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;TreeRootNodeHide($id('tree1'), 'none')&quot;)">隐藏树根节点</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 121px; HEIGHT: 25px; TOP: 250px; LEFT: 447px" id=button11 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick="bill_onclick(&quot;TreeRootNodeHide($id('tree1'), '')&quot;)">显示树根节点</BUTTON></DIV>