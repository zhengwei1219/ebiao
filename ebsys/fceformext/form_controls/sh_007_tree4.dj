<script>//增加节点&#13;&#10;function AddNode()&#13;&#10;{&#13;&#10;	if(Global.selectedItem!=null)&#13;&#10;	{&#13;&#10;		//alert(new treeItem("增加节点","","","","","","bbb").toString().outerHTML);&#13;&#10;		Global.selectedItem.add(new xtreeItem(Global.getId(),"增加节点","","","","","",""));&#13;&#10;	}&#13;&#10;	else&#13;&#10;	{&#13;&#10;		window.alert("请选择要增加节点的位置！");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;}&#13;&#10;//删除节点&#13;&#10;function DelNode()&#13;&#10;{&#13;&#10;	if(Global.selectedItem==null)&#13;&#10;	{&#13;&#10;		alert("请选择要删除的节点！");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	if(Global.selectedItem==Global.selectedItem.root())&#13;&#10;	{&#13;&#10;		alert("不能删除根节点！");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	&#13;&#10;	Global.selectedItem.remove(Global.selectedItem);&#13;&#10;}&#13;&#10;//编辑节点&#13;&#10;function uf_edit()&#13;&#10;{&#13;&#10;	if(Global.selectedItem==null)&#13;&#10;	{&#13;&#10;		alert("请选择要编辑的节点！");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	var obj = new Object() ;&#13;&#10;	obj.text = Global.selectedItem.text;&#13;&#10;	obj.code = Global.selectedItem.code;&#13;&#10;	obj.title = Global.selectedItem.title;&#13;&#10;	&#13;&#10;	var oNode = DjOpen('TreeEdit',obj,'展现','有模式窗口');&#13;&#10;	//alert(sVal);&#13;&#10;	if (Global.selectedItem!=null && typeof oNode != "undefined")&#13;&#10;	{&#13;&#10;		Global.selectedItem.setText(oNode.text);&#13;&#10;		Global.selectedItem.code = oNode.code ;&#13;&#10;		Global.selectedItem.title = oNode.title;&#13;&#10;	}&#13;&#10;}&#13;&#10;//增加子节点&#13;&#10;function insertNode(bAfter) {&#13;&#10;	if(Global.selectedItem!=null)&#13;&#10;	{&#13;&#10;		Global.selectedItem.insert(new xtreeItem(Global.getId(),"增加节点","","","","","",""),bAfter);&#13;&#10;	}&#13;&#10;	else&#13;&#10;	{&#13;&#10;		window.alert("请选择要增加节点的位置！");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;}&#13;&#10;//删除子节点&#13;&#10;function DelSubNode()&#13;&#10;{&#13;&#10;	if(Global.selectedItem==null)&#13;&#10;	{&#13;&#10;		alert("请选择要删除的节点！");&#13;&#10;		return;&#13;&#10;	}&#13;&#10;	var p = Global.selectedItem;&#13;&#10;	var len = Global.selectedItem.childNodes.length;&#13;&#10;	for(var i=len-1;i>=0;i--){&#13;&#10;		Global.selectedItem = p.childNodes[i];&#13;&#10;		Global.selectedItem.remove();&#13;&#10;	}&#13;&#10;	Global.selectedItem = p;	&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcstring.js&#13;&#10;fcnumdate.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" unselectable="on" contxml="<root><button><id>FCButton7</id><id>FCButton8</id><id>FCButton4</id><id>FCButton5</id><id>FCButton6</id><id>button1</id></button><tree><id>tree1</id></tree></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:0;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:0;DsMain_field:0;a:0;button:1;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:1;ebshow:0;ebiao:0;layout:0" billtaborder="<root><taborder>FCButton7</taborder><taborder>FCButton8</taborder><taborder>FCButton4</taborder><taborder>FCButton5</taborder><taborder>FCButton6</taborder><taborder>button1</taborder></root>" idtype="1" OtherSave="否" isfile="是" posheight poswidth postop posleft entertype="修改" window="当前窗口" keyfield codeheader="BBB" mkbh caption="可编辑的树控件" type="SH1" dj_sn="sh_007_tree4" toolbar="不带工具栏"><IMG onresizeend=resizeEnd() style="BORDER-BOTTOM: 1px solid; POSITION: absolute; BORDER-LEFT: 1px solid; WIDTH: 205px; DISPLAY: block; HEIGHT: 270px; BORDER-TOP: 1px solid; TOP: 34px; BORDER-RIGHT: 1px solid; LEFT: 21px" id=tree1 onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() src="../../fceform/images/ef_designer_tree.gif" controltype="tree" xml='<TreeNode id="1" text="treeItem" roottarget="_self" rootaction=""  target="_self" title="treeItem"  icon=""  check="undefined" code=""><TreeNode id="2" text="增加节点"  target="_self" title="增加节点"  icon=""  check="undefined" code=""/></TreeNode>' clicknode roottext="根" sourcetype="0" ischecked="false" isAll="true" opentb="_self"><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 32px; LEFT: 248px" id=FCButton7 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("insertNode()")' dropstyle="否">插入</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 60px; LEFT: 248px" id=FCButton8 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("insertNode(true)")' dropstyle="否">增加</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 88px; LEFT: 248px" id=FCButton4 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("AddNode()")' dropstyle="否">增加子</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 116px; LEFT: 248px" id=FCButton5 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("DelNode()")' dropstyle="否">删除节点</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 144px; LEFT: 248px" id=FCButton6 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("uf_edit()")' dropstyle="否">编辑</BUTTON><BUTTON onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 75px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 174px; LEFT: 247px" id=button1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() controltype="button" fc_onclick='bill_onclick("DelSubNode()")' dropstyle="否">删除子节点</BUTTON></DIV>