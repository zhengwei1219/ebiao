<script>var MainDiv = parent.dialogArguments[0]; //外面的大的SKbillsheet DIV&#13;&#10;var myObj = parent.dialogArguments[1]; //当前控件&#13;&#10;var objType = myObj.controltype; //控件类型&#13;&#10;var objid = myObj.id;&#13;&#10;var isMultiObj = parent.dialogArguments[2]; //选中多个控件&#13;&#10;if(isMultiObj){&#13;&#10;	objType = myObj[0].controltype;&#13;&#10;	objid = myObj[0].id;&#13;&#10;}&#13;&#10;&#13;&#10;function uf_open(){&#13;&#10;    SetButtonImage($id("cmdOk"),"../../fceform/images/ef_run_button_ok.gif");&#13;&#10;    SetButtonImage($id("cmdClose"),"../../fceform/images/ef_run_button_close.gif");&#13;&#10;	SendHttp(location.protocol+"//"+location.host+ fcpubdata.servletPath + "/WebBill"+fcpubdata.dotnetVersion+"?key=roleSet","",function(result){&#13;&#10;		if(result.value == null)return;&#13;&#10;		$id("div1").innerHTML = result.value;&#13;&#10;		var oXmlAll=SetDom("<root>"+MainDiv.roleXml+"</root>");&#13;&#10;		if(objType == "dataset"){&#13;&#10;		    var oXml = oXmlAll.selectSingleNode("root/record[@id = '"+objid+"' and @fieldname = '"+ myObj.curFieldName +"' ]");&#13;&#10;		}else{&#13;&#10;		    var oXml = oXmlAll.selectSingleNode("root/record[@id = '"+objid+"']");&#13;&#10;		}&#13;&#10;		if(oXml == null) return;&#13;&#10;		&#13;&#10;		var irows = document.all.tab.rows.length;&#13;&#10;		if (irows >0)&#13;&#10;		{&#13;&#10;			for(var i=0;i<irows;i++)&#13;&#10;			{&#13;&#10;				var strName = document.all.tab.rows[i].cells[0].innerText;&#13;&#10;				strName = strName.replace(/^\s*/, "").replace(/\s*$/, "");&#13;&#10;				&#13;&#10;				var oNode = oXml.selectNodes("Name[@value = '"+strName+"']")&#13;&#10;				&#13;&#10;				if (oNode.length>0)&#13;&#10;				{&#13;&#10;					var chkDisplay = oNode(0).childNodes(0).text;&#13;&#10;					var chkDisabled = oNode(0).childNodes(1).text;&#13;&#10;					var chkRead = oNode(0).childNodes(2).text;&#13;&#10;					&#13;&#10;					eval("document.all.chkDisplay[i].checked = "+chkDisplay);&#13;&#10;					eval("document.all.chkDisabled[i].checked = "+chkDisabled);&#13;&#10;					eval("document.all.chkRead[i].checked = "+chkRead);&#13;&#10;				}&#13;&#10;			}&#13;&#10;		}&#13;&#10;	});&#13;&#10;}&#13;&#10;function uf_ok(){&#13;&#10;	var sbAll = new Sys.StringBuilder();&#13;&#10;	var sb = new Sys.StringBuilder();&#13;&#10;	var irows = document.all.tab.rows.length;&#13;&#10;	if (irows >0)&#13;&#10;	{&#13;&#10;		for(var i=0;i<irows;i++)&#13;&#10;		{&#13;&#10;			var chkDisplay = document.all.chkDisplay[i].checked;&#13;&#10;			var chkDisabled = document.all.chkDisabled[i].checked;&#13;&#10;			var chkRead = document.all.chkRead[i].checked;&#13;&#10;			if (chkDisplay != false || chkDisabled != false || chkRead != false)&#13;&#10;			{&#13;&#10;				var strName = document.all.tab.rows[i].cells[0].innerText;&#13;&#10;				strName = strName.replace(/^\s*/, "").replace(/\s*$/, "");&#13;&#10;				sb.append("<Name value='"+strName+"'>");&#13;&#10;				sb.append("<Display>"+chkDisplay+"</Display>");&#13;&#10;				sb.append("<Disabled>"+chkDisabled+"</Disabled>");&#13;&#10;				sb.append("<Read>"+chkRead+"</Read>");&#13;&#10;				sb.append("</Name>");&#13;&#10;			}&#13;&#10;		}&#13;&#10;		if(isMultiObj){&#13;&#10;			for(var j = 0 ;j< myObj.length;j++){&#13;&#10;				sb.append("<record id='"+myObj[j].id+"' controltype='"+myObj[j].controltype+"'");&#13;&#10;				sbAll.append(">");&#13;&#10;				sbAll.append(sb);&#13;&#10;				sbAll.append("</record>");&#13;&#10;&#13;&#10;			}&#13;&#10;		}else{&#13;&#10;			sbAll.append("<record id='"+objid+"' controltype='"+objType+"'");&#13;&#10;			if(objType == "dataset") sbAll.append(" fieldname='"+myObj.curFieldName+"'");&#13;&#10;			sbAll.append(">");&#13;&#10;			sbAll.append(sb);&#13;&#10;			sbAll.append("</record>");&#13;&#10;		}&#13;&#10;	}&#13;&#10;	window.returnValue = sbAll.toString();&#13;&#10;	window.close();&#13;&#10;	&#13;&#10;}</script> 
<DIV oncontrolselect=controlselect() id=SKbillsheet contentEditable=true jslib="fcopendj.js&#13;&#10;fcsavedj.js&#13;&#10;fcselfuse.js&#13;&#10;fcbasecont.js&#13;&#10;fcother.js&#13;&#10;selectdate.js&#13;&#10;~userfunc.js" dj_sn="roleSet" caption="权限设置" type="OF" isfile="是" center="居中" posleft postop poswidth="400" posheight="500" toolbar="不带工具栏" window="有模式窗口" BLONopen="uf_open()" BLONclose idtype="1" entertype="修改" keyfield codeheader OtherSave="否" runsave billtaborder="<root><taborder>cmdOk</taborder><taborder>cmdClose</taborder></root>" controlno="SKButton:0;SKDBedit:0;checkbox:0;label:1;radio:0;listbox:0;textarea:0;combobox:0;password:0;upload:0;SKDBtext:0;chart:0;dbimg:0;img:0;SKBILLgrid:0;shape:0;tab:0;div:1;DsMain_field:0;a:0;button:2;text:0;hr:0;checkboxlist:0;radiolist:0;dropdownlist:0;grid:0;dataset:0;spin:0;excel:0;tree:0;ebshow:0;ebiao:0;layout:0;page:0" contxml="<root><label><id>label1</id></label><div><id>div1</id></div><button><id>cmdOk</id><id>cmdClose</id></button></root>" unselectable="on" BLONopenBefore><DIV onresizeend=resizeEnd() oncontrolselect=controlselect() style="BORDER-BOTTOM: black 1px solid; POSITION: absolute; BORDER-LEFT: black 1px solid; OVERFLOW-X: auto; OVERFLOW-Y: auto; WIDTH: 392px; HEIGHT: 406px; BORDER-TOP: black 1px solid; TOP: 35px; BORDER-RIGHT: black 1px solid; LEFT: 0px" id=div1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() NotBg="否" controltype="div"></DIV><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 1px; LEFT: 184px" id=cmdOk onresize=resize() onmove=move() controltype="button" dropstyle="否" fc_onclick='bill_onclick("uf_ok()")'></BUTTON><BUTTON oncontrolselect=controlselect() style="POSITION: absolute; BACKGROUND-COLOR: #d4d0c8; WIDTH: 79px; DISPLAY: block; FONT-FAMILY: ; HEIGHT: 25px; FONT-SIZE: 12px; TOP: 1px; LEFT: 265px" id=cmdClose onresize=resize() onmove=move() controltype="button" dropstyle="否" fc_onclick='bill_onclick("CloseBill()")'></BUTTON><LABEL onresizeend=resizeEnd() oncontrolselect=controlselect() style="POSITION: absolute; WIDTH: 177px; FONT-FAMILY: 楷体_GB2312; HEIGHT: 23px; COLOR: #0000ff; FONT-SIZE: 14pt; TOP: 5px; FONT-WEIGHT: bold; TEXT-DECORATION: none; LEFT: 11px" id=label1 onresize=resize() onmove=move() onmovestart=moveStart() onmoveend=moveEnd() onresizestart=resizeStart() NotBg="否" controltype="label">控件操作权限设置</LABEL></DIV>